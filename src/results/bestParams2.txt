>>> Imports:
#coding=utf-8

try:
    import numpy as np
except:
    pass

try:
    import random
except:
    pass

try:
    from keras.callbacks import ModelCheckpoint, TensorBoard, EarlyStopping
except:
    pass

try:
    from keras.datasets import mnist
except:
    pass

try:
    from keras.models import Sequential, Model
except:
    pass

try:
    from keras.layers import Dense, Dropout, Input, Lambda, Conv2D, MaxPooling2D, Activation, Flatten, Reshape, Permute
except:
    pass

try:
    from keras.optimizers import RMSprop
except:
    pass

try:
    from keras import backend as K
except:
    pass

try:
    import os
except:
    pass

try:
    import cv2
except:
    pass

try:
    from hyperas.utils import eval_hyperopt_space
except:
    pass

try:
    import tensorflow as tf
except:
    pass

try:
    import sklearn
except:
    pass

try:
    from sklearn.model_selection import GridSearchCV, RandomizedSearchCV
except:
    pass

try:
    from keras.wrappers.scikit_learn import KerasClassifier
except:
    pass

try:
    from scipy.stats import randint as sp_randint
except:
    pass

try:
    from scipy.stats import uniform as sp_uniform
except:
    pass

try:
    from hyperas import optim
except:
    pass

try:
    from hyperas.distributions import choice, uniform, conditional
except:
    pass

try:
    from hyperopt import Trials, STATUS_OK, tpe
except:
    pass

>>> Hyperas search space:

def get_space():
    return {
        'Conv2D': hp.choice('Conv2D', [16,32,64]),
        'pool_size': hp.choice('pool_size', [1,2,3,4,5,6,7,8,9,10]),
        'activation': hp.choice('activation', ['relu', 'tanh']),
        'Conv2D_1': hp.choice('Conv2D_1', [16,32,64]),
        'pool_size_1': hp.choice('pool_size_1', [1,2,3,4,5,6,7,8,9,10]),
        'activation_1': hp.choice('activation_1', ['relu', 'tanh']),
        'pool_size_2': hp.choice('pool_size_2', [1,2,3,4,5,6,7,8,9,10]),
        'Conv2D_2': hp.choice('Conv2D_2', [16,32,64]),
        'pool_size_3': hp.choice('pool_size_3', [1,2,3,4,5,6,7,8,9,10]),
        'activation_2': hp.choice('activation_2', ['relu', 'tanh']),
        'Conv2D_3': hp.choice('Conv2D_3', [16,32,64]),
        'pool_size_4': hp.choice('pool_size_4', [1,2,3,4,5,6,7,8,9,10]),
        'activation_3': hp.choice('activation_3', ['relu', 'tanh']),
        'pool_size_5': hp.choice('pool_size_5', [1,2,3,4,5,6,7,8,9,10]),
        'Dense': hp.choice('Dense', [16,32,64,128, 256]),
        'activation_4': hp.choice('activation_4', ['relu', 'tanh']),
    }

>>> Functions
   1: def euclidean_distance(vects):
   2:     x, y = vects
   3: 
   4:     #return K.cast(K.less(K.sqrt(K.sum(K.square(x - y), axis=1, keepdims=True)),0.5),"float32")
   5: 
   6:     return K.sqrt(K.sum(K.square(x - y), axis=1, keepdims=True))
   7: 
   8: def eucl_dist_output_shape(shapes):
   9:     shape1, shape2 = shapes
  10:     return (shape1[0], 1)
  11: 
  12: def contrastive_loss(y_true, y_pred):
  13:     '''Contrastive loss from Hadsell-et-al.'06
  14:     http://yann.lecun.com/exdb/publis/pdf/hadsell-chopra-lecun-06.pdf
  15:     '''
  16:     margin = 1 
  17:     return K.mean(y_true * K.square(y_pred) + (1 - y_true) * K.square(K.maximum(margin - y_pred, 0)))
  18: 
  19: def calc_accuracy(labels, predictions):
  20:     '''accuracy function for compilation'''
  21:     return K.mean(K.equal(labels, K.cast(K.less(predictions,0.5),"float32")))
  22: 
  23: def create_pairs(x, digit_indices):
  24:     '''Positive and negative pair creation.
  25:     Alternates between positive and negative pairs.
  26:     '''
  27:     pairs = []
  28:     labels = []
  29:     n = min([len(digit_indices[d]) for d in range(8)]) - 1
  30:     for d in range(8):
  31:         for i in range(n):
  32:             z1, z2 = digit_indices[d][i], digit_indices[d][i + 1]
  33:             pairs += [[x[z1], x[z2]]]
  34:             inc = random.randrange(1, 8)
  35:             dn = (d + inc) % 8
  36:             z1, z2 = digit_indices[d][i], digit_indices[dn][i]
  37:             pairs += [[x[z1], x[z2]]]
  38:             labels += [1, 0]
  39:     return np.array(pairs), np.array(labels)
  40: 
  41: 
>>> Data
   1: 
   2: 
   3: x_train = []
   4: x_test = []
   5: y_train = []
   6: y_test = []
   7: 
   8: image_dir = "people"
   9: img_groups = {}
  10: for person in os.listdir(image_dir): 
  11:     for img_file in os.listdir(image_dir + "/" + person):
  12:         if person in img_groups:
  13:             img_groups[person].append(img_file)
  14:         else:
  15:             img_groups[person]=[img_file]
  16: 
  17: for target in img_groups:
  18:     for img_file in img_groups[target]:
  19:         if int(target) < 8:
  20:             img = cv2.imread(os.path.join(image_dir, target, img_file))
  21:             img = cv2.cvtColor(img, cv2.COLOR_RGB2GRAY)
  22:             if np.random.random() < 0.8:
  23:                 x_train.append(img)
  24:                 y_train.append(int(target))
  25:             else:
  26:                 x_test.append(img)
  27:                 y_test.append(int(target))
  28: 
  29: x_train = np.array(x_train)
  30: x_test = np.array(x_test)
  31: y_train = np.array(y_train)
  32: y_test = np.array(y_test)
  33: 
  34: input_shape = (256, 128, 1)
  35: x_train = x_train.reshape(x_train.shape[0], x_train.shape[1], x_train.shape[2], 1)
  36: x_test = x_test.reshape(x_test.shape[0], x_test.shape[1], x_test.shape[2], 1)
  37: x_train = x_train.astype('float32')
  38: x_test = x_test.astype('float32')
  39: x_train /= 255
  40: x_test /= 255  
  41: 
  42: num_epochs = 50
  43: 
  44: # create training+test positive and negative pairs
  45: digit_indices = [np.where(y_train == i)[0] for i in range(8)]
  46: tr_pairs, tr_y = create_pairs(x_train, digit_indices)
  47: 
  48: digit_indices = [np.where(y_test == i)[0] for i in range(8)]
  49: te_pairs, te_y = create_pairs(x_test, digit_indices)
  50: 
  51: x_train = [tr_pairs[:, 0], tr_pairs[:, 1]]
  52: y_train = tr_y
  53: x_test = [te_pairs[:, 0], te_pairs[:, 1]]
  54: y_test = te_y
  55: 
  56: 
  57: 
>>> Resulting replaced keras model:

   1: def keras_fmin_fnct(space):
   2: 
   3:     input_shape = (256, 128, 1)
   4: 
   5:     input_main = Input(shape=input_shape, dtype='float32')
   6:     x = Conv2D(space['Conv2D'], space['pool_size'], padding='same', activation=space['activation'])(input_main)
   7:     x = Conv2D(space['Conv2D_1'], space['pool_size_1'], padding='same', activation=space['activation_1'])(x)
   8:     x = MaxPooling2D(pool_size=space['pool_size_2'])(x)
   9:     x = Dropout(0.25)(x)
  10: 
  11:     x = Conv2D(space['Conv2D_2'], space['pool_size_3'], padding='same', activation=space['activation_2'])(x)
  12:     x = Conv2D(space['Conv2D_3'], space['pool_size_4'], padding='same', activation=space['activation_3'])(x)
  13:     x = MaxPooling2D(pool_size=space['pool_size_5'])(x)
  14:     x = Dropout(0.25)(x)
  15: 
  16:     x = Flatten()(x)
  17:     x = Dense(space['Dense'], activation=space['activation_4'])(x)
  18: 
  19:     base_network = Model(inputs=input_main, outputs=x)
  20: 
  21:     input_a = Input(shape=input_shape)
  22:     input_b = Input(shape=input_shape)
  23: 
  24: 
  25:     # because we re-use the same instance `base_network`,
  26:     # the weights of the network
  27:     # will be shared across the two branches
  28:     processed_a = base_network(input_a)
  29:     processed_b = base_network(input_b)
  30: 
  31:     distance = Lambda(euclidean_distance, output_shape=eucl_dist_output_shape)([processed_a, processed_b])
  32: 
  33: 
  34:     model = Model(inputs=[input_a, input_b], outputs=distance)
  35:     model.compile(loss=contrastive_loss, optimizer='adadelta', metrics=[calc_accuracy])
  36: 
  37:     model.fit(x_train,y_train,validation_data=(x_test,y_test),batch_size=128,epochs=num_epochs, verbose=2)
  38: 
  39:     score, acc = model.evaluate(x_test, y_test, verbose=0)
  40:     print('Test accuracy:', acc)
  41: 
  42:     K.clear_session()
  43: 
  44:     return {'loss': -acc, 'status': STATUS_OK, 'model': model}
  45: 
Train on 5024 samples, validate on 1264 samples
Epoch 1/50
 - 33s - loss: 0.2699 - calc_accuracy: 0.5060 - val_loss: 0.4736 - val_calc_accuracy: 0.5000
Epoch 2/50
 - 30s - loss: 0.2557 - calc_accuracy: 0.5111 - val_loss: 0.4640 - val_calc_accuracy: 0.5000
Epoch 3/50
 - 31s - loss: 0.2525 - calc_accuracy: 0.5303 - val_loss: 0.4486 - val_calc_accuracy: 0.5000
Epoch 4/50
 - 31s - loss: 0.2550 - calc_accuracy: 0.5121 - val_loss: 0.4430 - val_calc_accuracy: 0.5000
Epoch 5/50
 - 32s - loss: 0.2517 - calc_accuracy: 0.5328 - val_loss: 0.4274 - val_calc_accuracy: 0.5000
Epoch 6/50
 - 32s - loss: 0.2494 - calc_accuracy: 0.5307 - val_loss: 0.4065 - val_calc_accuracy: 0.5000
Epoch 7/50
 - 32s - loss: 0.2446 - calc_accuracy: 0.5615 - val_loss: 0.4017 - val_calc_accuracy: 0.5000
Epoch 8/50
 - 32s - loss: 0.2409 - calc_accuracy: 0.5860 - val_loss: 0.3329 - val_calc_accuracy: 0.5008
Epoch 9/50
 - 33s - loss: 0.2298 - calc_accuracy: 0.6196 - val_loss: 0.3459 - val_calc_accuracy: 0.5000
Epoch 10/50
 - 32s - loss: 0.2234 - calc_accuracy: 0.6322 - val_loss: 0.3578 - val_calc_accuracy: 0.5000
Epoch 11/50
 - 33s - loss: 0.2459 - calc_accuracy: 0.5786 - val_loss: 0.2455 - val_calc_accuracy: 0.5823
Epoch 12/50
 - 33s - loss: 0.2184 - calc_accuracy: 0.6509 - val_loss: 0.2645 - val_calc_accuracy: 0.5475
Epoch 13/50
 - 33s - loss: 0.2140 - calc_accuracy: 0.6608 - val_loss: 0.2513 - val_calc_accuracy: 0.5847
Epoch 14/50
 - 33s - loss: 0.2049 - calc_accuracy: 0.6847 - val_loss: 0.2662 - val_calc_accuracy: 0.5459
Epoch 15/50
 - 33s - loss: 0.2023 - calc_accuracy: 0.6863 - val_loss: 0.2663 - val_calc_accuracy: 0.5498
Epoch 16/50
 - 33s - loss: 0.1948 - calc_accuracy: 0.6969 - val_loss: 0.2224 - val_calc_accuracy: 0.6377
Epoch 17/50
 - 33s - loss: 0.1879 - calc_accuracy: 0.7162 - val_loss: 0.3082 - val_calc_accuracy: 0.5182
Epoch 18/50
 - 33s - loss: 0.1910 - calc_accuracy: 0.7170 - val_loss: 0.2608 - val_calc_accuracy: 0.5538
Epoch 19/50
 - 33s - loss: 0.1821 - calc_accuracy: 0.7347 - val_loss: 0.1944 - val_calc_accuracy: 0.7128
Epoch 20/50
 - 33s - loss: 0.1768 - calc_accuracy: 0.7412 - val_loss: 0.4255 - val_calc_accuracy: 0.5000
Epoch 21/50
 - 33s - loss: 0.1802 - calc_accuracy: 0.7385 - val_loss: 0.1830 - val_calc_accuracy: 0.7294
Epoch 22/50
 - 32s - loss: 0.1708 - calc_accuracy: 0.7488 - val_loss: 0.1814 - val_calc_accuracy: 0.7413
Epoch 23/50
 - 32s - loss: 0.1707 - calc_accuracy: 0.7607 - val_loss: 0.2110 - val_calc_accuracy: 0.6661
Epoch 24/50
 - 32s - loss: 0.1657 - calc_accuracy: 0.7556 - val_loss: 0.1923 - val_calc_accuracy: 0.7009
Epoch 25/50
 - 32s - loss: 0.1665 - calc_accuracy: 0.7631 - val_loss: 0.1811 - val_calc_accuracy: 0.7358
Epoch 26/50
 - 32s - loss: 0.1600 - calc_accuracy: 0.7741 - val_loss: 0.1718 - val_calc_accuracy: 0.7524
Epoch 27/50
 - 32s - loss: 0.1572 - calc_accuracy: 0.7751 - val_loss: 0.2710 - val_calc_accuracy: 0.5293
Epoch 28/50
 - 32s - loss: 0.1593 - calc_accuracy: 0.7723 - val_loss: 0.1746 - val_calc_accuracy: 0.7468
Epoch 29/50
 - 32s - loss: 0.1536 - calc_accuracy: 0.7958 - val_loss: 0.2080 - val_calc_accuracy: 0.6748
Epoch 30/50
 - 32s - loss: 0.1526 - calc_accuracy: 0.7876 - val_loss: 0.1868 - val_calc_accuracy: 0.7089
Epoch 31/50
 - 32s - loss: 0.1533 - calc_accuracy: 0.7856 - val_loss: 0.1729 - val_calc_accuracy: 0.7524
Epoch 32/50
 - 32s - loss: 0.1458 - calc_accuracy: 0.8037 - val_loss: 0.2877 - val_calc_accuracy: 0.5253
Epoch 33/50
 - 32s - loss: 0.1512 - calc_accuracy: 0.7936 - val_loss: 0.1613 - val_calc_accuracy: 0.7848
Epoch 34/50
 - 32s - loss: 0.1425 - calc_accuracy: 0.8065 - val_loss: 0.1811 - val_calc_accuracy: 0.7255
Epoch 35/50
 - 32s - loss: 0.1417 - calc_accuracy: 0.8006 - val_loss: 0.1649 - val_calc_accuracy: 0.7682
Epoch 36/50
 - 32s - loss: 0.1382 - calc_accuracy: 0.8115 - val_loss: 0.1407 - val_calc_accuracy: 0.8101
Epoch 37/50
 - 32s - loss: 0.1353 - calc_accuracy: 0.8230 - val_loss: 0.1333 - val_calc_accuracy: 0.8418
Epoch 38/50
 - 32s - loss: 0.1359 - calc_accuracy: 0.8123 - val_loss: 0.1574 - val_calc_accuracy: 0.7801
Epoch 39/50
 - 32s - loss: 0.1304 - calc_accuracy: 0.8296 - val_loss: 0.1343 - val_calc_accuracy: 0.8402
Epoch 40/50
 - 32s - loss: 0.1304 - calc_accuracy: 0.8286 - val_loss: 0.1339 - val_calc_accuracy: 0.8212
Epoch 41/50
 - 32s - loss: 0.1275 - calc_accuracy: 0.8314 - val_loss: 0.1313 - val_calc_accuracy: 0.8299
Epoch 42/50
 - 32s - loss: 0.1313 - calc_accuracy: 0.8248 - val_loss: 0.1241 - val_calc_accuracy: 0.8394
Epoch 43/50
 - 33s - loss: 0.1276 - calc_accuracy: 0.8260 - val_loss: 0.1345 - val_calc_accuracy: 0.8259
Epoch 44/50
 - 32s - loss: 0.1259 - calc_accuracy: 0.8276 - val_loss: 0.1659 - val_calc_accuracy: 0.7682
Epoch 45/50
 - 32s - loss: 0.1236 - calc_accuracy: 0.8400 - val_loss: 0.1200 - val_calc_accuracy: 0.8568
Epoch 46/50
 - 32s - loss: 0.1222 - calc_accuracy: 0.8376 - val_loss: 0.1398 - val_calc_accuracy: 0.8172
Epoch 47/50
 - 32s - loss: 0.1196 - calc_accuracy: 0.8493 - val_loss: 0.1262 - val_calc_accuracy: 0.8362
Epoch 48/50
 - 32s - loss: 0.1219 - calc_accuracy: 0.8424 - val_loss: 0.1235 - val_calc_accuracy: 0.8497
Epoch 49/50
 - 32s - loss: 0.1193 - calc_accuracy: 0.8436 - val_loss: 0.1179 - val_calc_accuracy: 0.8497
Epoch 50/50
 - 32s - loss: 0.1195 - calc_accuracy: 0.8439 - val_loss: 0.1091 - val_calc_accuracy: 0.8639
Test accuracy: 0.8639240506329114
Train on 5024 samples, validate on 1264 samples
Epoch 1/50
 - 12s - loss: 0.3058 - calc_accuracy: 0.4893 - val_loss: 0.4216 - val_calc_accuracy: 0.5000
Epoch 2/50
 - 10s - loss: 0.2716 - calc_accuracy: 0.5062 - val_loss: 0.4524 - val_calc_accuracy: 0.5000
Epoch 3/50
 - 10s - loss: 0.2727 - calc_accuracy: 0.4988 - val_loss: 0.4417 - val_calc_accuracy: 0.5000
Epoch 4/50
 - 10s - loss: 0.2782 - calc_accuracy: 0.5044 - val_loss: 0.4091 - val_calc_accuracy: 0.5000
Epoch 5/50
 - 10s - loss: 0.2653 - calc_accuracy: 0.5127 - val_loss: 0.4302 - val_calc_accuracy: 0.5000
Epoch 6/50
 - 10s - loss: 0.2877 - calc_accuracy: 0.5028 - val_loss: 0.4306 - val_calc_accuracy: 0.5000
Epoch 7/50
 - 11s - loss: 0.2691 - calc_accuracy: 0.5159 - val_loss: 0.3179 - val_calc_accuracy: 0.5079
Epoch 8/50
 - 10s - loss: 0.2597 - calc_accuracy: 0.5372 - val_loss: 0.3575 - val_calc_accuracy: 0.5000
Epoch 9/50
 - 10s - loss: 0.2474 - calc_accuracy: 0.5697 - val_loss: 0.2377 - val_calc_accuracy: 0.6116
Epoch 10/50
 - 10s - loss: 0.2234 - calc_accuracy: 0.6403 - val_loss: 0.1847 - val_calc_accuracy: 0.7247
Epoch 11/50
 - 10s - loss: 0.1954 - calc_accuracy: 0.7012 - val_loss: 0.1819 - val_calc_accuracy: 0.7334
Epoch 12/50
 - 10s - loss: 0.1688 - calc_accuracy: 0.7578 - val_loss: 0.1494 - val_calc_accuracy: 0.7872
Epoch 13/50
 - 10s - loss: 0.1539 - calc_accuracy: 0.7864 - val_loss: 0.1585 - val_calc_accuracy: 0.7634
Epoch 14/50
 - 10s - loss: 0.1451 - calc_accuracy: 0.8047 - val_loss: 0.1419 - val_calc_accuracy: 0.8046
Epoch 15/50
 - 10s - loss: 0.1370 - calc_accuracy: 0.8232 - val_loss: 0.1272 - val_calc_accuracy: 0.8125
Epoch 16/50
 - 10s - loss: 0.1264 - calc_accuracy: 0.8424 - val_loss: 0.1180 - val_calc_accuracy: 0.8386
Epoch 17/50
 - 10s - loss: 0.1281 - calc_accuracy: 0.8354 - val_loss: 0.1164 - val_calc_accuracy: 0.8528
Epoch 18/50
 - 10s - loss: 0.1125 - calc_accuracy: 0.8652 - val_loss: 0.1303 - val_calc_accuracy: 0.8315
Epoch 19/50
 - 10s - loss: 0.1073 - calc_accuracy: 0.8790 - val_loss: 0.1751 - val_calc_accuracy: 0.7627
Epoch 20/50
 - 10s - loss: 0.1067 - calc_accuracy: 0.8758 - val_loss: 0.1039 - val_calc_accuracy: 0.8774
Epoch 21/50
 - 10s - loss: 0.0970 - calc_accuracy: 0.8943 - val_loss: 0.0919 - val_calc_accuracy: 0.8869
Epoch 22/50
 - 10s - loss: 0.0929 - calc_accuracy: 0.9007 - val_loss: 0.1035 - val_calc_accuracy: 0.8679
Epoch 23/50
 - 10s - loss: 0.0912 - calc_accuracy: 0.9053 - val_loss: 0.0916 - val_calc_accuracy: 0.8900
Epoch 24/50
 - 10s - loss: 0.0875 - calc_accuracy: 0.9102 - val_loss: 0.1003 - val_calc_accuracy: 0.8837
Epoch 25/50
 - 10s - loss: 0.0834 - calc_accuracy: 0.9154 - val_loss: 0.0972 - val_calc_accuracy: 0.8877
Epoch 26/50
 - 10s - loss: 0.0795 - calc_accuracy: 0.9264 - val_loss: 0.0849 - val_calc_accuracy: 0.9043
Epoch 27/50
 - 10s - loss: 0.0775 - calc_accuracy: 0.9283 - val_loss: 0.0991 - val_calc_accuracy: 0.8884
Epoch 28/50
 - 10s - loss: 0.0801 - calc_accuracy: 0.9216 - val_loss: 0.0785 - val_calc_accuracy: 0.9161
Epoch 29/50
 - 10s - loss: 0.0714 - calc_accuracy: 0.9333 - val_loss: 0.0820 - val_calc_accuracy: 0.9146
Epoch 30/50
 - 10s - loss: 0.0684 - calc_accuracy: 0.9393 - val_loss: 0.0758 - val_calc_accuracy: 0.9225
Epoch 31/50
 - 10s - loss: 0.0675 - calc_accuracy: 0.9419 - val_loss: 0.0704 - val_calc_accuracy: 0.9296
Epoch 32/50
 - 10s - loss: 0.0653 - calc_accuracy: 0.9439 - val_loss: 0.0779 - val_calc_accuracy: 0.9193
Epoch 33/50
 - 10s - loss: 0.0644 - calc_accuracy: 0.9455 - val_loss: 0.0695 - val_calc_accuracy: 0.9264
Epoch 34/50
 - 10s - loss: 0.0613 - calc_accuracy: 0.9496 - val_loss: 0.0591 - val_calc_accuracy: 0.9478
Epoch 35/50
 - 10s - loss: 0.0588 - calc_accuracy: 0.9534 - val_loss: 0.0792 - val_calc_accuracy: 0.9201
Epoch 36/50
 - 10s - loss: 0.0593 - calc_accuracy: 0.9524 - val_loss: 0.0758 - val_calc_accuracy: 0.9304
Epoch 37/50
 - 10s - loss: 0.0575 - calc_accuracy: 0.9570 - val_loss: 0.0601 - val_calc_accuracy: 0.9430
Epoch 38/50
 - 10s - loss: 0.0540 - calc_accuracy: 0.9596 - val_loss: 0.0569 - val_calc_accuracy: 0.9438
Epoch 39/50
 - 10s - loss: 0.0583 - calc_accuracy: 0.9542 - val_loss: 0.0679 - val_calc_accuracy: 0.9383
Epoch 40/50
 - 10s - loss: 0.0519 - calc_accuracy: 0.9689 - val_loss: 0.0706 - val_calc_accuracy: 0.9304
Epoch 41/50
 - 10s - loss: 0.0511 - calc_accuracy: 0.9672 - val_loss: 0.0615 - val_calc_accuracy: 0.9430
Epoch 42/50
 - 10s - loss: 0.0506 - calc_accuracy: 0.9678 - val_loss: 0.0639 - val_calc_accuracy: 0.9422
Epoch 43/50
 - 10s - loss: 0.0504 - calc_accuracy: 0.9684 - val_loss: 0.0612 - val_calc_accuracy: 0.9446
Epoch 44/50
 - 10s - loss: 0.0496 - calc_accuracy: 0.9719 - val_loss: 0.0580 - val_calc_accuracy: 0.9525
Epoch 45/50
 - 10s - loss: 0.0473 - calc_accuracy: 0.9723 - val_loss: 0.0563 - val_calc_accuracy: 0.9517
Epoch 46/50
 - 10s - loss: 0.0462 - calc_accuracy: 0.9739 - val_loss: 0.0552 - val_calc_accuracy: 0.9525
Epoch 47/50
 - 10s - loss: 0.0484 - calc_accuracy: 0.9705 - val_loss: 0.0836 - val_calc_accuracy: 0.9114
Epoch 48/50
 - 10s - loss: 0.0462 - calc_accuracy: 0.9757 - val_loss: 0.0584 - val_calc_accuracy: 0.9573
Epoch 49/50
 - 10s - loss: 0.0437 - calc_accuracy: 0.9793 - val_loss: 0.0490 - val_calc_accuracy: 0.9589
Epoch 50/50
 - 10s - loss: 0.0418 - calc_accuracy: 0.9795 - val_loss: 0.0532 - val_calc_accuracy: 0.9620
Test accuracy: 0.9620253164556962
Train on 5024 samples, validate on 1264 samples
Epoch 1/50
 - 34s - loss: 0.2812 - calc_accuracy: 0.5066 - val_loss: 0.4338 - val_calc_accuracy: 0.5000
Epoch 2/50
 - 33s - loss: 0.2562 - calc_accuracy: 0.5125 - val_loss: 0.4513 - val_calc_accuracy: 0.5000
Epoch 3/50
 - 33s - loss: 0.2613 - calc_accuracy: 0.5042 - val_loss: 0.4269 - val_calc_accuracy: 0.5000
Epoch 4/50
 - 33s - loss: 0.2614 - calc_accuracy: 0.5086 - val_loss: 0.4586 - val_calc_accuracy: 0.5000
Epoch 5/50
 - 33s - loss: 0.2585 - calc_accuracy: 0.5034 - val_loss: 0.4590 - val_calc_accuracy: 0.5000
Epoch 6/50
 - 33s - loss: 0.2585 - calc_accuracy: 0.5040 - val_loss: 0.4581 - val_calc_accuracy: 0.5000
Epoch 7/50
 - 33s - loss: 0.2594 - calc_accuracy: 0.4920 - val_loss: 0.4606 - val_calc_accuracy: 0.5000
Epoch 8/50
 - 33s - loss: 0.2588 - calc_accuracy: 0.4994 - val_loss: 0.4396 - val_calc_accuracy: 0.5000
Epoch 9/50
 - 33s - loss: 0.2590 - calc_accuracy: 0.4954 - val_loss: 0.4612 - val_calc_accuracy: 0.5000
Epoch 10/50
 - 33s - loss: 0.2563 - calc_accuracy: 0.5066 - val_loss: 0.4616 - val_calc_accuracy: 0.5000
Epoch 11/50
 - 33s - loss: 0.2567 - calc_accuracy: 0.5068 - val_loss: 0.4668 - val_calc_accuracy: 0.5000
Epoch 12/50
 - 33s - loss: 0.2564 - calc_accuracy: 0.4978 - val_loss: 0.4717 - val_calc_accuracy: 0.5000
Epoch 13/50
 - 33s - loss: 0.2566 - calc_accuracy: 0.4986 - val_loss: 0.4675 - val_calc_accuracy: 0.5000
Epoch 14/50
 - 33s - loss: 0.2565 - calc_accuracy: 0.4954 - val_loss: 0.4644 - val_calc_accuracy: 0.5000
Epoch 15/50
 - 33s - loss: 0.2559 - calc_accuracy: 0.5012 - val_loss: 0.4799 - val_calc_accuracy: 0.5000
Epoch 16/50
 - 33s - loss: 0.2549 - calc_accuracy: 0.4974 - val_loss: 0.4607 - val_calc_accuracy: 0.5000
Epoch 17/50
 - 33s - loss: 0.2546 - calc_accuracy: 0.5121 - val_loss: 0.4699 - val_calc_accuracy: 0.5000
Epoch 18/50
 - 33s - loss: 0.2549 - calc_accuracy: 0.5062 - val_loss: 0.4773 - val_calc_accuracy: 0.5000
Epoch 19/50
 - 33s - loss: 0.2539 - calc_accuracy: 0.5012 - val_loss: 0.4814 - val_calc_accuracy: 0.5000
Epoch 20/50
 - 33s - loss: 0.2556 - calc_accuracy: 0.5054 - val_loss: 0.4755 - val_calc_accuracy: 0.5000
Epoch 21/50
 - 33s - loss: 0.2539 - calc_accuracy: 0.5086 - val_loss: 0.4769 - val_calc_accuracy: 0.5000
Epoch 22/50
 - 33s - loss: 0.2544 - calc_accuracy: 0.5034 - val_loss: 0.4772 - val_calc_accuracy: 0.5000
Epoch 23/50
 - 33s - loss: 0.2559 - calc_accuracy: 0.4978 - val_loss: 0.4721 - val_calc_accuracy: 0.5000
Epoch 24/50
 - 33s - loss: 0.2547 - calc_accuracy: 0.5121 - val_loss: 0.4820 - val_calc_accuracy: 0.5000
Epoch 25/50
 - 33s - loss: 0.2549 - calc_accuracy: 0.4970 - val_loss: 0.4808 - val_calc_accuracy: 0.5000
Epoch 26/50
 - 33s - loss: 0.2559 - calc_accuracy: 0.5060 - val_loss: 0.4860 - val_calc_accuracy: 0.5000
Epoch 27/50
 - 33s - loss: 0.2548 - calc_accuracy: 0.5008 - val_loss: 0.4765 - val_calc_accuracy: 0.5000
Epoch 28/50
 - 33s - loss: 0.2549 - calc_accuracy: 0.4972 - val_loss: 0.4851 - val_calc_accuracy: 0.5000
Epoch 29/50
 - 33s - loss: 0.2544 - calc_accuracy: 0.4916 - val_loss: 0.4879 - val_calc_accuracy: 0.5000
Epoch 30/50
 - 33s - loss: 0.2547 - calc_accuracy: 0.4974 - val_loss: 0.4815 - val_calc_accuracy: 0.5000
Epoch 31/50
 - 33s - loss: 0.2545 - calc_accuracy: 0.5028 - val_loss: 0.4829 - val_calc_accuracy: 0.5000
Epoch 32/50
 - 33s - loss: 0.2540 - calc_accuracy: 0.5004 - val_loss: 0.4866 - val_calc_accuracy: 0.5000
Epoch 33/50
 - 33s - loss: 0.2530 - calc_accuracy: 0.5084 - val_loss: 0.4834 - val_calc_accuracy: 0.5000
Epoch 34/50
 - 33s - loss: 0.2556 - calc_accuracy: 0.4960 - val_loss: 0.4837 - val_calc_accuracy: 0.5000
Epoch 35/50
 - 33s - loss: 0.2538 - calc_accuracy: 0.5030 - val_loss: 0.4843 - val_calc_accuracy: 0.5000
Epoch 36/50
 - 33s - loss: 0.2532 - calc_accuracy: 0.5060 - val_loss: 0.4839 - val_calc_accuracy: 0.5000
Epoch 37/50
 - 33s - loss: 0.2529 - calc_accuracy: 0.5022 - val_loss: 0.4828 - val_calc_accuracy: 0.5000
Epoch 38/50
 - 33s - loss: 0.2532 - calc_accuracy: 0.5157 - val_loss: 0.4803 - val_calc_accuracy: 0.5000
Epoch 39/50
 - 33s - loss: 0.2552 - calc_accuracy: 0.4879 - val_loss: 0.4945 - val_calc_accuracy: 0.5000
Epoch 40/50
 - 33s - loss: 0.2545 - calc_accuracy: 0.4934 - val_loss: 0.4844 - val_calc_accuracy: 0.5000
Epoch 41/50
 - 33s - loss: 0.2528 - calc_accuracy: 0.4984 - val_loss: 0.4895 - val_calc_accuracy: 0.5000
Epoch 42/50
 - 33s - loss: 0.2539 - calc_accuracy: 0.5000 - val_loss: 0.4811 - val_calc_accuracy: 0.5000
Epoch 43/50
 - 33s - loss: 0.2548 - calc_accuracy: 0.4984 - val_loss: 0.4850 - val_calc_accuracy: 0.5000
Epoch 44/50
 - 33s - loss: 0.2526 - calc_accuracy: 0.5102 - val_loss: 0.4847 - val_calc_accuracy: 0.5000
Epoch 45/50
 - 33s - loss: 0.2524 - calc_accuracy: 0.5048 - val_loss: 0.4774 - val_calc_accuracy: 0.5000
Epoch 46/50
 - 33s - loss: 0.2532 - calc_accuracy: 0.5044 - val_loss: 0.4953 - val_calc_accuracy: 0.5000
Epoch 47/50
 - 33s - loss: 0.2541 - calc_accuracy: 0.4970 - val_loss: 0.4886 - val_calc_accuracy: 0.5000
Epoch 48/50
 - 33s - loss: 0.2552 - calc_accuracy: 0.5014 - val_loss: 0.4809 - val_calc_accuracy: 0.5000
Epoch 49/50
 - 33s - loss: 0.2544 - calc_accuracy: 0.4958 - val_loss: 0.4897 - val_calc_accuracy: 0.5000
Epoch 50/50
 - 33s - loss: 0.2545 - calc_accuracy: 0.4946 - val_loss: 0.4542 - val_calc_accuracy: 0.5000
Test accuracy: 0.5
Train on 5024 samples, validate on 1264 samples
Epoch 1/50
 - 34s - loss: 0.2713 - calc_accuracy: 0.5012 - val_loss: 0.4448 - val_calc_accuracy: 0.5000
Epoch 2/50
 - 34s - loss: 0.2607 - calc_accuracy: 0.4996 - val_loss: 0.4634 - val_calc_accuracy: 0.5000
Epoch 3/50
 - 34s - loss: 0.2593 - calc_accuracy: 0.5032 - val_loss: 0.4464 - val_calc_accuracy: 0.5000
Epoch 4/50
 - 34s - loss: 0.2586 - calc_accuracy: 0.5119 - val_loss: 0.4441 - val_calc_accuracy: 0.5000
Epoch 5/50
 - 34s - loss: 0.2564 - calc_accuracy: 0.5271 - val_loss: 0.3509 - val_calc_accuracy: 0.5008
Epoch 6/50
 - 34s - loss: 0.2512 - calc_accuracy: 0.5418 - val_loss: 0.3998 - val_calc_accuracy: 0.5000
Epoch 7/50
 - 34s - loss: 0.2393 - calc_accuracy: 0.5884 - val_loss: 0.3119 - val_calc_accuracy: 0.5079
Epoch 8/50
 - 34s - loss: 0.2163 - calc_accuracy: 0.6535 - val_loss: 0.2000 - val_calc_accuracy: 0.6796
Epoch 9/50
 - 34s - loss: 0.2002 - calc_accuracy: 0.6969 - val_loss: 0.2796 - val_calc_accuracy: 0.5324
Epoch 10/50
 - 34s - loss: 0.1908 - calc_accuracy: 0.7144 - val_loss: 0.1656 - val_calc_accuracy: 0.7476
Epoch 11/50
 - 34s - loss: 0.1804 - calc_accuracy: 0.7361 - val_loss: 0.1893 - val_calc_accuracy: 0.7041
Epoch 12/50
 - 34s - loss: 0.1719 - calc_accuracy: 0.7514 - val_loss: 0.1565 - val_calc_accuracy: 0.7722
Epoch 13/50
 - 34s - loss: 0.1654 - calc_accuracy: 0.7673 - val_loss: 0.1687 - val_calc_accuracy: 0.7468
Epoch 14/50
 - 34s - loss: 0.1555 - calc_accuracy: 0.7892 - val_loss: 0.1425 - val_calc_accuracy: 0.8109
Epoch 15/50
 - 34s - loss: 0.1512 - calc_accuracy: 0.8010 - val_loss: 0.1390 - val_calc_accuracy: 0.8109
Epoch 16/50
 - 34s - loss: 0.1456 - calc_accuracy: 0.8085 - val_loss: 0.1511 - val_calc_accuracy: 0.7919
Epoch 17/50
 - 34s - loss: 0.1410 - calc_accuracy: 0.8248 - val_loss: 0.1205 - val_calc_accuracy: 0.8434
Epoch 18/50
 - 34s - loss: 0.1338 - calc_accuracy: 0.8360 - val_loss: 0.1407 - val_calc_accuracy: 0.8117
Epoch 19/50
 - 34s - loss: 0.1279 - calc_accuracy: 0.8555 - val_loss: 0.1158 - val_calc_accuracy: 0.8528
Epoch 20/50
 - 34s - loss: 0.1242 - calc_accuracy: 0.8561 - val_loss: 0.1263 - val_calc_accuracy: 0.8465
Epoch 21/50
 - 34s - loss: 0.1178 - calc_accuracy: 0.8648 - val_loss: 0.0988 - val_calc_accuracy: 0.8877
Epoch 22/50
 - 34s - loss: 0.1129 - calc_accuracy: 0.8758 - val_loss: 0.0996 - val_calc_accuracy: 0.8813
Epoch 23/50
 - 34s - loss: 0.1102 - calc_accuracy: 0.8808 - val_loss: 0.0983 - val_calc_accuracy: 0.8940
Epoch 24/50
 - 34s - loss: 0.1038 - calc_accuracy: 0.8935 - val_loss: 0.0935 - val_calc_accuracy: 0.8940
Epoch 25/50
 - 34s - loss: 0.1022 - calc_accuracy: 0.8877 - val_loss: 0.0940 - val_calc_accuracy: 0.9059
Epoch 26/50
 - 34s - loss: 0.1000 - calc_accuracy: 0.8953 - val_loss: 0.1078 - val_calc_accuracy: 0.8884
Epoch 27/50
 - 34s - loss: 0.0960 - calc_accuracy: 0.9003 - val_loss: 0.1000 - val_calc_accuracy: 0.8979
Epoch 28/50
 - 34s - loss: 0.0924 - calc_accuracy: 0.9102 - val_loss: 0.0813 - val_calc_accuracy: 0.9185
Epoch 29/50
 - 34s - loss: 0.0893 - calc_accuracy: 0.9072 - val_loss: 0.0774 - val_calc_accuracy: 0.9272
Epoch 30/50
 - 34s - loss: 0.0853 - calc_accuracy: 0.9212 - val_loss: 0.0811 - val_calc_accuracy: 0.9225
Epoch 31/50
 - 34s - loss: 0.0845 - calc_accuracy: 0.9176 - val_loss: 0.0752 - val_calc_accuracy: 0.9328
Epoch 32/50
 - 34s - loss: 0.0809 - calc_accuracy: 0.9234 - val_loss: 0.0779 - val_calc_accuracy: 0.9217
Epoch 33/50
 - 34s - loss: 0.0807 - calc_accuracy: 0.9240 - val_loss: 0.0752 - val_calc_accuracy: 0.9312
Epoch 34/50
 - 34s - loss: 0.0797 - calc_accuracy: 0.9246 - val_loss: 0.0812 - val_calc_accuracy: 0.9241
Epoch 35/50
 - 34s - loss: 0.0752 - calc_accuracy: 0.9319 - val_loss: 0.0750 - val_calc_accuracy: 0.9351
Epoch 36/50
 - 34s - loss: 0.0749 - calc_accuracy: 0.9353 - val_loss: 0.0687 - val_calc_accuracy: 0.9304
Epoch 37/50
 - 34s - loss: 0.0742 - calc_accuracy: 0.9317 - val_loss: 0.0661 - val_calc_accuracy: 0.9367
Epoch 38/50
 - 33s - loss: 0.0719 - calc_accuracy: 0.9369 - val_loss: 0.0759 - val_calc_accuracy: 0.9256
Epoch 39/50
 - 34s - loss: 0.0729 - calc_accuracy: 0.9311 - val_loss: 0.0841 - val_calc_accuracy: 0.9225
Epoch 40/50
 - 34s - loss: 0.0713 - calc_accuracy: 0.9367 - val_loss: 0.0671 - val_calc_accuracy: 0.9256
Epoch 41/50
 - 34s - loss: 0.0685 - calc_accuracy: 0.9443 - val_loss: 0.0642 - val_calc_accuracy: 0.9391
Epoch 42/50
 - 33s - loss: 0.0667 - calc_accuracy: 0.9443 - val_loss: 0.0890 - val_calc_accuracy: 0.9059
Epoch 43/50
 - 33s - loss: 0.0674 - calc_accuracy: 0.9413 - val_loss: 0.0625 - val_calc_accuracy: 0.9415
Epoch 44/50
 - 34s - loss: 0.0652 - calc_accuracy: 0.9455 - val_loss: 0.0622 - val_calc_accuracy: 0.9399
Epoch 45/50
 - 33s - loss: 0.0640 - calc_accuracy: 0.9494 - val_loss: 0.0658 - val_calc_accuracy: 0.9375
Epoch 46/50
 - 33s - loss: 0.0627 - calc_accuracy: 0.9477 - val_loss: 0.0632 - val_calc_accuracy: 0.9391
Epoch 47/50
 - 34s - loss: 0.0614 - calc_accuracy: 0.9556 - val_loss: 0.0619 - val_calc_accuracy: 0.9391
Epoch 48/50
 - 33s - loss: 0.0599 - calc_accuracy: 0.9534 - val_loss: 0.0627 - val_calc_accuracy: 0.9438
Epoch 49/50
 - 33s - loss: 0.0602 - calc_accuracy: 0.9488 - val_loss: 0.0541 - val_calc_accuracy: 0.9549
Epoch 50/50
 - 34s - loss: 0.0585 - calc_accuracy: 0.9566 - val_loss: 0.0639 - val_calc_accuracy: 0.9367
Test accuracy: 0.9367088607594937
Train on 5024 samples, validate on 1264 samples
Epoch 1/50
 - 12s - loss: 0.2878 - calc_accuracy: 0.5143 - val_loss: 0.4577 - val_calc_accuracy: 0.5000
Epoch 2/50
 - 11s - loss: 0.2548 - calc_accuracy: 0.5191 - val_loss: 0.3649 - val_calc_accuracy: 0.5008
Epoch 3/50
 - 11s - loss: 0.2519 - calc_accuracy: 0.5253 - val_loss: 0.3378 - val_calc_accuracy: 0.5016
Epoch 4/50
 - 11s - loss: 0.2470 - calc_accuracy: 0.5577 - val_loss: 0.3066 - val_calc_accuracy: 0.5079
Epoch 5/50
 - 11s - loss: 0.2430 - calc_accuracy: 0.5830 - val_loss: 0.2573 - val_calc_accuracy: 0.5704
Epoch 6/50
 - 11s - loss: 0.2287 - calc_accuracy: 0.6286 - val_loss: 0.2114 - val_calc_accuracy: 0.6875
Epoch 7/50
 - 11s - loss: 0.2195 - calc_accuracy: 0.6527 - val_loss: 0.2612 - val_calc_accuracy: 0.5356
Epoch 8/50
 - 11s - loss: 0.2055 - calc_accuracy: 0.6756 - val_loss: 0.1761 - val_calc_accuracy: 0.7263
Epoch 9/50
 - 11s - loss: 0.1919 - calc_accuracy: 0.7078 - val_loss: 0.1695 - val_calc_accuracy: 0.7429
Epoch 10/50
 - 11s - loss: 0.1764 - calc_accuracy: 0.7410 - val_loss: 0.1535 - val_calc_accuracy: 0.7745
Epoch 11/50
 - 11s - loss: 0.1665 - calc_accuracy: 0.7554 - val_loss: 0.1512 - val_calc_accuracy: 0.7801
Epoch 12/50
 - 11s - loss: 0.1558 - calc_accuracy: 0.7822 - val_loss: 0.1367 - val_calc_accuracy: 0.7959
Epoch 13/50
 - 11s - loss: 0.1414 - calc_accuracy: 0.8027 - val_loss: 0.1209 - val_calc_accuracy: 0.8220
Epoch 14/50
 - 11s - loss: 0.1369 - calc_accuracy: 0.8133 - val_loss: 0.1170 - val_calc_accuracy: 0.8544
Epoch 15/50
 - 11s - loss: 0.1295 - calc_accuracy: 0.8248 - val_loss: 0.1209 - val_calc_accuracy: 0.8339
Epoch 16/50
 - 11s - loss: 0.1240 - calc_accuracy: 0.8362 - val_loss: 0.1076 - val_calc_accuracy: 0.8671
Epoch 17/50
 - 11s - loss: 0.1138 - calc_accuracy: 0.8561 - val_loss: 0.1103 - val_calc_accuracy: 0.8671
Epoch 18/50
 - 11s - loss: 0.1127 - calc_accuracy: 0.8585 - val_loss: 0.1210 - val_calc_accuracy: 0.8481
Epoch 19/50
 - 11s - loss: 0.1069 - calc_accuracy: 0.8704 - val_loss: 0.1000 - val_calc_accuracy: 0.8821
Epoch 20/50
 - 11s - loss: 0.0997 - calc_accuracy: 0.8863 - val_loss: 0.0920 - val_calc_accuracy: 0.8924
Epoch 21/50
 - 11s - loss: 0.0982 - calc_accuracy: 0.8822 - val_loss: 0.0909 - val_calc_accuracy: 0.8987
Epoch 22/50
 - 11s - loss: 0.0929 - calc_accuracy: 0.8941 - val_loss: 0.0942 - val_calc_accuracy: 0.8932
Epoch 23/50
 - 11s - loss: 0.0907 - calc_accuracy: 0.9023 - val_loss: 0.0803 - val_calc_accuracy: 0.9090
Epoch 24/50
 - 11s - loss: 0.0882 - calc_accuracy: 0.9029 - val_loss: 0.1014 - val_calc_accuracy: 0.8758
Epoch 25/50
 - 11s - loss: 0.0849 - calc_accuracy: 0.9059 - val_loss: 0.0894 - val_calc_accuracy: 0.9019
Epoch 26/50
 - 11s - loss: 0.0790 - calc_accuracy: 0.9138 - val_loss: 0.0847 - val_calc_accuracy: 0.9082
Epoch 27/50
 - 11s - loss: 0.0776 - calc_accuracy: 0.9190 - val_loss: 0.0735 - val_calc_accuracy: 0.9233
Epoch 28/50
 - 11s - loss: 0.0753 - calc_accuracy: 0.9236 - val_loss: 0.0825 - val_calc_accuracy: 0.9011
Epoch 29/50
 - 11s - loss: 0.0709 - calc_accuracy: 0.9287 - val_loss: 0.0867 - val_calc_accuracy: 0.8916
Epoch 30/50
 - 11s - loss: 0.0702 - calc_accuracy: 0.9281 - val_loss: 0.0736 - val_calc_accuracy: 0.9233
Epoch 31/50
 - 11s - loss: 0.0683 - calc_accuracy: 0.9307 - val_loss: 0.0842 - val_calc_accuracy: 0.9027
Epoch 32/50
 - 11s - loss: 0.0639 - calc_accuracy: 0.9409 - val_loss: 0.0634 - val_calc_accuracy: 0.9415
Epoch 33/50
 - 11s - loss: 0.0640 - calc_accuracy: 0.9381 - val_loss: 0.0705 - val_calc_accuracy: 0.9296
Epoch 34/50
 - 11s - loss: 0.0634 - calc_accuracy: 0.9395 - val_loss: 0.0702 - val_calc_accuracy: 0.9256
Epoch 35/50
 - 11s - loss: 0.0599 - calc_accuracy: 0.9427 - val_loss: 0.0682 - val_calc_accuracy: 0.9193
Epoch 36/50
 - 11s - loss: 0.0590 - calc_accuracy: 0.9419 - val_loss: 0.0632 - val_calc_accuracy: 0.9288
Epoch 37/50
 - 11s - loss: 0.0586 - calc_accuracy: 0.9475 - val_loss: 0.0647 - val_calc_accuracy: 0.9280
Epoch 38/50
 - 11s - loss: 0.0572 - calc_accuracy: 0.9459 - val_loss: 0.0643 - val_calc_accuracy: 0.9415
Epoch 39/50
 - 11s - loss: 0.0541 - calc_accuracy: 0.9508 - val_loss: 0.0596 - val_calc_accuracy: 0.9407
Epoch 40/50
 - 11s - loss: 0.0519 - calc_accuracy: 0.9524 - val_loss: 0.0578 - val_calc_accuracy: 0.9399
Epoch 41/50
 - 11s - loss: 0.0533 - calc_accuracy: 0.9498 - val_loss: 0.0545 - val_calc_accuracy: 0.9517
Epoch 42/50
 - 11s - loss: 0.0518 - calc_accuracy: 0.9526 - val_loss: 0.0603 - val_calc_accuracy: 0.9383
Epoch 43/50
 - 11s - loss: 0.0495 - calc_accuracy: 0.9538 - val_loss: 0.0615 - val_calc_accuracy: 0.9272
Epoch 44/50
 - 11s - loss: 0.0510 - calc_accuracy: 0.9498 - val_loss: 0.0508 - val_calc_accuracy: 0.9509
Epoch 45/50
 - 11s - loss: 0.0469 - calc_accuracy: 0.9578 - val_loss: 0.0625 - val_calc_accuracy: 0.9399
Epoch 46/50
 - 11s - loss: 0.0486 - calc_accuracy: 0.9556 - val_loss: 0.0593 - val_calc_accuracy: 0.9343
Epoch 47/50
 - 11s - loss: 0.0454 - calc_accuracy: 0.9604 - val_loss: 0.0592 - val_calc_accuracy: 0.9391
Epoch 48/50
 - 11s - loss: 0.0470 - calc_accuracy: 0.9580 - val_loss: 0.0535 - val_calc_accuracy: 0.9486
Epoch 49/50
 - 11s - loss: 0.0447 - calc_accuracy: 0.9588 - val_loss: 0.0778 - val_calc_accuracy: 0.9043
Epoch 50/50
 - 11s - loss: 0.0438 - calc_accuracy: 0.9560 - val_loss: 0.0673 - val_calc_accuracy: 0.9177
Test accuracy: 0.9177215189873418
Train on 5024 samples, validate on 1264 samples
Epoch 1/50
 - 30s - loss: 0.2761 - calc_accuracy: 0.5145 - val_loss: 0.4503 - val_calc_accuracy: 0.5000
Epoch 2/50
 - 28s - loss: 0.2596 - calc_accuracy: 0.5050 - val_loss: 0.4593 - val_calc_accuracy: 0.5000
Epoch 3/50
 - 28s - loss: 0.2696 - calc_accuracy: 0.4960 - val_loss: 0.4690 - val_calc_accuracy: 0.5000
Epoch 4/50
 - 28s - loss: 0.2563 - calc_accuracy: 0.5082 - val_loss: 0.4791 - val_calc_accuracy: 0.5000
Epoch 5/50
 - 28s - loss: 0.2581 - calc_accuracy: 0.4976 - val_loss: 0.4664 - val_calc_accuracy: 0.5000
Epoch 6/50
 - 28s - loss: 0.2561 - calc_accuracy: 0.5018 - val_loss: 0.4806 - val_calc_accuracy: 0.5000
Epoch 7/50
 - 28s - loss: 0.2588 - calc_accuracy: 0.5092 - val_loss: 0.4742 - val_calc_accuracy: 0.5000
Epoch 8/50
 - 28s - loss: 0.2555 - calc_accuracy: 0.5068 - val_loss: 0.4800 - val_calc_accuracy: 0.5000
Epoch 9/50
 - 28s - loss: 0.2570 - calc_accuracy: 0.4962 - val_loss: 0.4726 - val_calc_accuracy: 0.5000
Epoch 10/50
 - 28s - loss: 0.2578 - calc_accuracy: 0.4980 - val_loss: 0.4848 - val_calc_accuracy: 0.5000
Epoch 11/50
 - 27s - loss: 0.2566 - calc_accuracy: 0.4861 - val_loss: 0.4720 - val_calc_accuracy: 0.5000
Epoch 12/50
 - 28s - loss: 0.2538 - calc_accuracy: 0.5040 - val_loss: 0.4541 - val_calc_accuracy: 0.5000
Epoch 13/50
 - 28s - loss: 0.2554 - calc_accuracy: 0.4904 - val_loss: 0.4755 - val_calc_accuracy: 0.5000
Epoch 14/50
 - 28s - loss: 0.2559 - calc_accuracy: 0.4972 - val_loss: 0.4898 - val_calc_accuracy: 0.5000
Epoch 15/50
 - 28s - loss: 0.2566 - calc_accuracy: 0.4857 - val_loss: 0.4780 - val_calc_accuracy: 0.5000
Epoch 16/50
 - 27s - loss: 0.2539 - calc_accuracy: 0.5026 - val_loss: 0.4912 - val_calc_accuracy: 0.5000
Epoch 17/50
 - 28s - loss: 0.2542 - calc_accuracy: 0.4974 - val_loss: 0.4761 - val_calc_accuracy: 0.5000
Epoch 18/50
 - 27s - loss: 0.2545 - calc_accuracy: 0.4970 - val_loss: 0.4929 - val_calc_accuracy: 0.5000
Epoch 19/50
 - 27s - loss: 0.2537 - calc_accuracy: 0.4978 - val_loss: 0.4903 - val_calc_accuracy: 0.5000
Epoch 20/50
 - 27s - loss: 0.2548 - calc_accuracy: 0.4942 - val_loss: 0.4941 - val_calc_accuracy: 0.5000
Epoch 21/50
 - 27s - loss: 0.2537 - calc_accuracy: 0.5111 - val_loss: 0.4870 - val_calc_accuracy: 0.5000
Epoch 22/50
 - 27s - loss: 0.2528 - calc_accuracy: 0.5100 - val_loss: 0.4899 - val_calc_accuracy: 0.5000
Epoch 23/50
 - 27s - loss: 0.2546 - calc_accuracy: 0.4910 - val_loss: 0.4877 - val_calc_accuracy: 0.5000
Epoch 24/50
 - 27s - loss: 0.2536 - calc_accuracy: 0.5072 - val_loss: 0.4894 - val_calc_accuracy: 0.5000
Epoch 25/50
 - 27s - loss: 0.2540 - calc_accuracy: 0.4964 - val_loss: 0.4912 - val_calc_accuracy: 0.5000
Epoch 26/50
 - 27s - loss: 0.2535 - calc_accuracy: 0.4944 - val_loss: 0.4879 - val_calc_accuracy: 0.5000
Epoch 27/50
 - 27s - loss: 0.2549 - calc_accuracy: 0.4990 - val_loss: 0.4861 - val_calc_accuracy: 0.5000
Epoch 28/50
 - 27s - loss: 0.2539 - calc_accuracy: 0.4918 - val_loss: 0.4920 - val_calc_accuracy: 0.5000
Epoch 29/50
 - 27s - loss: 0.2538 - calc_accuracy: 0.4942 - val_loss: 0.4759 - val_calc_accuracy: 0.5000
Epoch 30/50
 - 27s - loss: 0.2543 - calc_accuracy: 0.4883 - val_loss: 0.4910 - val_calc_accuracy: 0.5000
Epoch 31/50
 - 27s - loss: 0.2540 - calc_accuracy: 0.5026 - val_loss: 0.4878 - val_calc_accuracy: 0.5000
Epoch 32/50
 - 27s - loss: 0.2525 - calc_accuracy: 0.5102 - val_loss: 0.4948 - val_calc_accuracy: 0.5000
Epoch 33/50
 - 27s - loss: 0.2538 - calc_accuracy: 0.4948 - val_loss: 0.4831 - val_calc_accuracy: 0.5000
Epoch 34/50
 - 27s - loss: 0.2545 - calc_accuracy: 0.4948 - val_loss: 0.4904 - val_calc_accuracy: 0.5000
Epoch 35/50
 - 27s - loss: 0.2528 - calc_accuracy: 0.4984 - val_loss: 0.4933 - val_calc_accuracy: 0.5000
Epoch 36/50
 - 27s - loss: 0.2519 - calc_accuracy: 0.5092 - val_loss: 0.4947 - val_calc_accuracy: 0.5000
Epoch 37/50
 - 28s - loss: 0.2536 - calc_accuracy: 0.5020 - val_loss: 0.4929 - val_calc_accuracy: 0.5000
Epoch 38/50
 - 27s - loss: 0.2532 - calc_accuracy: 0.5054 - val_loss: 0.4698 - val_calc_accuracy: 0.5000
Epoch 39/50
 - 27s - loss: 0.2551 - calc_accuracy: 0.4904 - val_loss: 0.4882 - val_calc_accuracy: 0.5000
Epoch 40/50
 - 27s - loss: 0.2537 - calc_accuracy: 0.4986 - val_loss: 0.4869 - val_calc_accuracy: 0.5000
Epoch 41/50
 - 27s - loss: 0.2538 - calc_accuracy: 0.4920 - val_loss: 0.4889 - val_calc_accuracy: 0.5000
Epoch 42/50
 - 28s - loss: 0.2526 - calc_accuracy: 0.5024 - val_loss: 0.4928 - val_calc_accuracy: 0.5000
Epoch 43/50
 - 27s - loss: 0.2529 - calc_accuracy: 0.5096 - val_loss: 0.4953 - val_calc_accuracy: 0.5000
Epoch 44/50
 - 27s - loss: 0.2530 - calc_accuracy: 0.5054 - val_loss: 0.4986 - val_calc_accuracy: 0.5000
Epoch 45/50
 - 27s - loss: 0.2539 - calc_accuracy: 0.4958 - val_loss: 0.4987 - val_calc_accuracy: 0.5000
Epoch 46/50
 - 27s - loss: 0.2527 - calc_accuracy: 0.5030 - val_loss: 0.4998 - val_calc_accuracy: 0.5000
Epoch 47/50
 - 27s - loss: 0.2537 - calc_accuracy: 0.4972 - val_loss: 0.4987 - val_calc_accuracy: 0.5000
Epoch 48/50
 - 27s - loss: 0.2541 - calc_accuracy: 0.4956 - val_loss: 0.4999 - val_calc_accuracy: 0.5000
Epoch 49/50
 - 27s - loss: 0.2526 - calc_accuracy: 0.4986 - val_loss: 0.4999 - val_calc_accuracy: 0.5000
Epoch 50/50
 - 27s - loss: 0.2536 - calc_accuracy: 0.4948 - val_loss: 0.4999 - val_calc_accuracy: 0.5000
Test accuracy: 0.5
Train on 5024 samples, validate on 1264 samples
Epoch 1/50
 - 16s - loss: 0.2844 - calc_accuracy: 0.4954 - val_loss: 0.4475 - val_calc_accuracy: 0.5000
Epoch 2/50
 - 15s - loss: 0.2559 - calc_accuracy: 0.4978 - val_loss: 0.4408 - val_calc_accuracy: 0.5000
Epoch 3/50
 - 15s - loss: 0.2593 - calc_accuracy: 0.5094 - val_loss: 0.3820 - val_calc_accuracy: 0.5000
Epoch 4/50
 - 15s - loss: 0.2542 - calc_accuracy: 0.5253 - val_loss: 0.4440 - val_calc_accuracy: 0.5000
Epoch 5/50
 - 15s - loss: 0.2590 - calc_accuracy: 0.5016 - val_loss: 0.3767 - val_calc_accuracy: 0.5000
Epoch 6/50
 - 15s - loss: 0.2601 - calc_accuracy: 0.5072 - val_loss: 0.3844 - val_calc_accuracy: 0.5000
Epoch 7/50
 - 15s - loss: 0.2515 - calc_accuracy: 0.5263 - val_loss: 0.3549 - val_calc_accuracy: 0.5000
Epoch 8/50
 - 15s - loss: 0.2528 - calc_accuracy: 0.5191 - val_loss: 0.3273 - val_calc_accuracy: 0.5000
Epoch 9/50
 - 15s - loss: 0.2509 - calc_accuracy: 0.5512 - val_loss: 0.3343 - val_calc_accuracy: 0.5000
Epoch 10/50
 - 15s - loss: 0.2415 - calc_accuracy: 0.5772 - val_loss: 0.3318 - val_calc_accuracy: 0.5000
Epoch 11/50
 - 15s - loss: 0.2358 - calc_accuracy: 0.6025 - val_loss: 0.3552 - val_calc_accuracy: 0.5000
Epoch 12/50
 - 15s - loss: 0.2329 - calc_accuracy: 0.6113 - val_loss: 0.2714 - val_calc_accuracy: 0.5364
Epoch 13/50
 - 15s - loss: 0.2122 - calc_accuracy: 0.6672 - val_loss: 0.2211 - val_calc_accuracy: 0.6472
Epoch 14/50
 - 15s - loss: 0.2034 - calc_accuracy: 0.6825 - val_loss: 0.3108 - val_calc_accuracy: 0.5063
Epoch 15/50
 - 15s - loss: 0.1976 - calc_accuracy: 0.6982 - val_loss: 0.2854 - val_calc_accuracy: 0.5198
Epoch 16/50
 - 15s - loss: 0.1953 - calc_accuracy: 0.7048 - val_loss: 0.2166 - val_calc_accuracy: 0.6503
Epoch 17/50
 - 15s - loss: 0.1878 - calc_accuracy: 0.7227 - val_loss: 0.2287 - val_calc_accuracy: 0.6329
Epoch 18/50
 - 15s - loss: 0.1895 - calc_accuracy: 0.7156 - val_loss: 0.2271 - val_calc_accuracy: 0.6274
Epoch 19/50
 - 15s - loss: 0.1876 - calc_accuracy: 0.7251 - val_loss: 0.2024 - val_calc_accuracy: 0.6828
Epoch 20/50
 - 15s - loss: 0.1833 - calc_accuracy: 0.7398 - val_loss: 0.2107 - val_calc_accuracy: 0.6685
Epoch 21/50
 - 15s - loss: 0.1832 - calc_accuracy: 0.7319 - val_loss: 0.2306 - val_calc_accuracy: 0.6290
Epoch 22/50
 - 15s - loss: 0.1817 - calc_accuracy: 0.7468 - val_loss: 0.2131 - val_calc_accuracy: 0.6630
Epoch 23/50
 - 15s - loss: 0.1792 - calc_accuracy: 0.7426 - val_loss: 0.1895 - val_calc_accuracy: 0.7112
Epoch 24/50
 - 15s - loss: 0.1791 - calc_accuracy: 0.7450 - val_loss: 0.1862 - val_calc_accuracy: 0.7215
Epoch 25/50
 - 15s - loss: 0.1769 - calc_accuracy: 0.7518 - val_loss: 0.2157 - val_calc_accuracy: 0.6590
Epoch 26/50
 - 15s - loss: 0.1782 - calc_accuracy: 0.7478 - val_loss: 0.2253 - val_calc_accuracy: 0.6369
Epoch 27/50
 - 15s - loss: 0.1762 - calc_accuracy: 0.7578 - val_loss: 0.1917 - val_calc_accuracy: 0.7097
Epoch 28/50
 - 15s - loss: 0.1747 - calc_accuracy: 0.7574 - val_loss: 0.1908 - val_calc_accuracy: 0.7128
Epoch 29/50
 - 15s - loss: 0.1723 - calc_accuracy: 0.7623 - val_loss: 0.1785 - val_calc_accuracy: 0.7358
Epoch 30/50
 - 15s - loss: 0.1704 - calc_accuracy: 0.7574 - val_loss: 0.2022 - val_calc_accuracy: 0.6835
Epoch 31/50
 - 15s - loss: 0.1701 - calc_accuracy: 0.7663 - val_loss: 0.1900 - val_calc_accuracy: 0.7073
Epoch 32/50
 - 15s - loss: 0.1700 - calc_accuracy: 0.7669 - val_loss: 0.2895 - val_calc_accuracy: 0.5150
Epoch 33/50
 - 15s - loss: 0.1666 - calc_accuracy: 0.7739 - val_loss: 0.1851 - val_calc_accuracy: 0.7223
Epoch 34/50
 - 15s - loss: 0.1665 - calc_accuracy: 0.7729 - val_loss: 0.1921 - val_calc_accuracy: 0.7002
Epoch 35/50
 - 15s - loss: 0.1625 - calc_accuracy: 0.7822 - val_loss: 0.1735 - val_calc_accuracy: 0.7453
Epoch 36/50
 - 15s - loss: 0.1657 - calc_accuracy: 0.7733 - val_loss: 0.2157 - val_calc_accuracy: 0.6543
Epoch 37/50
 - 15s - loss: 0.1601 - calc_accuracy: 0.7876 - val_loss: 0.1865 - val_calc_accuracy: 0.7136
Epoch 38/50
 - 15s - loss: 0.1592 - calc_accuracy: 0.7888 - val_loss: 0.2074 - val_calc_accuracy: 0.6725
Epoch 39/50
 - 15s - loss: 0.1612 - calc_accuracy: 0.7872 - val_loss: 0.2431 - val_calc_accuracy: 0.5910
Epoch 40/50
 - 15s - loss: 0.1583 - calc_accuracy: 0.7888 - val_loss: 0.2187 - val_calc_accuracy: 0.6511
Epoch 41/50
 - 15s - loss: 0.1600 - calc_accuracy: 0.7838 - val_loss: 0.2138 - val_calc_accuracy: 0.6574
Epoch 42/50
 - 15s - loss: 0.1586 - calc_accuracy: 0.7892 - val_loss: 0.2315 - val_calc_accuracy: 0.6195
Epoch 43/50
 - 15s - loss: 0.1577 - calc_accuracy: 0.7966 - val_loss: 0.1760 - val_calc_accuracy: 0.7318
Epoch 44/50
 - 15s - loss: 0.1587 - calc_accuracy: 0.7838 - val_loss: 0.2016 - val_calc_accuracy: 0.6835
Epoch 45/50
 - 15s - loss: 0.1562 - calc_accuracy: 0.7898 - val_loss: 0.1943 - val_calc_accuracy: 0.6994
Epoch 46/50
 - 15s - loss: 0.1565 - calc_accuracy: 0.7936 - val_loss: 0.1711 - val_calc_accuracy: 0.7484
Epoch 47/50
 - 15s - loss: 0.1557 - calc_accuracy: 0.7944 - val_loss: 0.1636 - val_calc_accuracy: 0.7563
Epoch 48/50
 - 15s - loss: 0.1559 - calc_accuracy: 0.7932 - val_loss: 0.1802 - val_calc_accuracy: 0.7207
Epoch 49/50
 - 15s - loss: 0.1554 - calc_accuracy: 0.7934 - val_loss: 0.1821 - val_calc_accuracy: 0.7144
Epoch 50/50
 - 15s - loss: 0.1542 - calc_accuracy: 0.7976 - val_loss: 0.1663 - val_calc_accuracy: 0.7540
Test accuracy: 0.7539556962025317
Train on 5024 samples, validate on 1264 samples
Epoch 1/50
 - 59s - loss: 0.4089 - calc_accuracy: 0.5169 - val_loss: 0.4392 - val_calc_accuracy: 0.5000
Epoch 2/50
 - 53s - loss: 0.2778 - calc_accuracy: 0.5028 - val_loss: 0.4211 - val_calc_accuracy: 0.5000
Epoch 3/50
 - 53s - loss: 0.2918 - calc_accuracy: 0.5123 - val_loss: 0.3454 - val_calc_accuracy: 0.5000
Epoch 4/50
 - 53s - loss: 0.2601 - calc_accuracy: 0.5143 - val_loss: 0.4275 - val_calc_accuracy: 0.5000
Epoch 5/50
 - 53s - loss: 0.3508 - calc_accuracy: 0.5078 - val_loss: 0.3362 - val_calc_accuracy: 0.5000
Epoch 6/50
 - 53s - loss: 0.2641 - calc_accuracy: 0.4988 - val_loss: 0.3831 - val_calc_accuracy: 0.5000
Epoch 7/50
 - 53s - loss: 0.2694 - calc_accuracy: 0.5121 - val_loss: 0.2961 - val_calc_accuracy: 0.5008
Epoch 8/50
 - 53s - loss: 0.4567 - calc_accuracy: 0.5038 - val_loss: 0.3821 - val_calc_accuracy: 0.5000
Epoch 9/50
 - 53s - loss: 0.2594 - calc_accuracy: 0.5305 - val_loss: 0.2308 - val_calc_accuracy: 0.6013
Epoch 10/50
 - 53s - loss: 0.2680 - calc_accuracy: 0.5316 - val_loss: 0.2848 - val_calc_accuracy: 0.5047
Epoch 11/50
 - 53s - loss: 0.2532 - calc_accuracy: 0.5390 - val_loss: 0.3404 - val_calc_accuracy: 0.5000
Epoch 12/50
 - 53s - loss: 0.2502 - calc_accuracy: 0.5697 - val_loss: 0.2230 - val_calc_accuracy: 0.6044
Epoch 13/50
 - 53s - loss: 0.5787 - calc_accuracy: 0.6399 - val_loss: 0.3425 - val_calc_accuracy: 0.5000
Epoch 14/50
 - 53s - loss: 0.2565 - calc_accuracy: 0.5143 - val_loss: 0.4572 - val_calc_accuracy: 0.5000
Epoch 15/50
 - 53s - loss: 0.2513 - calc_accuracy: 0.5038 - val_loss: 0.4643 - val_calc_accuracy: 0.5000
Epoch 16/50
 - 53s - loss: 0.2522 - calc_accuracy: 0.5028 - val_loss: 0.2883 - val_calc_accuracy: 0.5008
Epoch 17/50
 - 53s - loss: 0.2533 - calc_accuracy: 0.5121 - val_loss: 0.4158 - val_calc_accuracy: 0.5000
Epoch 18/50
 - 53s - loss: 0.2615 - calc_accuracy: 0.4978 - val_loss: 0.4610 - val_calc_accuracy: 0.5000
Epoch 19/50
 - 53s - loss: 0.2527 - calc_accuracy: 0.5100 - val_loss: 0.3968 - val_calc_accuracy: 0.5000
Epoch 20/50
 - 53s - loss: 0.2124 - calc_accuracy: 0.6660 - val_loss: 0.2195 - val_calc_accuracy: 0.6519
Epoch 21/50
 - 53s - loss: 0.4871 - calc_accuracy: 0.5458 - val_loss: 0.4438 - val_calc_accuracy: 0.5000
Epoch 22/50
 - 53s - loss: 0.3234 - calc_accuracy: 0.5036 - val_loss: 0.3996 - val_calc_accuracy: 0.5000
Epoch 23/50
 - 52s - loss: 0.7853 - calc_accuracy: 0.5681 - val_loss: 0.2126 - val_calc_accuracy: 0.6812
Epoch 24/50
 - 53s - loss: 0.2012 - calc_accuracy: 0.6925 - val_loss: 0.3106 - val_calc_accuracy: 0.5079
Epoch 25/50
 - 53s - loss: 0.1824 - calc_accuracy: 0.7259 - val_loss: 0.1959 - val_calc_accuracy: 0.6780
Epoch 26/50
 - 53s - loss: 0.1824 - calc_accuracy: 0.7301 - val_loss: 0.1509 - val_calc_accuracy: 0.7983
Epoch 27/50
 - 53s - loss: 0.1558 - calc_accuracy: 0.7763 - val_loss: 0.2644 - val_calc_accuracy: 0.5641
Epoch 28/50
 - 53s - loss: 0.1623 - calc_accuracy: 0.7705 - val_loss: 0.1469 - val_calc_accuracy: 0.8109
Epoch 29/50
 - 54s - loss: 0.1405 - calc_accuracy: 0.8089 - val_loss: 0.1723 - val_calc_accuracy: 0.7563
Epoch 30/50
 - 53s - loss: 0.1773 - calc_accuracy: 0.7799 - val_loss: 0.1778 - val_calc_accuracy: 0.6986
Epoch 31/50
 - 53s - loss: 0.1291 - calc_accuracy: 0.8290 - val_loss: 0.2047 - val_calc_accuracy: 0.6930
Epoch 32/50
 - 53s - loss: 0.1333 - calc_accuracy: 0.8262 - val_loss: 0.1180 - val_calc_accuracy: 0.8600
Epoch 33/50
 - 53s - loss: 0.2518 - calc_accuracy: 0.7038 - val_loss: 0.3029 - val_calc_accuracy: 0.5578
Epoch 34/50
 - 53s - loss: 0.1734 - calc_accuracy: 0.7665 - val_loss: 0.1552 - val_calc_accuracy: 0.7872
Epoch 35/50
 - 53s - loss: 0.1235 - calc_accuracy: 0.8404 - val_loss: 0.1191 - val_calc_accuracy: 0.8497
Epoch 36/50
 - 52s - loss: 0.1290 - calc_accuracy: 0.8344 - val_loss: 0.4660 - val_calc_accuracy: 0.5222
Epoch 37/50
 - 53s - loss: 0.1293 - calc_accuracy: 0.8340 - val_loss: 0.1272 - val_calc_accuracy: 0.8457
Epoch 38/50
 - 52s - loss: 0.1095 - calc_accuracy: 0.8654 - val_loss: 0.1894 - val_calc_accuracy: 0.6804
Epoch 39/50
 - 52s - loss: 0.1871 - calc_accuracy: 0.7188 - val_loss: 0.4848 - val_calc_accuracy: 0.5000
Epoch 40/50
 - 53s - loss: 0.2525 - calc_accuracy: 0.4801 - val_loss: 0.4989 - val_calc_accuracy: 0.5000
Epoch 41/50
 - 52s - loss: 0.2519 - calc_accuracy: 0.4988 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 42/50
 - 52s - loss: 0.2527 - calc_accuracy: 0.4867 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 43/50
 - 53s - loss: 0.2519 - calc_accuracy: 0.4980 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 44/50
 - 52s - loss: 0.2516 - calc_accuracy: 0.4972 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 45/50
 - 52s - loss: 0.2516 - calc_accuracy: 0.4912 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 46/50
 - 52s - loss: 0.2518 - calc_accuracy: 0.5010 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 47/50
 - 53s - loss: 0.2521 - calc_accuracy: 0.4879 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 48/50
 - 53s - loss: 0.2518 - calc_accuracy: 0.4896 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 49/50
 - 52s - loss: 0.2512 - calc_accuracy: 0.5040 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 50/50
 - 53s - loss: 0.2515 - calc_accuracy: 0.5016 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Test accuracy: 0.5
Train on 5024 samples, validate on 1264 samples
Epoch 1/50
 - 19s - loss: 0.2901 - calc_accuracy: 0.4980 - val_loss: 0.4526 - val_calc_accuracy: 0.5000
Epoch 2/50
 - 17s - loss: 0.2667 - calc_accuracy: 0.4968 - val_loss: 0.4640 - val_calc_accuracy: 0.5000
Epoch 3/50
 - 17s - loss: 0.2658 - calc_accuracy: 0.5102 - val_loss: 0.4648 - val_calc_accuracy: 0.5000
Epoch 4/50
 - 17s - loss: 0.2656 - calc_accuracy: 0.4976 - val_loss: 0.4327 - val_calc_accuracy: 0.5000
Epoch 5/50
 - 17s - loss: 0.2644 - calc_accuracy: 0.5010 - val_loss: 0.4327 - val_calc_accuracy: 0.5000
Epoch 6/50
 - 17s - loss: 0.2683 - calc_accuracy: 0.5040 - val_loss: 0.4385 - val_calc_accuracy: 0.5000
Epoch 7/50
 - 17s - loss: 0.2620 - calc_accuracy: 0.4996 - val_loss: 0.4390 - val_calc_accuracy: 0.5000
Epoch 8/50
 - 17s - loss: 0.2632 - calc_accuracy: 0.4875 - val_loss: 0.4668 - val_calc_accuracy: 0.5000
Epoch 9/50
 - 17s - loss: 0.2602 - calc_accuracy: 0.5002 - val_loss: 0.4746 - val_calc_accuracy: 0.5000
Epoch 10/50
 - 18s - loss: 0.2587 - calc_accuracy: 0.4956 - val_loss: 0.4686 - val_calc_accuracy: 0.5000
Epoch 11/50
 - 18s - loss: 0.2606 - calc_accuracy: 0.5024 - val_loss: 0.4701 - val_calc_accuracy: 0.5000
Epoch 12/50
 - 18s - loss: 0.2606 - calc_accuracy: 0.4900 - val_loss: 0.4629 - val_calc_accuracy: 0.5000
Epoch 13/50
 - 17s - loss: 0.2565 - calc_accuracy: 0.5098 - val_loss: 0.4596 - val_calc_accuracy: 0.5000
Epoch 14/50
 - 17s - loss: 0.2578 - calc_accuracy: 0.4978 - val_loss: 0.4769 - val_calc_accuracy: 0.5000
Epoch 15/50
 - 17s - loss: 0.2599 - calc_accuracy: 0.4968 - val_loss: 0.4735 - val_calc_accuracy: 0.5000
Epoch 16/50
 - 17s - loss: 0.2585 - calc_accuracy: 0.4978 - val_loss: 0.4630 - val_calc_accuracy: 0.5000
Epoch 17/50
 - 17s - loss: 0.2571 - calc_accuracy: 0.5076 - val_loss: 0.4583 - val_calc_accuracy: 0.5000
Epoch 18/50
 - 18s - loss: 0.2565 - calc_accuracy: 0.5064 - val_loss: 0.4422 - val_calc_accuracy: 0.5000
Epoch 19/50
 - 17s - loss: 0.2579 - calc_accuracy: 0.4982 - val_loss: 0.4579 - val_calc_accuracy: 0.5000
Epoch 20/50
 - 18s - loss: 0.2588 - calc_accuracy: 0.4938 - val_loss: 0.4699 - val_calc_accuracy: 0.5000
Epoch 21/50
 - 17s - loss: 0.2580 - calc_accuracy: 0.4952 - val_loss: 0.4612 - val_calc_accuracy: 0.5000
Epoch 22/50
 - 18s - loss: 0.2575 - calc_accuracy: 0.4982 - val_loss: 0.4661 - val_calc_accuracy: 0.5000
Epoch 23/50
 - 17s - loss: 0.2588 - calc_accuracy: 0.5004 - val_loss: 0.4719 - val_calc_accuracy: 0.5000
Epoch 24/50
 - 18s - loss: 0.2563 - calc_accuracy: 0.5052 - val_loss: 0.4643 - val_calc_accuracy: 0.5000
Epoch 25/50
 - 18s - loss: 0.2563 - calc_accuracy: 0.5020 - val_loss: 0.4798 - val_calc_accuracy: 0.5000
Epoch 26/50
 - 18s - loss: 0.2569 - calc_accuracy: 0.5076 - val_loss: 0.4297 - val_calc_accuracy: 0.5000
Epoch 27/50
 - 18s - loss: 0.2587 - calc_accuracy: 0.5012 - val_loss: 0.4436 - val_calc_accuracy: 0.5000
Epoch 28/50
 - 17s - loss: 0.2575 - calc_accuracy: 0.5000 - val_loss: 0.4278 - val_calc_accuracy: 0.5000
Epoch 29/50
 - 17s - loss: 0.2562 - calc_accuracy: 0.4958 - val_loss: 0.4273 - val_calc_accuracy: 0.5000
Epoch 30/50
 - 17s - loss: 0.2554 - calc_accuracy: 0.5090 - val_loss: 0.4887 - val_calc_accuracy: 0.5000
Epoch 31/50
 - 17s - loss: 0.2564 - calc_accuracy: 0.4952 - val_loss: 0.4814 - val_calc_accuracy: 0.5000
Epoch 32/50
 - 18s - loss: 0.2563 - calc_accuracy: 0.4964 - val_loss: 0.4369 - val_calc_accuracy: 0.5000
Epoch 33/50
 - 17s - loss: 0.2555 - calc_accuracy: 0.5086 - val_loss: 0.4724 - val_calc_accuracy: 0.5000
Epoch 34/50
 - 17s - loss: 0.2565 - calc_accuracy: 0.4944 - val_loss: 0.4759 - val_calc_accuracy: 0.5000
Epoch 35/50
 - 18s - loss: 0.2539 - calc_accuracy: 0.5157 - val_loss: 0.4589 - val_calc_accuracy: 0.5000
Epoch 36/50
 - 17s - loss: 0.2551 - calc_accuracy: 0.5050 - val_loss: 0.4240 - val_calc_accuracy: 0.5000
Epoch 37/50
 - 18s - loss: 0.2566 - calc_accuracy: 0.5054 - val_loss: 0.4253 - val_calc_accuracy: 0.5000
Epoch 38/50
 - 17s - loss: 0.2575 - calc_accuracy: 0.5016 - val_loss: 0.3824 - val_calc_accuracy: 0.5000
Epoch 39/50
 - 18s - loss: 0.2557 - calc_accuracy: 0.4986 - val_loss: 0.3732 - val_calc_accuracy: 0.5000
Epoch 40/50
 - 17s - loss: 0.2533 - calc_accuracy: 0.5135 - val_loss: 0.3909 - val_calc_accuracy: 0.5000
Epoch 41/50
 - 17s - loss: 0.2488 - calc_accuracy: 0.5446 - val_loss: 0.4239 - val_calc_accuracy: 0.5000
Epoch 42/50
 - 18s - loss: 0.2320 - calc_accuracy: 0.6037 - val_loss: 0.2168 - val_calc_accuracy: 0.6677
Epoch 43/50
 - 17s - loss: 0.2108 - calc_accuracy: 0.6555 - val_loss: 0.1830 - val_calc_accuracy: 0.7278
Epoch 44/50
 - 17s - loss: 0.1942 - calc_accuracy: 0.6973 - val_loss: 0.1951 - val_calc_accuracy: 0.7144
Epoch 45/50
 - 17s - loss: 0.1808 - calc_accuracy: 0.7387 - val_loss: 0.1589 - val_calc_accuracy: 0.7682
Epoch 46/50
 - 17s - loss: 0.1691 - calc_accuracy: 0.7564 - val_loss: 0.1463 - val_calc_accuracy: 0.7856
Epoch 47/50
 - 17s - loss: 0.1646 - calc_accuracy: 0.7615 - val_loss: 0.1494 - val_calc_accuracy: 0.7975
Epoch 48/50
 - 17s - loss: 0.1566 - calc_accuracy: 0.7795 - val_loss: 0.1450 - val_calc_accuracy: 0.7967
Epoch 49/50
 - 17s - loss: 0.1493 - calc_accuracy: 0.7910 - val_loss: 0.1444 - val_calc_accuracy: 0.8054
Epoch 50/50
 - 17s - loss: 0.1434 - calc_accuracy: 0.8045 - val_loss: 0.1183 - val_calc_accuracy: 0.8370
Test accuracy: 0.8370253164556962
Train on 5024 samples, validate on 1264 samples
Epoch 1/50
 - 36s - loss: 0.3293 - calc_accuracy: 0.5105 - val_loss: 0.4204 - val_calc_accuracy: 0.5000
Epoch 2/50
 - 33s - loss: 0.2628 - calc_accuracy: 0.5105 - val_loss: 0.4337 - val_calc_accuracy: 0.5000
Epoch 3/50
 - 33s - loss: 0.2687 - calc_accuracy: 0.5008 - val_loss: 0.4490 - val_calc_accuracy: 0.5000
Epoch 4/50
 - 33s - loss: 0.2709 - calc_accuracy: 0.5062 - val_loss: 0.4272 - val_calc_accuracy: 0.5000
Epoch 5/50
 - 33s - loss: 0.2665 - calc_accuracy: 0.5040 - val_loss: 0.4725 - val_calc_accuracy: 0.5000
Epoch 6/50
 - 33s - loss: 0.2658 - calc_accuracy: 0.5066 - val_loss: 0.4374 - val_calc_accuracy: 0.5000
Epoch 7/50
 - 33s - loss: 0.2631 - calc_accuracy: 0.5133 - val_loss: 0.4576 - val_calc_accuracy: 0.5000
Epoch 8/50
 - 33s - loss: 0.2630 - calc_accuracy: 0.5137 - val_loss: 0.4414 - val_calc_accuracy: 0.5000
Epoch 9/50
 - 33s - loss: 0.2595 - calc_accuracy: 0.5267 - val_loss: 0.4171 - val_calc_accuracy: 0.5000
Epoch 10/50
 - 33s - loss: 0.2584 - calc_accuracy: 0.5362 - val_loss: 0.4000 - val_calc_accuracy: 0.5000
Epoch 11/50
 - 33s - loss: 0.2571 - calc_accuracy: 0.5281 - val_loss: 0.3491 - val_calc_accuracy: 0.5000
Epoch 12/50
 - 33s - loss: 0.2555 - calc_accuracy: 0.5466 - val_loss: 0.4444 - val_calc_accuracy: 0.5000
Epoch 13/50
 - 33s - loss: 0.2528 - calc_accuracy: 0.5565 - val_loss: 0.3755 - val_calc_accuracy: 0.5000
Epoch 14/50
 - 33s - loss: 0.2468 - calc_accuracy: 0.5623 - val_loss: 0.2886 - val_calc_accuracy: 0.5396
Epoch 15/50
 - 33s - loss: 0.2471 - calc_accuracy: 0.5766 - val_loss: 0.3264 - val_calc_accuracy: 0.5000
Epoch 16/50
 - 33s - loss: 0.2256 - calc_accuracy: 0.6246 - val_loss: 0.2157 - val_calc_accuracy: 0.6630
Epoch 17/50
 - 33s - loss: 0.2155 - calc_accuracy: 0.6606 - val_loss: 0.2016 - val_calc_accuracy: 0.6891
Epoch 18/50
 - 32s - loss: 0.2126 - calc_accuracy: 0.6660 - val_loss: 0.2235 - val_calc_accuracy: 0.6495
Epoch 19/50
 - 33s - loss: 0.1903 - calc_accuracy: 0.7076 - val_loss: 0.1961 - val_calc_accuracy: 0.7104
Epoch 20/50
 - 33s - loss: 0.1936 - calc_accuracy: 0.7028 - val_loss: 0.1979 - val_calc_accuracy: 0.7009
Epoch 21/50
 - 33s - loss: 0.1786 - calc_accuracy: 0.7321 - val_loss: 0.1713 - val_calc_accuracy: 0.7429
Epoch 22/50
 - 33s - loss: 0.1739 - calc_accuracy: 0.7351 - val_loss: 0.1945 - val_calc_accuracy: 0.6930
Epoch 23/50
 - 33s - loss: 0.1733 - calc_accuracy: 0.7440 - val_loss: 0.1761 - val_calc_accuracy: 0.7397
Epoch 24/50
 - 33s - loss: 0.1713 - calc_accuracy: 0.7510 - val_loss: 0.1562 - val_calc_accuracy: 0.7816
Epoch 25/50
 - 32s - loss: 0.1608 - calc_accuracy: 0.7661 - val_loss: 0.1676 - val_calc_accuracy: 0.7698
Epoch 26/50
 - 33s - loss: 0.1595 - calc_accuracy: 0.7669 - val_loss: 0.2022 - val_calc_accuracy: 0.6859
Epoch 27/50
 - 33s - loss: 0.1560 - calc_accuracy: 0.7848 - val_loss: 0.1601 - val_calc_accuracy: 0.7722
Epoch 28/50
 - 33s - loss: 0.1526 - calc_accuracy: 0.7932 - val_loss: 0.1584 - val_calc_accuracy: 0.7816
Epoch 29/50
 - 33s - loss: 0.1446 - calc_accuracy: 0.8002 - val_loss: 0.1496 - val_calc_accuracy: 0.7911
Epoch 30/50
 - 33s - loss: 0.1448 - calc_accuracy: 0.8047 - val_loss: 0.1494 - val_calc_accuracy: 0.7943
Epoch 31/50
 - 33s - loss: 0.1446 - calc_accuracy: 0.7986 - val_loss: 0.1383 - val_calc_accuracy: 0.8188
Epoch 32/50
 - 32s - loss: 0.1405 - calc_accuracy: 0.8103 - val_loss: 0.1504 - val_calc_accuracy: 0.7998
Epoch 33/50
 - 33s - loss: 0.1381 - calc_accuracy: 0.8189 - val_loss: 0.1252 - val_calc_accuracy: 0.8331
Epoch 34/50
 - 33s - loss: 0.1344 - calc_accuracy: 0.8290 - val_loss: 0.1406 - val_calc_accuracy: 0.8085
Epoch 35/50
 - 33s - loss: 0.1316 - calc_accuracy: 0.8348 - val_loss: 0.1391 - val_calc_accuracy: 0.8244
Epoch 36/50
 - 33s - loss: 0.1266 - calc_accuracy: 0.8404 - val_loss: 0.1336 - val_calc_accuracy: 0.8236
Epoch 37/50
 - 32s - loss: 0.1256 - calc_accuracy: 0.8404 - val_loss: 0.1153 - val_calc_accuracy: 0.8631
Epoch 38/50
 - 33s - loss: 0.1205 - calc_accuracy: 0.8505 - val_loss: 0.1570 - val_calc_accuracy: 0.7919
Epoch 39/50
 - 32s - loss: 0.1187 - calc_accuracy: 0.8551 - val_loss: 0.1056 - val_calc_accuracy: 0.8742
Epoch 40/50
 - 32s - loss: 0.1214 - calc_accuracy: 0.8523 - val_loss: 0.1135 - val_calc_accuracy: 0.8726
Epoch 41/50
 - 33s - loss: 0.1112 - calc_accuracy: 0.8684 - val_loss: 0.1080 - val_calc_accuracy: 0.8797
Epoch 42/50
 - 32s - loss: 0.1125 - calc_accuracy: 0.8696 - val_loss: 0.1106 - val_calc_accuracy: 0.8750
Epoch 43/50
 - 33s - loss: 0.1101 - calc_accuracy: 0.8690 - val_loss: 0.1257 - val_calc_accuracy: 0.8275
Epoch 44/50
 - 33s - loss: 0.1068 - calc_accuracy: 0.8762 - val_loss: 0.1569 - val_calc_accuracy: 0.7959
Epoch 45/50
 - 33s - loss: 0.1084 - calc_accuracy: 0.8754 - val_loss: 0.1063 - val_calc_accuracy: 0.8703
Epoch 46/50
 - 32s - loss: 0.1041 - calc_accuracy: 0.8806 - val_loss: 0.1009 - val_calc_accuracy: 0.8877
Epoch 47/50
 - 33s - loss: 0.1023 - calc_accuracy: 0.8816 - val_loss: 0.0909 - val_calc_accuracy: 0.8979
Epoch 48/50
 - 33s - loss: 0.1003 - calc_accuracy: 0.8850 - val_loss: 0.1155 - val_calc_accuracy: 0.8797
Epoch 49/50
 - 33s - loss: 0.1001 - calc_accuracy: 0.8857 - val_loss: 0.0963 - val_calc_accuracy: 0.8956
Epoch 50/50
 - 33s - loss: 0.0969 - calc_accuracy: 0.8901 - val_loss: 0.0895 - val_calc_accuracy: 0.9051
Test accuracy: 0.9050632911392406
Train on 5024 samples, validate on 1264 samples
Epoch 1/50
 - 12s - loss: 0.2602 - calc_accuracy: 0.5072 - val_loss: 0.4197 - val_calc_accuracy: 0.5000
Epoch 2/50
 - 11s - loss: 0.2601 - calc_accuracy: 0.5018 - val_loss: 0.4427 - val_calc_accuracy: 0.5000
Epoch 3/50
 - 11s - loss: 0.2600 - calc_accuracy: 0.4968 - val_loss: 0.4164 - val_calc_accuracy: 0.5000
Epoch 4/50
 - 11s - loss: 0.2582 - calc_accuracy: 0.5064 - val_loss: 0.4222 - val_calc_accuracy: 0.5000
Epoch 5/50
 - 11s - loss: 0.2534 - calc_accuracy: 0.5080 - val_loss: 0.4320 - val_calc_accuracy: 0.5000
Epoch 6/50
 - 11s - loss: 0.2528 - calc_accuracy: 0.5199 - val_loss: 0.3853 - val_calc_accuracy: 0.5000
Epoch 7/50
 - 11s - loss: 0.2526 - calc_accuracy: 0.5255 - val_loss: 0.3873 - val_calc_accuracy: 0.5000
Epoch 8/50
 - 11s - loss: 0.2503 - calc_accuracy: 0.5396 - val_loss: 0.4211 - val_calc_accuracy: 0.5000
Epoch 9/50
 - 11s - loss: 0.2474 - calc_accuracy: 0.5561 - val_loss: 0.3603 - val_calc_accuracy: 0.5000
Epoch 10/50
 - 11s - loss: 0.2399 - calc_accuracy: 0.5904 - val_loss: 0.3297 - val_calc_accuracy: 0.5016
Epoch 11/50
 - 11s - loss: 0.2229 - calc_accuracy: 0.6375 - val_loss: 0.2675 - val_calc_accuracy: 0.5316
Epoch 12/50
 - 11s - loss: 0.2001 - calc_accuracy: 0.6957 - val_loss: 0.2212 - val_calc_accuracy: 0.6377
Epoch 13/50
 - 11s - loss: 0.1871 - calc_accuracy: 0.7355 - val_loss: 0.2806 - val_calc_accuracy: 0.5277
Epoch 14/50
 - 11s - loss: 0.1804 - calc_accuracy: 0.7446 - val_loss: 0.1988 - val_calc_accuracy: 0.6772
Epoch 15/50
 - 11s - loss: 0.1765 - calc_accuracy: 0.7530 - val_loss: 0.2582 - val_calc_accuracy: 0.5498
Epoch 16/50
 - 11s - loss: 0.1702 - calc_accuracy: 0.7637 - val_loss: 0.2290 - val_calc_accuracy: 0.6147
Epoch 17/50
 - 11s - loss: 0.1696 - calc_accuracy: 0.7582 - val_loss: 0.1869 - val_calc_accuracy: 0.7089
Epoch 18/50
 - 11s - loss: 0.1636 - calc_accuracy: 0.7747 - val_loss: 0.2172 - val_calc_accuracy: 0.6384
Epoch 19/50
 - 11s - loss: 0.1609 - calc_accuracy: 0.7842 - val_loss: 0.1688 - val_calc_accuracy: 0.7484
Epoch 20/50
 - 11s - loss: 0.1575 - calc_accuracy: 0.7854 - val_loss: 0.1735 - val_calc_accuracy: 0.7366
Epoch 21/50
 - 11s - loss: 0.1557 - calc_accuracy: 0.7908 - val_loss: 0.1994 - val_calc_accuracy: 0.6875
Epoch 22/50
 - 11s - loss: 0.1533 - calc_accuracy: 0.7938 - val_loss: 0.1716 - val_calc_accuracy: 0.7421
Epoch 23/50
 - 11s - loss: 0.1518 - calc_accuracy: 0.7982 - val_loss: 0.1744 - val_calc_accuracy: 0.7421
Epoch 24/50
 - 11s - loss: 0.1482 - calc_accuracy: 0.8077 - val_loss: 0.1530 - val_calc_accuracy: 0.7872
Epoch 25/50
 - 11s - loss: 0.1472 - calc_accuracy: 0.8103 - val_loss: 0.1640 - val_calc_accuracy: 0.7682
Epoch 26/50
 - 11s - loss: 0.1449 - calc_accuracy: 0.8139 - val_loss: 0.1486 - val_calc_accuracy: 0.7927
Epoch 27/50
 - 11s - loss: 0.1432 - calc_accuracy: 0.8167 - val_loss: 0.1647 - val_calc_accuracy: 0.7579
Epoch 28/50
 - 11s - loss: 0.1410 - calc_accuracy: 0.8197 - val_loss: 0.1698 - val_calc_accuracy: 0.7516
Epoch 29/50
 - 11s - loss: 0.1393 - calc_accuracy: 0.8268 - val_loss: 0.1524 - val_calc_accuracy: 0.7816
Epoch 30/50
 - 11s - loss: 0.1401 - calc_accuracy: 0.8248 - val_loss: 0.1606 - val_calc_accuracy: 0.7745
Epoch 31/50
 - 11s - loss: 0.1381 - calc_accuracy: 0.8276 - val_loss: 0.1488 - val_calc_accuracy: 0.7888
Epoch 32/50
 - 11s - loss: 0.1360 - calc_accuracy: 0.8288 - val_loss: 0.1537 - val_calc_accuracy: 0.7880
Epoch 33/50
 - 11s - loss: 0.1353 - calc_accuracy: 0.8256 - val_loss: 0.1473 - val_calc_accuracy: 0.7991
Epoch 34/50
 - 11s - loss: 0.1335 - calc_accuracy: 0.8350 - val_loss: 0.1403 - val_calc_accuracy: 0.8172
Epoch 35/50
 - 11s - loss: 0.1345 - calc_accuracy: 0.8376 - val_loss: 0.1359 - val_calc_accuracy: 0.8228
Epoch 36/50
 - 11s - loss: 0.1315 - calc_accuracy: 0.8426 - val_loss: 0.1505 - val_calc_accuracy: 0.7864
Epoch 37/50
 - 11s - loss: 0.1318 - calc_accuracy: 0.8386 - val_loss: 0.1830 - val_calc_accuracy: 0.7097
Epoch 38/50
 - 11s - loss: 0.1326 - calc_accuracy: 0.8374 - val_loss: 0.1309 - val_calc_accuracy: 0.8275
Epoch 39/50
 - 11s - loss: 0.1299 - calc_accuracy: 0.8396 - val_loss: 0.1613 - val_calc_accuracy: 0.7555
Epoch 40/50
 - 11s - loss: 0.1300 - calc_accuracy: 0.8428 - val_loss: 0.1393 - val_calc_accuracy: 0.8165
Epoch 41/50
 - 11s - loss: 0.1290 - calc_accuracy: 0.8416 - val_loss: 0.1298 - val_calc_accuracy: 0.8244
Epoch 42/50
 - 11s - loss: 0.1285 - calc_accuracy: 0.8406 - val_loss: 0.1265 - val_calc_accuracy: 0.8299
Epoch 43/50
 - 11s - loss: 0.1281 - calc_accuracy: 0.8471 - val_loss: 0.1392 - val_calc_accuracy: 0.8093
Epoch 44/50
 - 11s - loss: 0.1251 - calc_accuracy: 0.8489 - val_loss: 0.1313 - val_calc_accuracy: 0.8323
Epoch 45/50
 - 11s - loss: 0.1246 - calc_accuracy: 0.8489 - val_loss: 0.1431 - val_calc_accuracy: 0.8070
Epoch 46/50
 - 11s - loss: 0.1244 - calc_accuracy: 0.8501 - val_loss: 0.1458 - val_calc_accuracy: 0.7935
Epoch 47/50
 - 11s - loss: 0.1234 - calc_accuracy: 0.8501 - val_loss: 0.1408 - val_calc_accuracy: 0.7967
Epoch 48/50
 - 11s - loss: 0.1231 - calc_accuracy: 0.8547 - val_loss: 0.1468 - val_calc_accuracy: 0.7975
Epoch 49/50
 - 11s - loss: 0.1237 - calc_accuracy: 0.8491 - val_loss: 0.1202 - val_calc_accuracy: 0.8497
Epoch 50/50
 - 11s - loss: 0.1207 - calc_accuracy: 0.8565 - val_loss: 0.1669 - val_calc_accuracy: 0.7389
Test accuracy: 0.7389240506329114
Train on 5024 samples, validate on 1264 samples
Epoch 1/50
 - 15s - loss: 0.2987 - calc_accuracy: 0.5165 - val_loss: 0.3823 - val_calc_accuracy: 0.5016
Epoch 2/50
 - 14s - loss: 0.2493 - calc_accuracy: 0.5342 - val_loss: 0.3619 - val_calc_accuracy: 0.5016
Epoch 3/50
 - 14s - loss: 0.2462 - calc_accuracy: 0.5508 - val_loss: 0.3177 - val_calc_accuracy: 0.5206
Epoch 4/50
 - 14s - loss: 0.2429 - calc_accuracy: 0.5697 - val_loss: 0.2622 - val_calc_accuracy: 0.5949
Epoch 5/50
 - 14s - loss: 0.2348 - calc_accuracy: 0.6059 - val_loss: 0.2923 - val_calc_accuracy: 0.5277
Epoch 6/50
 - 14s - loss: 0.2228 - calc_accuracy: 0.6373 - val_loss: 0.2021 - val_calc_accuracy: 0.6772
Epoch 7/50
 - 14s - loss: 0.2097 - calc_accuracy: 0.6702 - val_loss: 0.2106 - val_calc_accuracy: 0.6590
Epoch 8/50
 - 14s - loss: 0.1966 - calc_accuracy: 0.6996 - val_loss: 0.1701 - val_calc_accuracy: 0.7516
Epoch 9/50
 - 14s - loss: 0.1837 - calc_accuracy: 0.7325 - val_loss: 0.1584 - val_calc_accuracy: 0.7761
Epoch 10/50
 - 14s - loss: 0.1725 - calc_accuracy: 0.7468 - val_loss: 0.1586 - val_calc_accuracy: 0.7658
Epoch 11/50
 - 14s - loss: 0.1627 - calc_accuracy: 0.7745 - val_loss: 0.1442 - val_calc_accuracy: 0.7959
Epoch 12/50
 - 14s - loss: 0.1450 - calc_accuracy: 0.8065 - val_loss: 0.1303 - val_calc_accuracy: 0.8204
Epoch 13/50
 - 14s - loss: 0.1368 - calc_accuracy: 0.8175 - val_loss: 0.1278 - val_calc_accuracy: 0.8370
Epoch 14/50
 - 14s - loss: 0.1353 - calc_accuracy: 0.8205 - val_loss: 0.1201 - val_calc_accuracy: 0.8370
Epoch 15/50
 - 14s - loss: 0.1293 - calc_accuracy: 0.8288 - val_loss: 0.1337 - val_calc_accuracy: 0.8085
Epoch 16/50
 - 14s - loss: 0.1225 - calc_accuracy: 0.8394 - val_loss: 0.1102 - val_calc_accuracy: 0.8528
Epoch 17/50
 - 14s - loss: 0.1198 - calc_accuracy: 0.8406 - val_loss: 0.1404 - val_calc_accuracy: 0.8109
Epoch 18/50
 - 14s - loss: 0.1158 - calc_accuracy: 0.8521 - val_loss: 0.1203 - val_calc_accuracy: 0.8291
Epoch 19/50
 - 14s - loss: 0.1111 - calc_accuracy: 0.8625 - val_loss: 0.1193 - val_calc_accuracy: 0.8473
Epoch 20/50
 - 14s - loss: 0.1062 - calc_accuracy: 0.8728 - val_loss: 0.1159 - val_calc_accuracy: 0.8536
Epoch 21/50
 - 14s - loss: 0.1069 - calc_accuracy: 0.8625 - val_loss: 0.1051 - val_calc_accuracy: 0.8813
Epoch 22/50
 - 14s - loss: 0.1018 - calc_accuracy: 0.8788 - val_loss: 0.1101 - val_calc_accuracy: 0.8608
Epoch 23/50
 - 14s - loss: 0.1006 - calc_accuracy: 0.8774 - val_loss: 0.0942 - val_calc_accuracy: 0.8877
Epoch 24/50
 - 15s - loss: 0.0961 - calc_accuracy: 0.8852 - val_loss: 0.0895 - val_calc_accuracy: 0.8916
Epoch 25/50
 - 14s - loss: 0.0936 - calc_accuracy: 0.8883 - val_loss: 0.2011 - val_calc_accuracy: 0.6756
Epoch 26/50
 - 14s - loss: 0.0966 - calc_accuracy: 0.8861 - val_loss: 0.1054 - val_calc_accuracy: 0.8528
Epoch 27/50
 - 14s - loss: 0.0891 - calc_accuracy: 0.8985 - val_loss: 0.1066 - val_calc_accuracy: 0.8592
Epoch 28/50
 - 14s - loss: 0.0870 - calc_accuracy: 0.9031 - val_loss: 0.1016 - val_calc_accuracy: 0.8710
Epoch 29/50
 - 14s - loss: 0.0879 - calc_accuracy: 0.8993 - val_loss: 0.1420 - val_calc_accuracy: 0.7935
Epoch 30/50
 - 14s - loss: 0.0880 - calc_accuracy: 0.9029 - val_loss: 0.0846 - val_calc_accuracy: 0.9082
Epoch 31/50
 - 14s - loss: 0.0816 - calc_accuracy: 0.9094 - val_loss: 0.0792 - val_calc_accuracy: 0.9122
Epoch 32/50
 - 14s - loss: 0.0782 - calc_accuracy: 0.9172 - val_loss: 0.1099 - val_calc_accuracy: 0.8505
Epoch 33/50
 - 14s - loss: 0.0801 - calc_accuracy: 0.9102 - val_loss: 0.0856 - val_calc_accuracy: 0.8916
Epoch 34/50
 - 14s - loss: 0.0787 - calc_accuracy: 0.9124 - val_loss: 0.0824 - val_calc_accuracy: 0.9090
Epoch 35/50
 - 14s - loss: 0.0774 - calc_accuracy: 0.9182 - val_loss: 0.0821 - val_calc_accuracy: 0.9027
Epoch 36/50
 - 14s - loss: 0.0773 - calc_accuracy: 0.9202 - val_loss: 0.0858 - val_calc_accuracy: 0.8924
Epoch 37/50
 - 14s - loss: 0.0721 - calc_accuracy: 0.9287 - val_loss: 0.0908 - val_calc_accuracy: 0.8916
Epoch 38/50
 - 14s - loss: 0.0741 - calc_accuracy: 0.9228 - val_loss: 0.0863 - val_calc_accuracy: 0.8995
Epoch 39/50
 - 14s - loss: 0.0734 - calc_accuracy: 0.9164 - val_loss: 0.0740 - val_calc_accuracy: 0.9169
Epoch 40/50
 - 14s - loss: 0.0715 - calc_accuracy: 0.9250 - val_loss: 0.0870 - val_calc_accuracy: 0.9019
Epoch 41/50
 - 14s - loss: 0.0706 - calc_accuracy: 0.9256 - val_loss: 0.0742 - val_calc_accuracy: 0.9153
Epoch 42/50
 - 14s - loss: 0.0695 - calc_accuracy: 0.9266 - val_loss: 0.0693 - val_calc_accuracy: 0.9272
Epoch 43/50
 - 14s - loss: 0.0709 - calc_accuracy: 0.9256 - val_loss: 0.0724 - val_calc_accuracy: 0.9185
Epoch 44/50
 - 14s - loss: 0.0690 - calc_accuracy: 0.9283 - val_loss: 0.0731 - val_calc_accuracy: 0.9248
Epoch 45/50
 - 14s - loss: 0.0662 - calc_accuracy: 0.9327 - val_loss: 0.0862 - val_calc_accuracy: 0.8884
Epoch 46/50
 - 14s - loss: 0.0650 - calc_accuracy: 0.9317 - val_loss: 0.0713 - val_calc_accuracy: 0.9209
Epoch 47/50
 - 14s - loss: 0.0642 - calc_accuracy: 0.9345 - val_loss: 0.0906 - val_calc_accuracy: 0.8869
Epoch 48/50
 - 14s - loss: 0.0644 - calc_accuracy: 0.9329 - val_loss: 0.0669 - val_calc_accuracy: 0.9296
Epoch 49/50
 - 14s - loss: 0.0628 - calc_accuracy: 0.9415 - val_loss: 0.0774 - val_calc_accuracy: 0.8995
Epoch 50/50
 - 14s - loss: 0.0607 - calc_accuracy: 0.9395 - val_loss: 0.0631 - val_calc_accuracy: 0.9343
Test accuracy: 0.9343354430379747
Train on 5024 samples, validate on 1264 samples
Epoch 1/50
 - 34s - loss: 0.3468 - calc_accuracy: 0.5165 - val_loss: 0.3530 - val_calc_accuracy: 0.5032
Epoch 2/50
 - 31s - loss: 0.2437 - calc_accuracy: 0.5659 - val_loss: 0.2923 - val_calc_accuracy: 0.5119
Epoch 3/50
 - 30s - loss: 0.2270 - calc_accuracy: 0.6278 - val_loss: 0.2039 - val_calc_accuracy: 0.6717
Epoch 4/50
 - 31s - loss: 0.2251 - calc_accuracy: 0.6318 - val_loss: 0.2242 - val_calc_accuracy: 0.6432
Epoch 5/50
 - 31s - loss: 0.2116 - calc_accuracy: 0.6674 - val_loss: 0.1894 - val_calc_accuracy: 0.7017
Epoch 6/50
 - 31s - loss: 0.2205 - calc_accuracy: 0.6572 - val_loss: 0.2055 - val_calc_accuracy: 0.6748
Epoch 7/50
 - 30s - loss: 0.2007 - calc_accuracy: 0.6941 - val_loss: 0.1902 - val_calc_accuracy: 0.7073
Epoch 8/50
 - 31s - loss: 0.1970 - calc_accuracy: 0.7042 - val_loss: 0.1775 - val_calc_accuracy: 0.7381
Epoch 9/50
 - 31s - loss: 0.1837 - calc_accuracy: 0.7259 - val_loss: 0.2520 - val_calc_accuracy: 0.5530
Epoch 10/50
 - 31s - loss: 0.3964 - calc_accuracy: 0.5434 - val_loss: 0.1992 - val_calc_accuracy: 0.6962
Epoch 11/50
 - 31s - loss: 0.2430 - calc_accuracy: 0.6218 - val_loss: 0.1817 - val_calc_accuracy: 0.7176
Epoch 12/50
 - 30s - loss: 0.2004 - calc_accuracy: 0.6947 - val_loss: 0.1761 - val_calc_accuracy: 0.7350
Epoch 13/50
 - 30s - loss: 0.1932 - calc_accuracy: 0.7118 - val_loss: 0.3233 - val_calc_accuracy: 0.5079
Epoch 14/50
 - 31s - loss: 0.2534 - calc_accuracy: 0.5559 - val_loss: 0.4998 - val_calc_accuracy: 0.5000
Epoch 15/50
 - 31s - loss: 0.2248 - calc_accuracy: 0.6531 - val_loss: 0.2106 - val_calc_accuracy: 0.6788
Epoch 16/50
 - 31s - loss: 0.1917 - calc_accuracy: 0.7030 - val_loss: 0.1994 - val_calc_accuracy: 0.6788
Epoch 17/50
 - 31s - loss: 0.1858 - calc_accuracy: 0.7301 - val_loss: 0.1752 - val_calc_accuracy: 0.7358
Epoch 18/50
 - 31s - loss: 0.1796 - calc_accuracy: 0.7428 - val_loss: 0.1816 - val_calc_accuracy: 0.7366
Epoch 19/50
 - 30s - loss: 0.1728 - calc_accuracy: 0.7520 - val_loss: 0.1671 - val_calc_accuracy: 0.7524
Epoch 20/50
 - 31s - loss: 0.1581 - calc_accuracy: 0.7838 - val_loss: 0.2416 - val_calc_accuracy: 0.5728
Epoch 21/50
 - 30s - loss: 0.2958 - calc_accuracy: 0.6049 - val_loss: 0.1996 - val_calc_accuracy: 0.6851
Epoch 22/50
 - 31s - loss: 0.1715 - calc_accuracy: 0.7534 - val_loss: 0.2061 - val_calc_accuracy: 0.7231
Epoch 23/50
 - 31s - loss: 0.1591 - calc_accuracy: 0.7731 - val_loss: 0.1606 - val_calc_accuracy: 0.7650
Epoch 24/50
 - 31s - loss: 0.1538 - calc_accuracy: 0.7818 - val_loss: 0.1435 - val_calc_accuracy: 0.8101
Epoch 25/50
 - 31s - loss: 0.1553 - calc_accuracy: 0.7816 - val_loss: 0.1503 - val_calc_accuracy: 0.7959
Epoch 26/50
 - 31s - loss: 0.1613 - calc_accuracy: 0.7791 - val_loss: 0.1633 - val_calc_accuracy: 0.7674
Epoch 27/50
 - 31s - loss: 0.1426 - calc_accuracy: 0.8081 - val_loss: 0.1354 - val_calc_accuracy: 0.8165
Epoch 28/50
 - 31s - loss: 0.1381 - calc_accuracy: 0.8181 - val_loss: 0.1768 - val_calc_accuracy: 0.7160
Epoch 29/50
 - 30s - loss: 0.1562 - calc_accuracy: 0.7818 - val_loss: 0.1513 - val_calc_accuracy: 0.7975
Epoch 30/50
 - 31s - loss: 0.1376 - calc_accuracy: 0.8252 - val_loss: 0.1359 - val_calc_accuracy: 0.7998
Epoch 31/50
 - 31s - loss: 0.1312 - calc_accuracy: 0.8254 - val_loss: 0.1301 - val_calc_accuracy: 0.8220
Epoch 32/50
 - 31s - loss: 0.1234 - calc_accuracy: 0.8344 - val_loss: 0.1439 - val_calc_accuracy: 0.8133
Epoch 33/50
 - 30s - loss: 0.1214 - calc_accuracy: 0.8432 - val_loss: 0.1272 - val_calc_accuracy: 0.8426
Epoch 34/50
 - 30s - loss: 0.1218 - calc_accuracy: 0.8400 - val_loss: 0.1135 - val_calc_accuracy: 0.8560
Epoch 35/50
 - 30s - loss: 0.1269 - calc_accuracy: 0.8344 - val_loss: 0.1435 - val_calc_accuracy: 0.8125
Epoch 36/50
 - 30s - loss: 0.1730 - calc_accuracy: 0.7874 - val_loss: 0.1705 - val_calc_accuracy: 0.7587
Epoch 37/50
 - 30s - loss: 0.1163 - calc_accuracy: 0.8489 - val_loss: 0.1213 - val_calc_accuracy: 0.8386
Epoch 38/50
 - 30s - loss: 0.1057 - calc_accuracy: 0.8676 - val_loss: 0.1500 - val_calc_accuracy: 0.7793
Epoch 39/50
 - 31s - loss: 0.1055 - calc_accuracy: 0.8716 - val_loss: 0.1265 - val_calc_accuracy: 0.8402
Epoch 40/50
 - 30s - loss: 0.1045 - calc_accuracy: 0.8744 - val_loss: 0.1370 - val_calc_accuracy: 0.8101
Epoch 41/50
 - 30s - loss: 0.1005 - calc_accuracy: 0.8834 - val_loss: 0.1394 - val_calc_accuracy: 0.8157
Epoch 42/50
 - 31s - loss: 0.1053 - calc_accuracy: 0.8684 - val_loss: 0.1335 - val_calc_accuracy: 0.8196
Epoch 43/50
 - 30s - loss: 0.0963 - calc_accuracy: 0.8855 - val_loss: 0.1248 - val_calc_accuracy: 0.8449
Epoch 44/50
 - 31s - loss: 0.4455 - calc_accuracy: 0.5189 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 45/50
 - 31s - loss: 0.4890 - calc_accuracy: 0.4998 - val_loss: 0.4432 - val_calc_accuracy: 0.5000
Epoch 46/50
 - 30s - loss: nan - calc_accuracy: 0.5020 - val_loss: nan - val_calc_accuracy: 0.5000
Epoch 47/50
 - 29s - loss: nan - calc_accuracy: 0.5000 - val_loss: nan - val_calc_accuracy: 0.5000
Epoch 48/50
 - 29s - loss: nan - calc_accuracy: 0.5000 - val_loss: nan - val_calc_accuracy: 0.5000
Epoch 49/50
 - 30s - loss: nan - calc_accuracy: 0.5000 - val_loss: nan - val_calc_accuracy: 0.5000
Epoch 50/50
 - 29s - loss: nan - calc_accuracy: 0.5000 - val_loss: nan - val_calc_accuracy: 0.5000
Test accuracy: 0.5
Train on 5024 samples, validate on 1264 samples
Epoch 1/50
 - 29s - loss: 0.9744 - calc_accuracy: 0.5143 - val_loss: 0.3519 - val_calc_accuracy: 0.5103
Epoch 2/50
 - 29s - loss: 0.2830 - calc_accuracy: 0.5657 - val_loss: 0.2539 - val_calc_accuracy: 0.6028
Epoch 3/50
 - 29s - loss: 0.3181 - calc_accuracy: 0.5693 - val_loss: 0.2421 - val_calc_accuracy: 0.6242
Epoch 4/50
 - 29s - loss: 0.2108 - calc_accuracy: 0.6672 - val_loss: 0.1843 - val_calc_accuracy: 0.7318
Epoch 5/50
 - 29s - loss: 0.1842 - calc_accuracy: 0.7233 - val_loss: 0.1649 - val_calc_accuracy: 0.7777
Epoch 6/50
 - 29s - loss: 0.1644 - calc_accuracy: 0.7594 - val_loss: 0.1763 - val_calc_accuracy: 0.7389
Epoch 7/50
 - 29s - loss: 2.0328 - calc_accuracy: 0.6332 - val_loss: 0.4936 - val_calc_accuracy: 0.5000
Epoch 8/50
 - 29s - loss: 8.7474 - calc_accuracy: 0.4998 - val_loss: 0.4567 - val_calc_accuracy: 0.5000
Epoch 9/50
 - 29s - loss: 14.6348 - calc_accuracy: 0.4996 - val_loss: 0.3999 - val_calc_accuracy: 0.5000
Epoch 10/50
 - 29s - loss: 10.7909 - calc_accuracy: 0.5010 - val_loss: 0.4906 - val_calc_accuracy: 0.5000
Epoch 11/50
 - 29s - loss: 1.1618 - calc_accuracy: 0.5070 - val_loss: 0.4802 - val_calc_accuracy: 0.5000
Epoch 12/50
 - 29s - loss: 0.7204 - calc_accuracy: 0.4984 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 13/50
 - 28s - loss: 0.5000 - calc_accuracy: 0.5000 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 14/50
 - 28s - loss: 0.5000 - calc_accuracy: 0.5000 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 15/50
 - 28s - loss: 0.5000 - calc_accuracy: 0.5000 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 16/50
 - 28s - loss: 0.5000 - calc_accuracy: 0.5000 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 17/50
 - 28s - loss: 0.5000 - calc_accuracy: 0.5000 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 18/50
 - 28s - loss: 0.5000 - calc_accuracy: 0.5000 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 19/50
 - 28s - loss: 0.5000 - calc_accuracy: 0.5000 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 20/50
 - 29s - loss: 0.5000 - calc_accuracy: 0.5000 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 21/50
 - 28s - loss: 0.5000 - calc_accuracy: 0.5000 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 22/50
 - 29s - loss: 0.5000 - calc_accuracy: 0.5000 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 23/50
 - 29s - loss: 0.5000 - calc_accuracy: 0.5000 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 24/50
 - 28s - loss: 0.5000 - calc_accuracy: 0.5000 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 25/50
 - 28s - loss: 0.5000 - calc_accuracy: 0.5000 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 26/50
 - 28s - loss: 0.5000 - calc_accuracy: 0.5000 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 27/50
 - 29s - loss: 0.5000 - calc_accuracy: 0.5000 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 28/50
 - 29s - loss: 0.5000 - calc_accuracy: 0.5000 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 29/50
 - 28s - loss: 0.5000 - calc_accuracy: 0.5000 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 30/50
 - 28s - loss: 0.5000 - calc_accuracy: 0.5000 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 31/50
 - 28s - loss: 0.5000 - calc_accuracy: 0.5000 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 32/50
 - 28s - loss: 0.5000 - calc_accuracy: 0.5000 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 33/50
 - 29s - loss: 0.5000 - calc_accuracy: 0.5000 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 34/50
 - 28s - loss: 0.5000 - calc_accuracy: 0.5000 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 35/50
 - 28s - loss: 0.5000 - calc_accuracy: 0.5000 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 36/50
 - 29s - loss: 0.5000 - calc_accuracy: 0.5000 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 37/50
 - 29s - loss: 0.5000 - calc_accuracy: 0.5000 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 38/50
 - 28s - loss: 0.5000 - calc_accuracy: 0.5000 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 39/50
 - 28s - loss: 0.5000 - calc_accuracy: 0.5000 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 40/50
 - 29s - loss: 0.5000 - calc_accuracy: 0.5000 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 41/50
 - 28s - loss: 0.5000 - calc_accuracy: 0.5000 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 42/50
 - 29s - loss: 0.5000 - calc_accuracy: 0.5000 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 43/50
 - 29s - loss: 0.5000 - calc_accuracy: 0.5000 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 44/50
 - 28s - loss: 0.5000 - calc_accuracy: 0.5000 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 45/50
 - 28s - loss: 0.5000 - calc_accuracy: 0.5000 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 46/50
 - 29s - loss: 0.5000 - calc_accuracy: 0.5000 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 47/50
 - 28s - loss: 0.5000 - calc_accuracy: 0.5000 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 48/50
 - 28s - loss: 0.5000 - calc_accuracy: 0.5000 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 49/50
 - 28s - loss: 0.5000 - calc_accuracy: 0.5000 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 50/50
 - 29s - loss: 0.5000 - calc_accuracy: 0.5000 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Test accuracy: 0.5
Train on 5024 samples, validate on 1264 samples
Epoch 1/50
 - 14s - loss: 0.3423 - calc_accuracy: 0.5062 - val_loss: 0.4174 - val_calc_accuracy: 0.5000
Epoch 2/50
 - 12s - loss: 0.2629 - calc_accuracy: 0.5104 - val_loss: 0.3608 - val_calc_accuracy: 0.5000
Epoch 3/50
 - 12s - loss: 0.2620 - calc_accuracy: 0.5243 - val_loss: 0.3539 - val_calc_accuracy: 0.5000
Epoch 4/50
 - 12s - loss: 0.2575 - calc_accuracy: 0.5382 - val_loss: 0.3240 - val_calc_accuracy: 0.5134
Epoch 5/50
 - 12s - loss: 0.2279 - calc_accuracy: 0.6274 - val_loss: 0.1737 - val_calc_accuracy: 0.7397
Epoch 6/50
 - 12s - loss: 0.1895 - calc_accuracy: 0.7146 - val_loss: 0.1718 - val_calc_accuracy: 0.7468
Epoch 7/50
 - 12s - loss: 0.1697 - calc_accuracy: 0.7560 - val_loss: 0.1763 - val_calc_accuracy: 0.7350
Epoch 8/50
 - 12s - loss: 0.1523 - calc_accuracy: 0.7922 - val_loss: 0.1502 - val_calc_accuracy: 0.7983
Epoch 9/50
 - 12s - loss: 0.1455 - calc_accuracy: 0.8035 - val_loss: 0.1364 - val_calc_accuracy: 0.8228
Epoch 10/50
 - 12s - loss: 0.1392 - calc_accuracy: 0.8195 - val_loss: 0.1332 - val_calc_accuracy: 0.8204
Epoch 11/50
 - 12s - loss: 0.1232 - calc_accuracy: 0.8499 - val_loss: 0.1264 - val_calc_accuracy: 0.8354
Epoch 12/50
 - 13s - loss: 0.1219 - calc_accuracy: 0.8491 - val_loss: 0.1152 - val_calc_accuracy: 0.8505
Epoch 13/50
 - 12s - loss: 0.1174 - calc_accuracy: 0.8547 - val_loss: 0.1137 - val_calc_accuracy: 0.8742
Epoch 14/50
 - 12s - loss: 0.1059 - calc_accuracy: 0.8842 - val_loss: 0.1387 - val_calc_accuracy: 0.8259
Epoch 15/50
 - 12s - loss: 0.1057 - calc_accuracy: 0.8820 - val_loss: 0.1043 - val_calc_accuracy: 0.8845
Epoch 16/50
 - 12s - loss: 0.1007 - calc_accuracy: 0.8887 - val_loss: 0.0913 - val_calc_accuracy: 0.9043
Epoch 17/50
 - 12s - loss: 0.0953 - calc_accuracy: 0.8935 - val_loss: 0.1037 - val_calc_accuracy: 0.8639
Epoch 18/50
 - 12s - loss: 0.0914 - calc_accuracy: 0.9062 - val_loss: 0.0866 - val_calc_accuracy: 0.9043
Epoch 19/50
 - 12s - loss: 0.0914 - calc_accuracy: 0.9015 - val_loss: 0.0958 - val_calc_accuracy: 0.8845
Epoch 20/50
 - 12s - loss: 0.0866 - calc_accuracy: 0.9118 - val_loss: 0.0823 - val_calc_accuracy: 0.9066
Epoch 21/50
 - 12s - loss: 0.0863 - calc_accuracy: 0.9084 - val_loss: 0.0891 - val_calc_accuracy: 0.8948
Epoch 22/50
 - 12s - loss: 0.0827 - calc_accuracy: 0.9188 - val_loss: 0.0979 - val_calc_accuracy: 0.8829
Epoch 23/50
 - 12s - loss: 0.0752 - calc_accuracy: 0.9283 - val_loss: 0.0970 - val_calc_accuracy: 0.8790
Epoch 24/50
 - 12s - loss: 0.0764 - calc_accuracy: 0.9273 - val_loss: 0.0811 - val_calc_accuracy: 0.9090
Epoch 25/50
 - 12s - loss: 0.0754 - calc_accuracy: 0.9279 - val_loss: 0.0884 - val_calc_accuracy: 0.8956
Epoch 26/50
 - 12s - loss: 0.0693 - calc_accuracy: 0.9405 - val_loss: 0.0720 - val_calc_accuracy: 0.9217
Epoch 27/50
 - 12s - loss: 0.0676 - calc_accuracy: 0.9393 - val_loss: 0.0729 - val_calc_accuracy: 0.9256
Epoch 28/50
 - 12s - loss: 0.0644 - calc_accuracy: 0.9492 - val_loss: 0.0805 - val_calc_accuracy: 0.9098
Epoch 29/50
 - 12s - loss: 0.0636 - calc_accuracy: 0.9498 - val_loss: 0.0809 - val_calc_accuracy: 0.9051
Epoch 30/50
 - 13s - loss: 0.0611 - calc_accuracy: 0.9522 - val_loss: 0.0740 - val_calc_accuracy: 0.9241
Epoch 31/50
 - 12s - loss: 0.0606 - calc_accuracy: 0.9512 - val_loss: 0.0786 - val_calc_accuracy: 0.9122
Epoch 32/50
 - 12s - loss: 0.0582 - calc_accuracy: 0.9524 - val_loss: 0.0739 - val_calc_accuracy: 0.9241
Epoch 33/50
 - 12s - loss: 0.0601 - calc_accuracy: 0.9534 - val_loss: 0.0754 - val_calc_accuracy: 0.9248
Epoch 34/50
 - 12s - loss: 0.0562 - calc_accuracy: 0.9602 - val_loss: 0.0692 - val_calc_accuracy: 0.9217
Epoch 35/50
 - 12s - loss: 0.0559 - calc_accuracy: 0.9578 - val_loss: 0.0603 - val_calc_accuracy: 0.9470
Epoch 36/50
 - 12s - loss: 0.0538 - calc_accuracy: 0.9618 - val_loss: 0.0665 - val_calc_accuracy: 0.9280
Epoch 37/50
 - 12s - loss: 0.0537 - calc_accuracy: 0.9642 - val_loss: 0.0666 - val_calc_accuracy: 0.9304
Epoch 38/50
 - 12s - loss: 0.0527 - calc_accuracy: 0.9628 - val_loss: 0.0764 - val_calc_accuracy: 0.9153
Epoch 39/50
 - 12s - loss: 0.0511 - calc_accuracy: 0.9680 - val_loss: 0.0636 - val_calc_accuracy: 0.9351
Epoch 40/50
 - 12s - loss: 0.0474 - calc_accuracy: 0.9747 - val_loss: 0.0660 - val_calc_accuracy: 0.9422
Epoch 41/50
 - 12s - loss: 0.0502 - calc_accuracy: 0.9682 - val_loss: 0.0644 - val_calc_accuracy: 0.9359
Epoch 42/50
 - 12s - loss: 0.0448 - calc_accuracy: 0.9753 - val_loss: 0.0588 - val_calc_accuracy: 0.9462
Epoch 43/50
 - 13s - loss: 0.0466 - calc_accuracy: 0.9739 - val_loss: 0.0513 - val_calc_accuracy: 0.9612
Epoch 44/50
 - 12s - loss: 0.0454 - calc_accuracy: 0.9729 - val_loss: 0.0586 - val_calc_accuracy: 0.9399
Epoch 45/50
 - 12s - loss: 0.0455 - calc_accuracy: 0.9765 - val_loss: 0.0675 - val_calc_accuracy: 0.9304
Epoch 46/50
 - 12s - loss: 0.0465 - calc_accuracy: 0.9749 - val_loss: 0.0817 - val_calc_accuracy: 0.8979
Epoch 47/50
 - 12s - loss: 0.0455 - calc_accuracy: 0.9757 - val_loss: 0.0534 - val_calc_accuracy: 0.9509
Epoch 48/50
 - 12s - loss: 0.0423 - calc_accuracy: 0.9819 - val_loss: 0.0537 - val_calc_accuracy: 0.9470
Epoch 49/50
 - 12s - loss: 0.0420 - calc_accuracy: 0.9797 - val_loss: 0.0566 - val_calc_accuracy: 0.9470
Epoch 50/50
 - 12s - loss: 0.0432 - calc_accuracy: 0.9765 - val_loss: 0.0547 - val_calc_accuracy: 0.9573
Test accuracy: 0.9572784810126582
Train on 5024 samples, validate on 1264 samples
Epoch 1/50
 - 52s - loss: 0.3788 - calc_accuracy: 0.5074 - val_loss: 0.4616 - val_calc_accuracy: 0.5000
Epoch 2/50
 - 51s - loss: 0.2652 - calc_accuracy: 0.4902 - val_loss: 0.4664 - val_calc_accuracy: 0.5000
Epoch 3/50
 - 51s - loss: 0.2683 - calc_accuracy: 0.4887 - val_loss: 0.4682 - val_calc_accuracy: 0.5000
Epoch 4/50
 - 51s - loss: 0.2702 - calc_accuracy: 0.5052 - val_loss: 0.4402 - val_calc_accuracy: 0.5000
Epoch 5/50
 - 51s - loss: 0.2667 - calc_accuracy: 0.4956 - val_loss: 0.4615 - val_calc_accuracy: 0.5000
Epoch 6/50
 - 51s - loss: 0.2657 - calc_accuracy: 0.5032 - val_loss: 0.4440 - val_calc_accuracy: 0.5000
Epoch 7/50
 - 51s - loss: 0.2626 - calc_accuracy: 0.4932 - val_loss: 0.4537 - val_calc_accuracy: 0.5000
Epoch 8/50
 - 51s - loss: 0.2618 - calc_accuracy: 0.5111 - val_loss: 0.4630 - val_calc_accuracy: 0.5000
Epoch 9/50
 - 51s - loss: 0.2625 - calc_accuracy: 0.4926 - val_loss: 0.4650 - val_calc_accuracy: 0.5000
Epoch 10/50
 - 51s - loss: 0.2649 - calc_accuracy: 0.5030 - val_loss: 0.4524 - val_calc_accuracy: 0.5000
Epoch 11/50
 - 51s - loss: 0.2612 - calc_accuracy: 0.5060 - val_loss: 0.4530 - val_calc_accuracy: 0.5000
Epoch 12/50
 - 50s - loss: 0.2634 - calc_accuracy: 0.4996 - val_loss: 0.4551 - val_calc_accuracy: 0.5000
Epoch 13/50
 - 51s - loss: 0.2654 - calc_accuracy: 0.5038 - val_loss: 0.4369 - val_calc_accuracy: 0.5000
Epoch 14/50
 - 51s - loss: 0.2615 - calc_accuracy: 0.4982 - val_loss: 0.4355 - val_calc_accuracy: 0.5000
Epoch 15/50
 - 50s - loss: 0.2594 - calc_accuracy: 0.5028 - val_loss: 0.4579 - val_calc_accuracy: 0.5000
Epoch 16/50
 - 51s - loss: 0.2630 - calc_accuracy: 0.4998 - val_loss: 0.4431 - val_calc_accuracy: 0.5000
Epoch 17/50
 - 51s - loss: 0.2606 - calc_accuracy: 0.4972 - val_loss: 0.4389 - val_calc_accuracy: 0.5000
Epoch 18/50
 - 52s - loss: 0.2610 - calc_accuracy: 0.4964 - val_loss: 0.4583 - val_calc_accuracy: 0.5000
Epoch 19/50
 - 51s - loss: 0.2730 - calc_accuracy: 0.5058 - val_loss: 0.4425 - val_calc_accuracy: 0.5000
Epoch 20/50
 - 51s - loss: 0.2565 - calc_accuracy: 0.5032 - val_loss: 0.4472 - val_calc_accuracy: 0.5000
Epoch 21/50
 - 51s - loss: 0.2586 - calc_accuracy: 0.5006 - val_loss: 0.4405 - val_calc_accuracy: 0.5000
Epoch 22/50
 - 51s - loss: 0.2615 - calc_accuracy: 0.4900 - val_loss: 0.4599 - val_calc_accuracy: 0.5000
Epoch 23/50
 - 51s - loss: 0.2676 - calc_accuracy: 0.5016 - val_loss: 0.4487 - val_calc_accuracy: 0.5000
Epoch 24/50
 - 51s - loss: 0.2587 - calc_accuracy: 0.4996 - val_loss: 0.4555 - val_calc_accuracy: 0.5000
Epoch 25/50
 - 51s - loss: 0.2688 - calc_accuracy: 0.5030 - val_loss: 0.4519 - val_calc_accuracy: 0.5000
Epoch 26/50
 - 51s - loss: 0.2589 - calc_accuracy: 0.5028 - val_loss: 0.4564 - val_calc_accuracy: 0.5000
Epoch 27/50
 - 51s - loss: 0.2628 - calc_accuracy: 0.4996 - val_loss: 0.4588 - val_calc_accuracy: 0.5000
Epoch 28/50
 - 51s - loss: 0.2576 - calc_accuracy: 0.4984 - val_loss: 0.4544 - val_calc_accuracy: 0.5000
Epoch 29/50
 - 51s - loss: 0.2660 - calc_accuracy: 0.5040 - val_loss: 0.4370 - val_calc_accuracy: 0.5000
Epoch 30/50
 - 51s - loss: 0.2604 - calc_accuracy: 0.5010 - val_loss: 0.4244 - val_calc_accuracy: 0.5000
Epoch 31/50
 - 51s - loss: 0.2575 - calc_accuracy: 0.5169 - val_loss: 0.4558 - val_calc_accuracy: 0.5000
Epoch 32/50
 - 51s - loss: 0.2590 - calc_accuracy: 0.5052 - val_loss: 0.4404 - val_calc_accuracy: 0.5000
Epoch 33/50
 - 51s - loss: 0.2602 - calc_accuracy: 0.5139 - val_loss: 0.4489 - val_calc_accuracy: 0.5000
Epoch 34/50
 - 51s - loss: 0.2585 - calc_accuracy: 0.5109 - val_loss: 0.4491 - val_calc_accuracy: 0.5000
Epoch 35/50
 - 51s - loss: 0.2591 - calc_accuracy: 0.5018 - val_loss: 0.4456 - val_calc_accuracy: 0.5000
Epoch 36/50
 - 51s - loss: 0.2585 - calc_accuracy: 0.5038 - val_loss: 0.4339 - val_calc_accuracy: 0.5000
Epoch 37/50
 - 51s - loss: 0.2592 - calc_accuracy: 0.4956 - val_loss: 0.4344 - val_calc_accuracy: 0.5000
Epoch 38/50
 - 52s - loss: 0.2608 - calc_accuracy: 0.4908 - val_loss: 0.4446 - val_calc_accuracy: 0.5000
Epoch 39/50
 - 51s - loss: 0.2587 - calc_accuracy: 0.5022 - val_loss: 0.4482 - val_calc_accuracy: 0.5000
Epoch 40/50
 - 52s - loss: 0.2596 - calc_accuracy: 0.4988 - val_loss: 0.4444 - val_calc_accuracy: 0.5000
Epoch 41/50
 - 51s - loss: 0.2592 - calc_accuracy: 0.4930 - val_loss: 0.4615 - val_calc_accuracy: 0.5000
Epoch 42/50
 - 51s - loss: 0.2614 - calc_accuracy: 0.4895 - val_loss: 0.4384 - val_calc_accuracy: 0.5000
Epoch 43/50
 - 51s - loss: 0.2619 - calc_accuracy: 0.5010 - val_loss: 0.4425 - val_calc_accuracy: 0.5000
Epoch 44/50
 - 51s - loss: 0.2598 - calc_accuracy: 0.4956 - val_loss: 0.4381 - val_calc_accuracy: 0.5000
Epoch 45/50
 - 51s - loss: 0.2596 - calc_accuracy: 0.4954 - val_loss: 0.4322 - val_calc_accuracy: 0.5000
Epoch 46/50
 - 51s - loss: 0.2546 - calc_accuracy: 0.5102 - val_loss: 0.4519 - val_calc_accuracy: 0.5000
Epoch 47/50
 - 51s - loss: 0.2610 - calc_accuracy: 0.5020 - val_loss: 0.4147 - val_calc_accuracy: 0.5000
Epoch 48/50
 - 51s - loss: 0.2818 - calc_accuracy: 0.4966 - val_loss: 0.4193 - val_calc_accuracy: 0.5000
Epoch 49/50
 - 51s - loss: 0.2589 - calc_accuracy: 0.5012 - val_loss: 0.4426 - val_calc_accuracy: 0.5000
Epoch 50/50
 - 51s - loss: 0.2558 - calc_accuracy: 0.5076 - val_loss: 0.4457 - val_calc_accuracy: 0.5000
Test accuracy: 0.5
Train on 5024 samples, validate on 1264 samples
Epoch 1/50
 - 86s - loss: 0.3339 - calc_accuracy: 0.5500 - val_loss: 0.2401 - val_calc_accuracy: 0.6345
Epoch 2/50
 - 79s - loss: 0.2252 - calc_accuracy: 0.6298 - val_loss: 0.2498 - val_calc_accuracy: 0.5902
Epoch 3/50
 - 78s - loss: 0.2475 - calc_accuracy: 0.5402 - val_loss: 0.4993 - val_calc_accuracy: 0.5000
Epoch 4/50
 - 78s - loss: 0.2509 - calc_accuracy: 0.5111 - val_loss: 0.4997 - val_calc_accuracy: 0.5000
Epoch 5/50
 - 78s - loss: 0.2524 - calc_accuracy: 0.4928 - val_loss: 0.4994 - val_calc_accuracy: 0.5000
Epoch 6/50
 - 79s - loss: 0.2514 - calc_accuracy: 0.5028 - val_loss: 0.4999 - val_calc_accuracy: 0.5000
Epoch 7/50
 - 78s - loss: 0.2526 - calc_accuracy: 0.4972 - val_loss: 0.4999 - val_calc_accuracy: 0.5000
Epoch 8/50
 - 79s - loss: 0.2510 - calc_accuracy: 0.5084 - val_loss: 0.4999 - val_calc_accuracy: 0.5000
Epoch 9/50
 - 78s - loss: 0.2516 - calc_accuracy: 0.5046 - val_loss: 0.4999 - val_calc_accuracy: 0.5000
Epoch 10/50
 - 78s - loss: 0.2517 - calc_accuracy: 0.5006 - val_loss: 0.4998 - val_calc_accuracy: 0.5000
Epoch 11/50
 - 78s - loss: 0.2516 - calc_accuracy: 0.5056 - val_loss: 0.4998 - val_calc_accuracy: 0.5000
Epoch 12/50
 - 78s - loss: 0.2521 - calc_accuracy: 0.4976 - val_loss: 0.4999 - val_calc_accuracy: 0.5000
Epoch 13/50
 - 78s - loss: 0.2514 - calc_accuracy: 0.5050 - val_loss: 0.4999 - val_calc_accuracy: 0.5000
Epoch 14/50
 - 78s - loss: 0.2521 - calc_accuracy: 0.4908 - val_loss: 0.4999 - val_calc_accuracy: 0.5000
Epoch 15/50
 - 78s - loss: 0.2518 - calc_accuracy: 0.4952 - val_loss: 0.4994 - val_calc_accuracy: 0.5000
Epoch 16/50
 - 78s - loss: 0.2514 - calc_accuracy: 0.4996 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 17/50
 - 78s - loss: 0.2512 - calc_accuracy: 0.5058 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 18/50
 - 78s - loss: 0.2527 - calc_accuracy: 0.4964 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 19/50
 - 78s - loss: 0.2521 - calc_accuracy: 0.4900 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 20/50
 - 78s - loss: 0.2517 - calc_accuracy: 0.4972 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 21/50
 - 78s - loss: 0.2511 - calc_accuracy: 0.5060 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 22/50
 - 78s - loss: 0.2518 - calc_accuracy: 0.4990 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 23/50
 - 79s - loss: 0.2513 - calc_accuracy: 0.5032 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 24/50
 - 78s - loss: 0.2514 - calc_accuracy: 0.4996 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 25/50
 - 78s - loss: 0.2521 - calc_accuracy: 0.5034 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 26/50
 - 78s - loss: 0.2527 - calc_accuracy: 0.4984 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 27/50
 - 78s - loss: 0.2519 - calc_accuracy: 0.4988 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 28/50
 - 78s - loss: 0.2509 - calc_accuracy: 0.5020 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 29/50
 - 78s - loss: 0.2516 - calc_accuracy: 0.4912 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 30/50
 - 78s - loss: 0.2518 - calc_accuracy: 0.4938 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 31/50
 - 78s - loss: 0.2513 - calc_accuracy: 0.5064 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 32/50
 - 78s - loss: 0.2516 - calc_accuracy: 0.4978 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 33/50
 - 78s - loss: 0.2520 - calc_accuracy: 0.4972 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 34/50
 - 78s - loss: 0.2525 - calc_accuracy: 0.4932 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 35/50
 - 78s - loss: 0.2525 - calc_accuracy: 0.4956 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 36/50
 - 78s - loss: 0.2524 - calc_accuracy: 0.4906 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 37/50
 - 78s - loss: 0.2514 - calc_accuracy: 0.5000 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 38/50
 - 78s - loss: 0.2527 - calc_accuracy: 0.4962 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 39/50
 - 78s - loss: 0.2522 - calc_accuracy: 0.4932 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 40/50
 - 79s - loss: 0.2517 - calc_accuracy: 0.5002 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 41/50
 - 79s - loss: 0.2515 - calc_accuracy: 0.5002 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 42/50
 - 79s - loss: 0.2512 - calc_accuracy: 0.4988 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 43/50
 - 79s - loss: 0.2522 - calc_accuracy: 0.4914 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 44/50
 - 79s - loss: 0.2514 - calc_accuracy: 0.5054 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 45/50
 - 78s - loss: 0.2515 - calc_accuracy: 0.5070 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 46/50
 - 78s - loss: 0.2508 - calc_accuracy: 0.5076 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 47/50
 - 78s - loss: 0.2516 - calc_accuracy: 0.5012 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 48/50
 - 78s - loss: 0.2524 - calc_accuracy: 0.4885 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 49/50
 - 78s - loss: 0.2506 - calc_accuracy: 0.5119 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 50/50
 - 79s - loss: 0.2509 - calc_accuracy: 0.5111 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Test accuracy: 0.5
Train on 5024 samples, validate on 1264 samples
Epoch 1/50
 - 60s - loss: 0.2709 - calc_accuracy: 0.5531 - val_loss: 0.2351 - val_calc_accuracy: 0.6290
Epoch 2/50
 - 58s - loss: 0.2093 - calc_accuracy: 0.6628 - val_loss: 0.2067 - val_calc_accuracy: 0.6835
Epoch 3/50
 - 58s - loss: 0.2129 - calc_accuracy: 0.6720 - val_loss: 0.2054 - val_calc_accuracy: 0.6748
Epoch 4/50
 - 58s - loss: 0.2135 - calc_accuracy: 0.6750 - val_loss: 0.1718 - val_calc_accuracy: 0.7302
Epoch 5/50
 - 58s - loss: 0.1825 - calc_accuracy: 0.7311 - val_loss: 0.1700 - val_calc_accuracy: 0.7342
Epoch 6/50
 - 58s - loss: 0.1774 - calc_accuracy: 0.7377 - val_loss: 0.2012 - val_calc_accuracy: 0.7025
Epoch 7/50
 - 57s - loss: 0.1859 - calc_accuracy: 0.7189 - val_loss: 0.1546 - val_calc_accuracy: 0.7745
Epoch 8/50
 - 58s - loss: 0.1644 - calc_accuracy: 0.7689 - val_loss: 0.2481 - val_calc_accuracy: 0.5585
Epoch 9/50
 - 58s - loss: 0.1719 - calc_accuracy: 0.7558 - val_loss: 0.1843 - val_calc_accuracy: 0.7215
Epoch 10/50
 - 58s - loss: 0.1611 - calc_accuracy: 0.7715 - val_loss: 0.1628 - val_calc_accuracy: 0.7611
Epoch 11/50
 - 58s - loss: 0.1594 - calc_accuracy: 0.7753 - val_loss: 0.1452 - val_calc_accuracy: 0.7959
Epoch 12/50
 - 58s - loss: 0.1478 - calc_accuracy: 0.7968 - val_loss: 0.1599 - val_calc_accuracy: 0.7619
Epoch 13/50
 - 58s - loss: 0.1496 - calc_accuracy: 0.7940 - val_loss: 0.1395 - val_calc_accuracy: 0.8180
Epoch 14/50
 - 58s - loss: 0.1421 - calc_accuracy: 0.8093 - val_loss: 0.2214 - val_calc_accuracy: 0.6472
Epoch 15/50
 - 58s - loss: 0.1479 - calc_accuracy: 0.8029 - val_loss: 0.1386 - val_calc_accuracy: 0.8220
Epoch 16/50
 - 58s - loss: 0.1407 - calc_accuracy: 0.8097 - val_loss: 0.1452 - val_calc_accuracy: 0.8133
Epoch 17/50
 - 58s - loss: 0.1245 - calc_accuracy: 0.8372 - val_loss: 0.1512 - val_calc_accuracy: 0.7801
Epoch 18/50
 - 58s - loss: 0.1276 - calc_accuracy: 0.8320 - val_loss: 0.1483 - val_calc_accuracy: 0.7927
Epoch 19/50
 - 57s - loss: 0.1193 - calc_accuracy: 0.8469 - val_loss: 0.1519 - val_calc_accuracy: 0.7801
Epoch 20/50
 - 58s - loss: 0.1113 - calc_accuracy: 0.8585 - val_loss: 0.1270 - val_calc_accuracy: 0.8291
Epoch 21/50
 - 57s - loss: 0.1192 - calc_accuracy: 0.8503 - val_loss: 0.1237 - val_calc_accuracy: 0.8362
Epoch 22/50
 - 57s - loss: 0.1072 - calc_accuracy: 0.8730 - val_loss: 0.1149 - val_calc_accuracy: 0.8434
Epoch 23/50
 - 57s - loss: 0.1060 - calc_accuracy: 0.8712 - val_loss: 0.1223 - val_calc_accuracy: 0.8291
Epoch 24/50
 - 57s - loss: 0.0929 - calc_accuracy: 0.8955 - val_loss: 0.1091 - val_calc_accuracy: 0.8710
Epoch 25/50
 - 58s - loss: 0.0947 - calc_accuracy: 0.8895 - val_loss: 0.1104 - val_calc_accuracy: 0.8710
Epoch 26/50
 - 58s - loss: 0.0914 - calc_accuracy: 0.8993 - val_loss: 0.1028 - val_calc_accuracy: 0.8797
Epoch 27/50
 - 58s - loss: 0.1139 - calc_accuracy: 0.8553 - val_loss: 0.1702 - val_calc_accuracy: 0.7492
Epoch 28/50
 - 58s - loss: 0.0903 - calc_accuracy: 0.8985 - val_loss: 0.1096 - val_calc_accuracy: 0.8560
Epoch 29/50
 - 58s - loss: 0.0768 - calc_accuracy: 0.9216 - val_loss: 0.1143 - val_calc_accuracy: 0.8592
Epoch 30/50
 - 58s - loss: 0.0973 - calc_accuracy: 0.8826 - val_loss: 0.1034 - val_calc_accuracy: 0.8797
Epoch 31/50
 - 58s - loss: 0.0745 - calc_accuracy: 0.9244 - val_loss: 0.1016 - val_calc_accuracy: 0.8821
Epoch 32/50
 - 58s - loss: 0.0716 - calc_accuracy: 0.9281 - val_loss: 0.1133 - val_calc_accuracy: 0.8528
Epoch 33/50
 - 57s - loss: 0.0752 - calc_accuracy: 0.9192 - val_loss: 0.1109 - val_calc_accuracy: 0.8608
Epoch 34/50
 - 57s - loss: 0.0700 - calc_accuracy: 0.9283 - val_loss: 0.1032 - val_calc_accuracy: 0.8655
Epoch 35/50
 - 57s - loss: 0.0708 - calc_accuracy: 0.9293 - val_loss: 0.0987 - val_calc_accuracy: 0.8829
Epoch 36/50
 - 57s - loss: 0.0703 - calc_accuracy: 0.9291 - val_loss: 0.0969 - val_calc_accuracy: 0.8924
Epoch 37/50
 - 57s - loss: 0.0693 - calc_accuracy: 0.9293 - val_loss: 0.1181 - val_calc_accuracy: 0.8544
Epoch 38/50
 - 57s - loss: 0.0661 - calc_accuracy: 0.9375 - val_loss: 0.1183 - val_calc_accuracy: 0.8505
Epoch 39/50
 - 57s - loss: 0.0670 - calc_accuracy: 0.9327 - val_loss: 0.1470 - val_calc_accuracy: 0.7785
Epoch 40/50
 - 57s - loss: 0.0730 - calc_accuracy: 0.9232 - val_loss: 0.1135 - val_calc_accuracy: 0.8481
Epoch 41/50
 - 57s - loss: 0.0613 - calc_accuracy: 0.9419 - val_loss: 0.0972 - val_calc_accuracy: 0.8782
Epoch 42/50
 - 57s - loss: 0.0690 - calc_accuracy: 0.9279 - val_loss: 0.1119 - val_calc_accuracy: 0.8584
Epoch 43/50
 - 57s - loss: 0.0590 - calc_accuracy: 0.9463 - val_loss: 0.1426 - val_calc_accuracy: 0.8101
Epoch 44/50
 - 57s - loss: 0.0586 - calc_accuracy: 0.9401 - val_loss: 0.0989 - val_calc_accuracy: 0.8758
Epoch 45/50
 - 57s - loss: 0.0611 - calc_accuracy: 0.9381 - val_loss: 0.1048 - val_calc_accuracy: 0.8687
Epoch 46/50
 - 57s - loss: 0.0566 - calc_accuracy: 0.9459 - val_loss: 0.1058 - val_calc_accuracy: 0.8703
Epoch 47/50
 - 57s - loss: 0.0566 - calc_accuracy: 0.9502 - val_loss: 0.1471 - val_calc_accuracy: 0.8006
Epoch 48/50
 - 57s - loss: 0.0573 - calc_accuracy: 0.9447 - val_loss: 0.1015 - val_calc_accuracy: 0.8774
Epoch 49/50
 - 57s - loss: 0.0845 - calc_accuracy: 0.8919 - val_loss: 0.0906 - val_calc_accuracy: 0.8979
Epoch 50/50
 - 57s - loss: 0.0535 - calc_accuracy: 0.9550 - val_loss: 0.1200 - val_calc_accuracy: 0.8354
Test accuracy: 0.8354430379746836
Train on 5024 samples, validate on 1264 samples
Epoch 1/50
 - 8s - loss: 0.3161 - calc_accuracy: 0.5117 - val_loss: 0.4632 - val_calc_accuracy: 0.5000
Epoch 2/50
 - 8s - loss: 0.2564 - calc_accuracy: 0.4980 - val_loss: 0.4466 - val_calc_accuracy: 0.5000
Epoch 3/50
 - 8s - loss: 0.2711 - calc_accuracy: 0.4924 - val_loss: 0.4328 - val_calc_accuracy: 0.5000
Epoch 4/50
 - 8s - loss: 0.2563 - calc_accuracy: 0.4994 - val_loss: 0.4442 - val_calc_accuracy: 0.5000
Epoch 5/50
 - 8s - loss: 0.2551 - calc_accuracy: 0.5141 - val_loss: 0.4284 - val_calc_accuracy: 0.5000
Epoch 6/50
 - 8s - loss: 0.2593 - calc_accuracy: 0.4988 - val_loss: 0.4231 - val_calc_accuracy: 0.5000
Epoch 7/50
 - 8s - loss: 0.2535 - calc_accuracy: 0.5123 - val_loss: 0.4038 - val_calc_accuracy: 0.5000
Epoch 8/50
 - 8s - loss: 0.2563 - calc_accuracy: 0.5048 - val_loss: 0.3849 - val_calc_accuracy: 0.5000
Epoch 9/50
 - 8s - loss: 0.2535 - calc_accuracy: 0.5133 - val_loss: 0.3723 - val_calc_accuracy: 0.5000
Epoch 10/50
 - 8s - loss: 0.2456 - calc_accuracy: 0.5512 - val_loss: 0.3067 - val_calc_accuracy: 0.5174
Epoch 11/50
 - 8s - loss: 0.2382 - calc_accuracy: 0.5800 - val_loss: 0.2956 - val_calc_accuracy: 0.5356
Epoch 12/50
 - 8s - loss: 0.2302 - calc_accuracy: 0.6095 - val_loss: 0.2179 - val_calc_accuracy: 0.6432
Epoch 13/50
 - 8s - loss: 0.2166 - calc_accuracy: 0.6483 - val_loss: 0.1934 - val_calc_accuracy: 0.6970
Epoch 14/50
 - 8s - loss: 0.2067 - calc_accuracy: 0.6700 - val_loss: 0.1855 - val_calc_accuracy: 0.7184
Epoch 15/50
 - 8s - loss: 0.1934 - calc_accuracy: 0.7146 - val_loss: 0.1768 - val_calc_accuracy: 0.7397
Epoch 16/50
 - 7s - loss: 0.1876 - calc_accuracy: 0.7287 - val_loss: 0.1902 - val_calc_accuracy: 0.7136
Epoch 17/50
 - 7s - loss: 0.1823 - calc_accuracy: 0.7337 - val_loss: 0.1750 - val_calc_accuracy: 0.7484
Epoch 18/50
 - 8s - loss: 0.1791 - calc_accuracy: 0.7422 - val_loss: 0.1564 - val_calc_accuracy: 0.7832
Epoch 19/50
 - 8s - loss: 0.1728 - calc_accuracy: 0.7564 - val_loss: 0.1828 - val_calc_accuracy: 0.7310
Epoch 20/50
 - 7s - loss: 0.1720 - calc_accuracy: 0.7566 - val_loss: 0.1534 - val_calc_accuracy: 0.7840
Epoch 21/50
 - 7s - loss: 0.1647 - calc_accuracy: 0.7759 - val_loss: 0.1582 - val_calc_accuracy: 0.7793
Epoch 22/50
 - 7s - loss: 0.1651 - calc_accuracy: 0.7711 - val_loss: 0.1490 - val_calc_accuracy: 0.7927
Epoch 23/50
 - 7s - loss: 0.1624 - calc_accuracy: 0.7814 - val_loss: 0.1412 - val_calc_accuracy: 0.7951
Epoch 24/50
 - 8s - loss: 0.1627 - calc_accuracy: 0.7747 - val_loss: 0.1415 - val_calc_accuracy: 0.8093
Epoch 25/50
 - 7s - loss: 0.1575 - calc_accuracy: 0.7848 - val_loss: 0.1388 - val_calc_accuracy: 0.8093
Epoch 26/50
 - 7s - loss: 0.1559 - calc_accuracy: 0.7894 - val_loss: 0.1518 - val_calc_accuracy: 0.7880
Epoch 27/50
 - 7s - loss: 0.1550 - calc_accuracy: 0.7924 - val_loss: 0.1318 - val_calc_accuracy: 0.8228
Epoch 28/50
 - 7s - loss: 0.1522 - calc_accuracy: 0.7932 - val_loss: 0.1577 - val_calc_accuracy: 0.7856
Epoch 29/50
 - 7s - loss: 0.1490 - calc_accuracy: 0.8047 - val_loss: 0.1457 - val_calc_accuracy: 0.8022
Epoch 30/50
 - 7s - loss: 0.1474 - calc_accuracy: 0.8055 - val_loss: 0.1288 - val_calc_accuracy: 0.8180
Epoch 31/50
 - 7s - loss: 0.1464 - calc_accuracy: 0.8063 - val_loss: 0.1481 - val_calc_accuracy: 0.7959
Epoch 32/50
 - 7s - loss: 0.1449 - calc_accuracy: 0.8103 - val_loss: 0.1251 - val_calc_accuracy: 0.8157
Epoch 33/50
 - 7s - loss: 0.1448 - calc_accuracy: 0.8087 - val_loss: 0.1306 - val_calc_accuracy: 0.8212
Epoch 34/50
 - 8s - loss: 0.1414 - calc_accuracy: 0.8185 - val_loss: 0.1258 - val_calc_accuracy: 0.8267
Epoch 35/50
 - 7s - loss: 0.1379 - calc_accuracy: 0.8236 - val_loss: 0.1462 - val_calc_accuracy: 0.7991
Epoch 36/50
 - 8s - loss: 0.1394 - calc_accuracy: 0.8197 - val_loss: 0.1399 - val_calc_accuracy: 0.8070
Epoch 37/50
 - 8s - loss: 0.1363 - calc_accuracy: 0.8286 - val_loss: 0.1388 - val_calc_accuracy: 0.8070
Epoch 38/50
 - 7s - loss: 0.1326 - calc_accuracy: 0.8324 - val_loss: 0.1417 - val_calc_accuracy: 0.8085
Epoch 39/50
 - 7s - loss: 0.1343 - calc_accuracy: 0.8318 - val_loss: 0.1233 - val_calc_accuracy: 0.8362
Epoch 40/50
 - 7s - loss: 0.1332 - calc_accuracy: 0.8350 - val_loss: 0.1214 - val_calc_accuracy: 0.8323
Epoch 41/50
 - 7s - loss: 0.1321 - calc_accuracy: 0.8354 - val_loss: 0.1586 - val_calc_accuracy: 0.7698
Epoch 42/50
 - 7s - loss: 0.1296 - calc_accuracy: 0.8372 - val_loss: 0.1116 - val_calc_accuracy: 0.8584
Epoch 43/50
 - 7s - loss: 0.1299 - calc_accuracy: 0.8465 - val_loss: 0.1196 - val_calc_accuracy: 0.8481
Epoch 44/50
 - 7s - loss: 0.1280 - calc_accuracy: 0.8434 - val_loss: 0.1224 - val_calc_accuracy: 0.8370
Epoch 45/50
 - 7s - loss: 0.1276 - calc_accuracy: 0.8418 - val_loss: 0.1284 - val_calc_accuracy: 0.8331
Epoch 46/50
 - 7s - loss: 0.1262 - calc_accuracy: 0.8469 - val_loss: 0.1186 - val_calc_accuracy: 0.8386
Epoch 47/50
 - 7s - loss: 0.1256 - calc_accuracy: 0.8547 - val_loss: 0.1053 - val_calc_accuracy: 0.8774
Epoch 48/50
 - 7s - loss: 0.1227 - calc_accuracy: 0.8469 - val_loss: 0.1154 - val_calc_accuracy: 0.8584
Epoch 49/50
 - 8s - loss: 0.1217 - calc_accuracy: 0.8573 - val_loss: 0.1268 - val_calc_accuracy: 0.8331
Epoch 50/50
 - 7s - loss: 0.1193 - calc_accuracy: 0.8607 - val_loss: 0.1288 - val_calc_accuracy: 0.8244
Test accuracy: 0.8243670886075949
Train on 5024 samples, validate on 1264 samples
Epoch 1/50
 - 117s - loss: 0.3733 - calc_accuracy: 0.5056 - val_loss: 0.4533 - val_calc_accuracy: 0.5000
Epoch 2/50
 - 107s - loss: 0.2844 - calc_accuracy: 0.5070 - val_loss: 0.4363 - val_calc_accuracy: 0.5000
Epoch 3/50
 - 107s - loss: 0.2820 - calc_accuracy: 0.5064 - val_loss: 0.4323 - val_calc_accuracy: 0.5000
Epoch 4/50
 - 107s - loss: 0.2657 - calc_accuracy: 0.5068 - val_loss: 0.4334 - val_calc_accuracy: 0.5000
Epoch 5/50
 - 107s - loss: 0.2636 - calc_accuracy: 0.4922 - val_loss: 0.4407 - val_calc_accuracy: 0.5000
Epoch 6/50
 - 108s - loss: 0.2588 - calc_accuracy: 0.5121 - val_loss: 0.4629 - val_calc_accuracy: 0.5000
Epoch 7/50
 - 107s - loss: 0.2659 - calc_accuracy: 0.5042 - val_loss: 0.4754 - val_calc_accuracy: 0.5000
Epoch 8/50
 - 107s - loss: 0.2600 - calc_accuracy: 0.4980 - val_loss: 0.4961 - val_calc_accuracy: 0.5000
Epoch 9/50
 - 106s - loss: 0.2599 - calc_accuracy: 0.4944 - val_loss: 0.4910 - val_calc_accuracy: 0.5000
Epoch 10/50
 - 107s - loss: 0.2579 - calc_accuracy: 0.5119 - val_loss: 0.4973 - val_calc_accuracy: 0.5000
Epoch 11/50
 - 107s - loss: 0.2580 - calc_accuracy: 0.5036 - val_loss: 0.4987 - val_calc_accuracy: 0.5000
Epoch 12/50
 - 108s - loss: 0.2573 - calc_accuracy: 0.5056 - val_loss: 0.4985 - val_calc_accuracy: 0.5000
Epoch 13/50
 - 107s - loss: 0.2608 - calc_accuracy: 0.4924 - val_loss: 0.4655 - val_calc_accuracy: 0.5000
Epoch 14/50
 - 107s - loss: 0.2584 - calc_accuracy: 0.4948 - val_loss: 0.4983 - val_calc_accuracy: 0.5000
Epoch 15/50
 - 107s - loss: 0.2570 - calc_accuracy: 0.4950 - val_loss: 0.4976 - val_calc_accuracy: 0.5000
Epoch 16/50
 - 107s - loss: 0.2565 - calc_accuracy: 0.4992 - val_loss: 0.4998 - val_calc_accuracy: 0.5000
Epoch 17/50
 - 107s - loss: 0.2574 - calc_accuracy: 0.4938 - val_loss: 0.4999 - val_calc_accuracy: 0.5000
Epoch 18/50
 - 107s - loss: 0.2564 - calc_accuracy: 0.5050 - val_loss: 0.4999 - val_calc_accuracy: 0.5000
Epoch 19/50
 - 107s - loss: 0.2575 - calc_accuracy: 0.5006 - val_loss: 0.4998 - val_calc_accuracy: 0.5000
Epoch 20/50
 - 107s - loss: 0.2583 - calc_accuracy: 0.4902 - val_loss: 0.4998 - val_calc_accuracy: 0.5000
Epoch 21/50
 - 107s - loss: 0.2568 - calc_accuracy: 0.5018 - val_loss: 0.4998 - val_calc_accuracy: 0.5000
Epoch 22/50
 - 106s - loss: 0.2567 - calc_accuracy: 0.4972 - val_loss: 0.4999 - val_calc_accuracy: 0.5000
Epoch 23/50
 - 106s - loss: 0.2577 - calc_accuracy: 0.4956 - val_loss: 0.4999 - val_calc_accuracy: 0.5000
Epoch 24/50
 - 106s - loss: 0.2560 - calc_accuracy: 0.5040 - val_loss: 0.4999 - val_calc_accuracy: 0.5000
Epoch 25/50
 - 106s - loss: 0.2559 - calc_accuracy: 0.5090 - val_loss: 0.4999 - val_calc_accuracy: 0.5000
Epoch 26/50
 - 107s - loss: 0.2559 - calc_accuracy: 0.5066 - val_loss: 0.4995 - val_calc_accuracy: 0.5000
Epoch 27/50
 - 106s - loss: 0.2584 - calc_accuracy: 0.4930 - val_loss: 0.4998 - val_calc_accuracy: 0.5000
Epoch 28/50
 - 106s - loss: 0.2581 - calc_accuracy: 0.4938 - val_loss: 0.4997 - val_calc_accuracy: 0.5000
Epoch 29/50
 - 106s - loss: 0.2583 - calc_accuracy: 0.4847 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 30/50
 - 107s - loss: 0.2574 - calc_accuracy: 0.4885 - val_loss: 0.4998 - val_calc_accuracy: 0.5000
Epoch 31/50
 - 106s - loss: 0.2580 - calc_accuracy: 0.4902 - val_loss: 0.4998 - val_calc_accuracy: 0.5000
Epoch 32/50
 - 106s - loss: 0.2584 - calc_accuracy: 0.4972 - val_loss: 0.4995 - val_calc_accuracy: 0.5000
Epoch 33/50
 - 106s - loss: 0.2559 - calc_accuracy: 0.4976 - val_loss: 0.4998 - val_calc_accuracy: 0.5000
Epoch 34/50
 - 106s - loss: 0.2554 - calc_accuracy: 0.5008 - val_loss: 0.4999 - val_calc_accuracy: 0.5000
Epoch 35/50
 - 106s - loss: 0.2561 - calc_accuracy: 0.4887 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 36/50
 - 107s - loss: 0.2559 - calc_accuracy: 0.5012 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 37/50
 - 106s - loss: 0.2567 - calc_accuracy: 0.5014 - val_loss: 0.4999 - val_calc_accuracy: 0.5000
Epoch 38/50
 - 107s - loss: 0.2542 - calc_accuracy: 0.4966 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 39/50
 - 107s - loss: 0.2549 - calc_accuracy: 0.5014 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 40/50
 - 107s - loss: 0.2569 - calc_accuracy: 0.4863 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 41/50
 - 107s - loss: 0.2550 - calc_accuracy: 0.5086 - val_loss: 0.4999 - val_calc_accuracy: 0.5000
Epoch 42/50
 - 107s - loss: 0.2571 - calc_accuracy: 0.4898 - val_loss: 0.5000 - val_calc_accuracy: 0.5000
Epoch 43/50
 - 107s - loss: 0.2542 - calc_accuracy: 0.5070 - val_loss: 0.4999 - val_calc_accuracy: 0.5000
Epoch 44/50
 - 106s - loss: 0.2564 - calc_accuracy: 0.5026 - val_loss: 0.4999 - val_calc_accuracy: 0.5000
Epoch 45/50
 - 107s - loss: 0.2538 - calc_accuracy: 0.5139 - val_loss: 0.4999 - val_calc_accuracy: 0.5000
Epoch 46/50
 - 108s - loss: 0.2559 - calc_accuracy: 0.5060 - val_loss: 0.4999 - val_calc_accuracy: 0.5000
Epoch 47/50
 - 107s - loss: 0.2545 - calc_accuracy: 0.5036 - val_loss: 0.4999 - val_calc_accuracy: 0.5000
Epoch 48/50
 - 107s - loss: 0.2573 - calc_accuracy: 0.4930 - val_loss: 0.4999 - val_calc_accuracy: 0.5000
Epoch 49/50
 - 107s - loss: 0.2552 - calc_accuracy: 0.5086 - val_loss: 0.4999 - val_calc_accuracy: 0.5000
Epoch 50/50
 - 106s - loss: 0.2556 - calc_accuracy: 0.4986 - val_loss: 0.4999 - val_calc_accuracy: 0.5000
Test accuracy: 0.5
Train on 5024 samples, validate on 1264 samples
Epoch 1/50
 - 22s - loss: 0.5448 - calc_accuracy: 0.4966 - val_loss: 0.4859 - val_calc_accuracy: 0.5000
Epoch 2/50
 - 20s - loss: 0.2799 - calc_accuracy: 0.5044 - val_loss: 0.4675 - val_calc_accuracy: 0.5000
Epoch 3/50
 - 20s - loss: 0.2762 - calc_accuracy: 0.5012 - val_loss: 0.4508 - val_calc_accuracy: 0.5000
Epoch 4/50
 - 20s - loss: 0.2772 - calc_accuracy: 0.4964 - val_loss: 0.4581 - val_calc_accuracy: 0.5000
Epoch 5/50
 - 20s - loss: 0.2816 - calc_accuracy: 0.5018 - val_loss: 0.4505 - val_calc_accuracy: 0.5000
Epoch 6/50
 - 20s - loss: 0.2699 - calc_accuracy: 0.4920 - val_loss: 0.4514 - val_calc_accuracy: 0.5000
Epoch 7/50
 - 20s - loss: 0.2783 - calc_accuracy: 0.4825 - val_loss: 0.4604 - val_calc_accuracy: 0.5000
Epoch 8/50
 - 20s - loss: 0.2671 - calc_accuracy: 0.5048 - val_loss: 0.4508 - val_calc_accuracy: 0.5000
Epoch 9/50
 - 20s - loss: 0.2650 - calc_accuracy: 0.5008 - val_loss: 0.4627 - val_calc_accuracy: 0.5000
Epoch 10/50
 - 20s - loss: 0.2643 - calc_accuracy: 0.5131 - val_loss: 0.4215 - val_calc_accuracy: 0.5000
Epoch 11/50
 - 20s - loss: 0.2663 - calc_accuracy: 0.5038 - val_loss: 0.4206 - val_calc_accuracy: 0.5000
Epoch 12/50
 - 20s - loss: 0.2579 - calc_accuracy: 0.5348 - val_loss: 0.3228 - val_calc_accuracy: 0.5103
Epoch 13/50
 - 20s - loss: 0.2513 - calc_accuracy: 0.5756 - val_loss: 0.2277 - val_calc_accuracy: 0.6543
Epoch 14/50
 - 20s - loss: 0.2044 - calc_accuracy: 0.6791 - val_loss: 0.1649 - val_calc_accuracy: 0.7587
Epoch 15/50
 - 20s - loss: 0.1687 - calc_accuracy: 0.7534 - val_loss: 0.1765 - val_calc_accuracy: 0.7381
Epoch 16/50
 - 20s - loss: 0.1459 - calc_accuracy: 0.7982 - val_loss: 0.1276 - val_calc_accuracy: 0.8275
Epoch 17/50
 - 20s - loss: 0.1339 - calc_accuracy: 0.8258 - val_loss: 0.1271 - val_calc_accuracy: 0.8323
Epoch 18/50
 - 20s - loss: 0.1328 - calc_accuracy: 0.8256 - val_loss: 0.1429 - val_calc_accuracy: 0.7967
Epoch 19/50
 - 20s - loss: 0.1212 - calc_accuracy: 0.8489 - val_loss: 0.1088 - val_calc_accuracy: 0.8631
Epoch 20/50
 - 20s - loss: 0.1069 - calc_accuracy: 0.8718 - val_loss: 0.1381 - val_calc_accuracy: 0.8220
Epoch 21/50
 - 20s - loss: 0.1062 - calc_accuracy: 0.8662 - val_loss: 0.1117 - val_calc_accuracy: 0.8560
Epoch 22/50
 - 20s - loss: 0.1024 - calc_accuracy: 0.8818 - val_loss: 0.1250 - val_calc_accuracy: 0.8370
Epoch 23/50
 - 20s - loss: 0.0943 - calc_accuracy: 0.8983 - val_loss: 0.1193 - val_calc_accuracy: 0.8434
Epoch 24/50
 - 20s - loss: 0.0877 - calc_accuracy: 0.9039 - val_loss: 0.0927 - val_calc_accuracy: 0.8892
Epoch 25/50
 - 20s - loss: 0.0807 - calc_accuracy: 0.9152 - val_loss: 0.1224 - val_calc_accuracy: 0.8259
Epoch 26/50
 - 20s - loss: 0.0781 - calc_accuracy: 0.9188 - val_loss: 0.0806 - val_calc_accuracy: 0.8979
Epoch 27/50
 - 20s - loss: 0.0722 - calc_accuracy: 0.9293 - val_loss: 0.1593 - val_calc_accuracy: 0.8062
Epoch 28/50
 - 20s - loss: 0.0718 - calc_accuracy: 0.9271 - val_loss: 0.0805 - val_calc_accuracy: 0.8979
Epoch 29/50
 - 20s - loss: 0.0618 - calc_accuracy: 0.9486 - val_loss: 0.1160 - val_calc_accuracy: 0.8505
Epoch 30/50
 - 20s - loss: 0.0647 - calc_accuracy: 0.9401 - val_loss: 0.0641 - val_calc_accuracy: 0.9375
Epoch 31/50
 - 20s - loss: 0.0587 - calc_accuracy: 0.9532 - val_loss: 0.0752 - val_calc_accuracy: 0.9090
Epoch 32/50
 - 20s - loss: 0.0588 - calc_accuracy: 0.9530 - val_loss: 0.0642 - val_calc_accuracy: 0.9304
Epoch 33/50
 - 20s - loss: 0.0555 - calc_accuracy: 0.9576 - val_loss: 0.0696 - val_calc_accuracy: 0.9328
Epoch 34/50
 - 19s - loss: 0.0546 - calc_accuracy: 0.9618 - val_loss: 0.0856 - val_calc_accuracy: 0.8956
Epoch 35/50
 - 20s - loss: 0.0512 - calc_accuracy: 0.9638 - val_loss: 0.0618 - val_calc_accuracy: 0.9415
Epoch 36/50
 - 20s - loss: 0.0523 - calc_accuracy: 0.9634 - val_loss: 0.0763 - val_calc_accuracy: 0.9280
Epoch 37/50
 - 20s - loss: 0.0476 - calc_accuracy: 0.9658 - val_loss: 0.0574 - val_calc_accuracy: 0.9415
Epoch 38/50
 - 20s - loss: 0.0428 - calc_accuracy: 0.9739 - val_loss: 0.0719 - val_calc_accuracy: 0.9248
Epoch 39/50
 - 20s - loss: 0.0517 - calc_accuracy: 0.9620 - val_loss: 0.0529 - val_calc_accuracy: 0.9470
Epoch 40/50
 - 20s - loss: 0.0413 - calc_accuracy: 0.9765 - val_loss: 0.0740 - val_calc_accuracy: 0.9248
Epoch 41/50
 - 20s - loss: 0.0431 - calc_accuracy: 0.9747 - val_loss: 0.0724 - val_calc_accuracy: 0.9312
Epoch 42/50
 - 20s - loss: 0.0406 - calc_accuracy: 0.9793 - val_loss: 0.0491 - val_calc_accuracy: 0.9486
Epoch 43/50
 - 19s - loss: 0.0499 - calc_accuracy: 0.9650 - val_loss: 0.0788 - val_calc_accuracy: 0.8995
Epoch 44/50
 - 19s - loss: 0.0371 - calc_accuracy: 0.9843 - val_loss: 0.0522 - val_calc_accuracy: 0.9486
Epoch 45/50
 - 20s - loss: 0.0357 - calc_accuracy: 0.9873 - val_loss: 0.0589 - val_calc_accuracy: 0.9446
Epoch 46/50
 - 20s - loss: 0.0368 - calc_accuracy: 0.9821 - val_loss: 0.1069 - val_calc_accuracy: 0.8631
Epoch 47/50
 - 20s - loss: 0.0615 - calc_accuracy: 0.9484 - val_loss: 0.0542 - val_calc_accuracy: 0.9454
Epoch 48/50
 - 20s - loss: 0.0306 - calc_accuracy: 0.9904 - val_loss: 0.0488 - val_calc_accuracy: 0.9557
Epoch 49/50
 - 20s - loss: 0.0322 - calc_accuracy: 0.9896 - val_loss: 0.0469 - val_calc_accuracy: 0.9589
Epoch 50/50
 - 20s - loss: 0.0308 - calc_accuracy: 0.9904 - val_loss: 0.0486 - val_calc_accuracy: 0.9589
Test accuracy: 0.9588607594936709
Train on 5024 samples, validate on 1264 samples
Epoch 1/50
 - 20s - loss: 0.3245 - calc_accuracy: 0.4879 - val_loss: 0.4372 - val_calc_accuracy: 0.5000
Epoch 2/50
 - 19s - loss: 0.2734 - calc_accuracy: 0.4960 - val_loss: 0.4417 - val_calc_accuracy: 0.5000
Epoch 3/50
 - 19s - loss: 0.2762 - calc_accuracy: 0.5014 - val_loss: 0.4540 - val_calc_accuracy: 0.5000
Epoch 4/50
 - 19s - loss: 0.2800 - calc_accuracy: 0.4940 - val_loss: 0.4229 - val_calc_accuracy: 0.5000
Epoch 5/50
 - 19s - loss: 0.2715 - calc_accuracy: 0.5050 - val_loss: 0.4495 - val_calc_accuracy: 0.5000
Epoch 6/50
 - 19s - loss: 0.2720 - calc_accuracy: 0.5107 - val_loss: 0.4432 - val_calc_accuracy: 0.5000
Epoch 7/50
 - 19s - loss: 0.2671 - calc_accuracy: 0.5064 - val_loss: 0.3960 - val_calc_accuracy: 0.5000
Epoch 8/50
 - 19s - loss: 0.2640 - calc_accuracy: 0.5247 - val_loss: 0.3326 - val_calc_accuracy: 0.5055
Epoch 9/50
 - 19s - loss: 0.2712 - calc_accuracy: 0.5092 - val_loss: 0.4525 - val_calc_accuracy: 0.5000
Epoch 10/50
 - 19s - loss: 0.2617 - calc_accuracy: 0.5424 - val_loss: 0.3801 - val_calc_accuracy: 0.5000
Epoch 11/50
 - 19s - loss: 0.2418 - calc_accuracy: 0.5928 - val_loss: 0.3078 - val_calc_accuracy: 0.5134
Epoch 12/50
 - 19s - loss: 0.2285 - calc_accuracy: 0.6262 - val_loss: 0.2536 - val_calc_accuracy: 0.5815
Epoch 13/50
 - 19s - loss: 0.1919 - calc_accuracy: 0.7042 - val_loss: 0.1644 - val_calc_accuracy: 0.7642
Epoch 14/50
 - 19s - loss: 0.1697 - calc_accuracy: 0.7548 - val_loss: 0.1580 - val_calc_accuracy: 0.7595
Epoch 15/50
 - 19s - loss: 0.1525 - calc_accuracy: 0.7868 - val_loss: 0.1356 - val_calc_accuracy: 0.8172
Epoch 16/50
 - 19s - loss: 0.1415 - calc_accuracy: 0.8115 - val_loss: 0.1600 - val_calc_accuracy: 0.7777
Epoch 17/50
 - 19s - loss: 0.1372 - calc_accuracy: 0.8211 - val_loss: 0.1240 - val_calc_accuracy: 0.8426
Epoch 18/50
 - 19s - loss: 0.1222 - calc_accuracy: 0.8511 - val_loss: 0.1216 - val_calc_accuracy: 0.8323
Epoch 19/50
 - 19s - loss: 0.1216 - calc_accuracy: 0.8467 - val_loss: 0.1137 - val_calc_accuracy: 0.8608
Epoch 20/50
 - 19s - loss: 0.1141 - calc_accuracy: 0.8619 - val_loss: 0.1180 - val_calc_accuracy: 0.8489
Epoch 21/50
 - 19s - loss: 0.1058 - calc_accuracy: 0.8806 - val_loss: 0.0983 - val_calc_accuracy: 0.8813
Epoch 22/50
 - 19s - loss: 0.1017 - calc_accuracy: 0.8848 - val_loss: 0.1135 - val_calc_accuracy: 0.8505
Epoch 23/50
 - 19s - loss: 0.0956 - calc_accuracy: 0.8971 - val_loss: 0.0943 - val_calc_accuracy: 0.8979
Epoch 24/50
 - 19s - loss: 0.0893 - calc_accuracy: 0.9053 - val_loss: 0.0816 - val_calc_accuracy: 0.9201
Epoch 25/50
 - 19s - loss: 0.0851 - calc_accuracy: 0.9164 - val_loss: 0.0738 - val_calc_accuracy: 0.9241
Epoch 26/50
 - 19s - loss: 0.0785 - calc_accuracy: 0.9224 - val_loss: 0.0821 - val_calc_accuracy: 0.9114
Epoch 27/50
 - 19s - loss: 0.0735 - calc_accuracy: 0.9319 - val_loss: 0.0735 - val_calc_accuracy: 0.9177
Epoch 28/50
 - 19s - loss: 0.0697 - calc_accuracy: 0.9347 - val_loss: 0.0774 - val_calc_accuracy: 0.9106
Epoch 29/50
 - 19s - loss: 0.0672 - calc_accuracy: 0.9413 - val_loss: 0.0747 - val_calc_accuracy: 0.9225
Epoch 30/50
 - 20s - loss: 0.0666 - calc_accuracy: 0.9471 - val_loss: 0.0629 - val_calc_accuracy: 0.9359
Epoch 31/50
 - 19s - loss: 0.0626 - calc_accuracy: 0.9526 - val_loss: 0.0659 - val_calc_accuracy: 0.9407
Epoch 32/50
 - 19s - loss: 0.0583 - calc_accuracy: 0.9594 - val_loss: 0.0605 - val_calc_accuracy: 0.9509
Epoch 33/50
 - 19s - loss: 0.0562 - calc_accuracy: 0.9624 - val_loss: 0.0571 - val_calc_accuracy: 0.9581
Epoch 34/50
 - 19s - loss: 0.0546 - calc_accuracy: 0.9642 - val_loss: 0.0598 - val_calc_accuracy: 0.9557
Epoch 35/50
 - 19s - loss: 0.0536 - calc_accuracy: 0.9658 - val_loss: 0.0704 - val_calc_accuracy: 0.9328
Epoch 36/50
 - 19s - loss: 0.0507 - calc_accuracy: 0.9695 - val_loss: 0.0536 - val_calc_accuracy: 0.9565
Epoch 37/50
 - 19s - loss: 0.0479 - calc_accuracy: 0.9743 - val_loss: 0.0578 - val_calc_accuracy: 0.9517
Epoch 38/50
 - 19s - loss: 0.0467 - calc_accuracy: 0.9765 - val_loss: 0.0552 - val_calc_accuracy: 0.9628
Epoch 39/50
 - 19s - loss: 0.0457 - calc_accuracy: 0.9773 - val_loss: 0.0560 - val_calc_accuracy: 0.9604
Epoch 40/50
 - 19s - loss: 0.0430 - calc_accuracy: 0.9803 - val_loss: 0.0447 - val_calc_accuracy: 0.9707
Epoch 41/50
 - 19s - loss: 0.0410 - calc_accuracy: 0.9839 - val_loss: 0.0466 - val_calc_accuracy: 0.9597
Epoch 42/50
 - 19s - loss: 0.0389 - calc_accuracy: 0.9853 - val_loss: 0.0447 - val_calc_accuracy: 0.9723
Epoch 43/50
 - 19s - loss: 0.0375 - calc_accuracy: 0.9877 - val_loss: 0.0430 - val_calc_accuracy: 0.9778
Epoch 44/50
 - 19s - loss: 0.0373 - calc_accuracy: 0.9871 - val_loss: 0.0432 - val_calc_accuracy: 0.9747
Epoch 45/50
 - 19s - loss: 0.0363 - calc_accuracy: 0.9885 - val_loss: 0.0505 - val_calc_accuracy: 0.9668
Epoch 46/50
 - 19s - loss: 0.0370 - calc_accuracy: 0.9883 - val_loss: 0.0497 - val_calc_accuracy: 0.9644
Epoch 47/50
 - 19s - loss: 0.0349 - calc_accuracy: 0.9918 - val_loss: 0.0493 - val_calc_accuracy: 0.9707
Epoch 48/50
 - 19s - loss: 0.0336 - calc_accuracy: 0.9912 - val_loss: 0.0399 - val_calc_accuracy: 0.9802
Epoch 49/50
 - 19s - loss: 0.0334 - calc_accuracy: 0.9926 - val_loss: 0.0434 - val_calc_accuracy: 0.9794
Epoch 50/50
 - 19s - loss: 0.0318 - calc_accuracy: 0.9924 - val_loss: 0.0438 - val_calc_accuracy: 0.9739
Test accuracy: 0.9738924050632911
Train on 5024 samples, validate on 1264 samples
Epoch 1/50
 - 12s - loss: 0.2853 - calc_accuracy: 0.4940 - val_loss: 0.4692 - val_calc_accuracy: 0.5000
Epoch 2/50
 - 11s - loss: 0.2741 - calc_accuracy: 0.4980 - val_loss: 0.4336 - val_calc_accuracy: 0.5000
Epoch 3/50
 - 11s - loss: 0.2719 - calc_accuracy: 0.5034 - val_loss: 0.4574 - val_calc_accuracy: 0.5000
Epoch 4/50
 - 11s - loss: 0.2665 - calc_accuracy: 0.5100 - val_loss: 0.4464 - val_calc_accuracy: 0.5000
Epoch 5/50
 - 11s - loss: 0.2677 - calc_accuracy: 0.4986 - val_loss: 0.4545 - val_calc_accuracy: 0.5000
Epoch 6/50
 - 11s - loss: 0.2703 - calc_accuracy: 0.4968 - val_loss: 0.4707 - val_calc_accuracy: 0.5000
Epoch 7/50
 - 11s - loss: 0.2660 - calc_accuracy: 0.4970 - val_loss: 0.4479 - val_calc_accuracy: 0.5000
Epoch 8/50
 - 11s - loss: 0.2657 - calc_accuracy: 0.4968 - val_loss: 0.4652 - val_calc_accuracy: 0.5000
Epoch 9/50
 - 11s - loss: 0.2636 - calc_accuracy: 0.5028 - val_loss: 0.4590 - val_calc_accuracy: 0.5000
Epoch 10/50
 - 11s - loss: 0.2617 - calc_accuracy: 0.5018 - val_loss: 0.4553 - val_calc_accuracy: 0.5000
Epoch 11/50
 - 11s - loss: 0.2595 - calc_accuracy: 0.5149 - val_loss: 0.4681 - val_calc_accuracy: 0.5000
Epoch 12/50
 - 11s - loss: 0.2618 - calc_accuracy: 0.5002 - val_loss: 0.4677 - val_calc_accuracy: 0.5000
Epoch 13/50
 - 11s - loss: 0.2619 - calc_accuracy: 0.5042 - val_loss: 0.4638 - val_calc_accuracy: 0.5000
Epoch 14/50
 - 11s - loss: 0.2650 - calc_accuracy: 0.4954 - val_loss: 0.4718 - val_calc_accuracy: 0.5000
Epoch 15/50
 - 11s - loss: 0.2645 - calc_accuracy: 0.5006 - val_loss: 0.4825 - val_calc_accuracy: 0.5000
Epoch 16/50
 - 11s - loss: 0.2611 - calc_accuracy: 0.5004 - val_loss: 0.4755 - val_calc_accuracy: 0.5000
Epoch 17/50
 - 11s - loss: 0.2604 - calc_accuracy: 0.5038 - val_loss: 0.4748 - val_calc_accuracy: 0.5000
Epoch 18/50
 - 11s - loss: 0.2610 - calc_accuracy: 0.5046 - val_loss: 0.4780 - val_calc_accuracy: 0.5000
Epoch 19/50
 - 11s - loss: 0.2638 - calc_accuracy: 0.4984 - val_loss: 0.4793 - val_calc_accuracy: 0.5000
Epoch 20/50
 - 11s - loss: 0.2606 - calc_accuracy: 0.5054 - val_loss: 0.4701 - val_calc_accuracy: 0.5000
Epoch 21/50
 - 11s - loss: 0.2602 - calc_accuracy: 0.5082 - val_loss: 0.4836 - val_calc_accuracy: 0.5000
Epoch 22/50
 - 11s - loss: 0.2614 - calc_accuracy: 0.4887 - val_loss: 0.4727 - val_calc_accuracy: 0.5000
Epoch 23/50
 - 11s - loss: 0.2606 - calc_accuracy: 0.4982 - val_loss: 0.4725 - val_calc_accuracy: 0.5000
Epoch 24/50
 - 11s - loss: 0.2585 - calc_accuracy: 0.5109 - val_loss: 0.4772 - val_calc_accuracy: 0.5000
Epoch 25/50
 - 11s - loss: 0.2616 - calc_accuracy: 0.4994 - val_loss: 0.4859 - val_calc_accuracy: 0.5000
Epoch 26/50
 - 11s - loss: 0.2609 - calc_accuracy: 0.4948 - val_loss: 0.4812 - val_calc_accuracy: 0.5000
Epoch 27/50
 - 11s - loss: 0.2609 - calc_accuracy: 0.4942 - val_loss: 0.4827 - val_calc_accuracy: 0.5000
Epoch 28/50
 - 11s - loss: 0.2589 - calc_accuracy: 0.5072 - val_loss: 0.4797 - val_calc_accuracy: 0.5000
Epoch 29/50
 - 11s - loss: 0.2605 - calc_accuracy: 0.5038 - val_loss: 0.4837 - val_calc_accuracy: 0.5000
Epoch 30/50
 - 11s - loss: 0.2585 - calc_accuracy: 0.5020 - val_loss: 0.4822 - val_calc_accuracy: 0.5000
Epoch 31/50
 - 11s - loss: 0.2588 - calc_accuracy: 0.5032 - val_loss: 0.4812 - val_calc_accuracy: 0.5000
Epoch 32/50
 - 11s - loss: 0.2616 - calc_accuracy: 0.4883 - val_loss: 0.4799 - val_calc_accuracy: 0.5000
Epoch 33/50
 - 11s - loss: 0.2599 - calc_accuracy: 0.5000 - val_loss: 0.4823 - val_calc_accuracy: 0.5000
Epoch 34/50
 - 11s - loss: 0.2608 - calc_accuracy: 0.5042 - val_loss: 0.4830 - val_calc_accuracy: 0.5000
Epoch 35/50
 - 11s - loss: 0.2612 - calc_accuracy: 0.4948 - val_loss: 0.4770 - val_calc_accuracy: 0.5000
Epoch 36/50
 - 11s - loss: 0.2591 - calc_accuracy: 0.5016 - val_loss: 0.4832 - val_calc_accuracy: 0.5000
Epoch 37/50
 - 11s - loss: 0.2583 - calc_accuracy: 0.5056 - val_loss: 0.4805 - val_calc_accuracy: 0.5000
Epoch 38/50
 - 11s - loss: 0.2605 - calc_accuracy: 0.4902 - val_loss: 0.4761 - val_calc_accuracy: 0.5000
Epoch 39/50
 - 11s - loss: 0.2562 - calc_accuracy: 0.5127 - val_loss: 0.4425 - val_calc_accuracy: 0.5000
Epoch 40/50
 - 11s - loss: 0.2581 - calc_accuracy: 0.5070 - val_loss: 0.4783 - val_calc_accuracy: 0.5000
Epoch 41/50
 - 11s - loss: 0.2604 - calc_accuracy: 0.5050 - val_loss: 0.4721 - val_calc_accuracy: 0.5000
Epoch 42/50
 - 11s - loss: 0.2603 - calc_accuracy: 0.4960 - val_loss: 0.3387 - val_calc_accuracy: 0.5024
Epoch 43/50
 - 11s - loss: 0.2514 - calc_accuracy: 0.5470 - val_loss: 0.3533 - val_calc_accuracy: 0.5000
Epoch 44/50
 - 11s - loss: 0.2510 - calc_accuracy: 0.5480 - val_loss: 0.2874 - val_calc_accuracy: 0.5491
Epoch 45/50
 - 11s - loss: 0.2385 - calc_accuracy: 0.5872 - val_loss: 0.2608 - val_calc_accuracy: 0.6036
Epoch 46/50
 - 11s - loss: 0.2296 - calc_accuracy: 0.6129 - val_loss: 0.2630 - val_calc_accuracy: 0.5918
Epoch 47/50
 - 11s - loss: 0.2170 - calc_accuracy: 0.6455 - val_loss: 0.2002 - val_calc_accuracy: 0.6907
Epoch 48/50
 - 11s - loss: 0.1925 - calc_accuracy: 0.7070 - val_loss: 0.1691 - val_calc_accuracy: 0.7334
Epoch 49/50
 - 11s - loss: 0.1777 - calc_accuracy: 0.7369 - val_loss: 0.1877 - val_calc_accuracy: 0.7223
Epoch 50/50
 - 11s - loss: 0.1669 - calc_accuracy: 0.7643 - val_loss: 0.1322 - val_calc_accuracy: 0.8070
Test accuracy: 0.8069620253164557
Train on 5024 samples, validate on 1264 samples
Epoch 1/50
 - 26s - loss: 0.3214 - calc_accuracy: 0.5066 - val_loss: 0.4063 - val_calc_accuracy: 0.5000
Epoch 2/50
 - 24s - loss: 0.2804 - calc_accuracy: 0.4964 - val_loss: 0.4652 - val_calc_accuracy: 0.5000
Epoch 3/50
 - 24s - loss: 0.2782 - calc_accuracy: 0.5052 - val_loss: 0.4467 - val_calc_accuracy: 0.5000
Epoch 4/50
 - 24s - loss: 0.2773 - calc_accuracy: 0.4988 - val_loss: 0.4383 - val_calc_accuracy: 0.5000
Epoch 5/50
 - 24s - loss: 0.2751 - calc_accuracy: 0.5060 - val_loss: 0.4404 - val_calc_accuracy: 0.5000
Epoch 6/50
 - 24s - loss: 0.2703 - calc_accuracy: 0.4990 - val_loss: 0.4475 - val_calc_accuracy: 0.5000
Epoch 7/50
 - 24s - loss: 0.2666 - calc_accuracy: 0.5020 - val_loss: 0.4443 - val_calc_accuracy: 0.5000
Epoch 8/50
 - 24s - loss: 0.2662 - calc_accuracy: 0.5135 - val_loss: 0.3921 - val_calc_accuracy: 0.5000
Epoch 9/50
 - 24s - loss: 0.2611 - calc_accuracy: 0.5235 - val_loss: 0.2668 - val_calc_accuracy: 0.5672
Epoch 10/50
 - 24s - loss: 0.2524 - calc_accuracy: 0.5701 - val_loss: 0.2385 - val_calc_accuracy: 0.6179
Epoch 11/50
 - 24s - loss: 0.2270 - calc_accuracy: 0.6393 - val_loss: 0.2097 - val_calc_accuracy: 0.6685
Epoch 12/50
 - 24s - loss: 0.1862 - calc_accuracy: 0.7160 - val_loss: 0.1968 - val_calc_accuracy: 0.6915
Epoch 13/50
 - 23s - loss: 0.1654 - calc_accuracy: 0.7681 - val_loss: 0.1440 - val_calc_accuracy: 0.8014
Epoch 14/50
 - 24s - loss: 0.1465 - calc_accuracy: 0.8059 - val_loss: 0.1254 - val_calc_accuracy: 0.8378
Epoch 15/50
 - 23s - loss: 0.1371 - calc_accuracy: 0.8230 - val_loss: 0.1268 - val_calc_accuracy: 0.8299
Epoch 16/50
 - 24s - loss: 0.1266 - calc_accuracy: 0.8441 - val_loss: 0.1098 - val_calc_accuracy: 0.8544
Epoch 17/50
 - 23s - loss: 0.1155 - calc_accuracy: 0.8633 - val_loss: 0.1210 - val_calc_accuracy: 0.8362
Epoch 18/50
 - 24s - loss: 0.1092 - calc_accuracy: 0.8800 - val_loss: 0.0935 - val_calc_accuracy: 0.9059
Epoch 19/50
 - 24s - loss: 0.0972 - calc_accuracy: 0.9035 - val_loss: 0.0947 - val_calc_accuracy: 0.8924
Epoch 20/50
 - 24s - loss: 0.0926 - calc_accuracy: 0.9043 - val_loss: 0.0967 - val_calc_accuracy: 0.9003
Epoch 21/50
 - 24s - loss: 0.0863 - calc_accuracy: 0.9188 - val_loss: 0.0845 - val_calc_accuracy: 0.9153
Epoch 22/50
 - 24s - loss: 0.0788 - calc_accuracy: 0.9281 - val_loss: 0.0757 - val_calc_accuracy: 0.9312
Epoch 23/50
 - 24s - loss: 0.0778 - calc_accuracy: 0.9335 - val_loss: 0.0802 - val_calc_accuracy: 0.9177
Epoch 24/50
 - 24s - loss: 0.0723 - calc_accuracy: 0.9403 - val_loss: 0.1098 - val_calc_accuracy: 0.8616
Epoch 25/50
 - 23s - loss: 0.0683 - calc_accuracy: 0.9417 - val_loss: 0.0735 - val_calc_accuracy: 0.9288
Epoch 26/50
 - 24s - loss: 0.0662 - calc_accuracy: 0.9459 - val_loss: 0.0733 - val_calc_accuracy: 0.9359
Epoch 27/50
 - 24s - loss: 0.0601 - calc_accuracy: 0.9530 - val_loss: 0.0602 - val_calc_accuracy: 0.9494
Epoch 28/50
 - 24s - loss: 0.0573 - calc_accuracy: 0.9588 - val_loss: 0.0543 - val_calc_accuracy: 0.9573
Epoch 29/50
 - 24s - loss: 0.0558 - calc_accuracy: 0.9614 - val_loss: 0.0609 - val_calc_accuracy: 0.9438
Epoch 30/50
 - 24s - loss: 0.0508 - calc_accuracy: 0.9666 - val_loss: 0.0653 - val_calc_accuracy: 0.9415
Epoch 31/50
 - 24s - loss: 0.0510 - calc_accuracy: 0.9688 - val_loss: 0.0502 - val_calc_accuracy: 0.9684
Epoch 32/50
 - 23s - loss: 0.0501 - calc_accuracy: 0.9727 - val_loss: 0.0633 - val_calc_accuracy: 0.9367
Epoch 33/50
 - 24s - loss: 0.0490 - calc_accuracy: 0.9688 - val_loss: 0.0564 - val_calc_accuracy: 0.9565
Epoch 34/50
 - 24s - loss: 0.0454 - calc_accuracy: 0.9733 - val_loss: 0.0539 - val_calc_accuracy: 0.9502
Epoch 35/50
 - 24s - loss: 0.0449 - calc_accuracy: 0.9779 - val_loss: 0.0484 - val_calc_accuracy: 0.9636
Epoch 36/50
 - 24s - loss: 0.0429 - calc_accuracy: 0.9805 - val_loss: 0.0565 - val_calc_accuracy: 0.9589
Epoch 37/50
 - 24s - loss: 0.0405 - calc_accuracy: 0.9829 - val_loss: 0.0464 - val_calc_accuracy: 0.9604
Epoch 38/50
 - 23s - loss: 0.0388 - calc_accuracy: 0.9849 - val_loss: 0.0605 - val_calc_accuracy: 0.9454
Epoch 39/50
 - 23s - loss: 0.0405 - calc_accuracy: 0.9807 - val_loss: 0.0518 - val_calc_accuracy: 0.9604
Epoch 40/50
 - 24s - loss: 0.0370 - calc_accuracy: 0.9861 - val_loss: 0.0413 - val_calc_accuracy: 0.9707
Epoch 41/50
 - 23s - loss: 0.0365 - calc_accuracy: 0.9845 - val_loss: 0.0794 - val_calc_accuracy: 0.9153
Epoch 42/50
 - 24s - loss: 0.0369 - calc_accuracy: 0.9847 - val_loss: 0.0454 - val_calc_accuracy: 0.9723
Epoch 43/50
 - 24s - loss: 0.0331 - calc_accuracy: 0.9902 - val_loss: 0.0398 - val_calc_accuracy: 0.9763
Epoch 44/50
 - 24s - loss: 0.0347 - calc_accuracy: 0.9896 - val_loss: 0.0381 - val_calc_accuracy: 0.9763
Epoch 45/50
 - 24s - loss: 0.0328 - calc_accuracy: 0.9891 - val_loss: 0.0408 - val_calc_accuracy: 0.9763
Epoch 46/50
 - 24s - loss: 0.0316 - calc_accuracy: 0.9912 - val_loss: 0.0394 - val_calc_accuracy: 0.9699
Epoch 47/50
 - 24s - loss: 0.0305 - calc_accuracy: 0.9920 - val_loss: 0.0380 - val_calc_accuracy: 0.9715
Epoch 48/50
 - 24s - loss: 0.0314 - calc_accuracy: 0.9912 - val_loss: 0.0363 - val_calc_accuracy: 0.9802
Epoch 49/50
 - 24s - loss: 0.0300 - calc_accuracy: 0.9930 - val_loss: 0.0385 - val_calc_accuracy: 0.9755
Epoch 50/50
 - 24s - loss: 0.0304 - calc_accuracy: 0.9918 - val_loss: 0.0360 - val_calc_accuracy: 0.9778
Test accuracy: 0.9778481012658228
Train on 5024 samples, validate on 1264 samples
Epoch 1/50
 - 24s - loss: 0.3331 - calc_accuracy: 0.5145 - val_loss: 0.4171 - val_calc_accuracy: 0.5000
Epoch 2/50
 - 24s - loss: 0.2905 - calc_accuracy: 0.4958 - val_loss: 0.4713 - val_calc_accuracy: 0.5000
Epoch 3/50
 - 24s - loss: 0.2826 - calc_accuracy: 0.5000 - val_loss: 0.4547 - val_calc_accuracy: 0.5000
Epoch 4/50
 - 24s - loss: 0.2769 - calc_accuracy: 0.5076 - val_loss: 0.4084 - val_calc_accuracy: 0.5000
Epoch 5/50
 - 24s - loss: 0.2779 - calc_accuracy: 0.4930 - val_loss: 0.4057 - val_calc_accuracy: 0.5000
Epoch 6/50
 - 24s - loss: 0.2713 - calc_accuracy: 0.5036 - val_loss: 0.4508 - val_calc_accuracy: 0.5000
Epoch 7/50
 - 24s - loss: 0.2670 - calc_accuracy: 0.5203 - val_loss: 0.3859 - val_calc_accuracy: 0.5000
Epoch 8/50
 - 23s - loss: 0.2672 - calc_accuracy: 0.5239 - val_loss: 0.3155 - val_calc_accuracy: 0.5206
Epoch 9/50
 - 24s - loss: 0.2554 - calc_accuracy: 0.5631 - val_loss: 0.2840 - val_calc_accuracy: 0.5356
Epoch 10/50
 - 24s - loss: 0.2108 - calc_accuracy: 0.6614 - val_loss: 0.1866 - val_calc_accuracy: 0.7128
Epoch 11/50
 - 24s - loss: 0.1865 - calc_accuracy: 0.7207 - val_loss: 0.1653 - val_calc_accuracy: 0.7587
Epoch 12/50
 - 24s - loss: 0.1543 - calc_accuracy: 0.7864 - val_loss: 0.1487 - val_calc_accuracy: 0.7959
Epoch 13/50
 - 24s - loss: 0.1418 - calc_accuracy: 0.8063 - val_loss: 0.1241 - val_calc_accuracy: 0.8386
Epoch 14/50
 - 24s - loss: 0.1302 - calc_accuracy: 0.8318 - val_loss: 0.1396 - val_calc_accuracy: 0.8038
Epoch 15/50
 - 23s - loss: 0.1226 - calc_accuracy: 0.8511 - val_loss: 0.1066 - val_calc_accuracy: 0.8671
Epoch 16/50
 - 24s - loss: 0.1150 - calc_accuracy: 0.8615 - val_loss: 0.1018 - val_calc_accuracy: 0.8813
Epoch 17/50
 - 24s - loss: 0.1040 - calc_accuracy: 0.8806 - val_loss: 0.1154 - val_calc_accuracy: 0.8521
Epoch 18/50
 - 24s - loss: 0.0993 - calc_accuracy: 0.8929 - val_loss: 0.0905 - val_calc_accuracy: 0.9019
Epoch 19/50
 - 24s - loss: 0.0953 - calc_accuracy: 0.8981 - val_loss: 0.0991 - val_calc_accuracy: 0.8821
Epoch 20/50
 - 23s - loss: 0.0883 - calc_accuracy: 0.9112 - val_loss: 0.0946 - val_calc_accuracy: 0.8995
Epoch 21/50
 - 23s - loss: 0.0862 - calc_accuracy: 0.9104 - val_loss: 0.0834 - val_calc_accuracy: 0.9106
Epoch 22/50
 - 24s - loss: 0.0794 - calc_accuracy: 0.9232 - val_loss: 0.0710 - val_calc_accuracy: 0.9296
Epoch 23/50
 - 24s - loss: 0.0771 - calc_accuracy: 0.9260 - val_loss: 0.0807 - val_calc_accuracy: 0.9106
Epoch 24/50
 - 24s - loss: 0.0725 - calc_accuracy: 0.9321 - val_loss: 0.0670 - val_calc_accuracy: 0.9367
Epoch 25/50
 - 24s - loss: 0.0688 - calc_accuracy: 0.9429 - val_loss: 0.0717 - val_calc_accuracy: 0.9375
Epoch 26/50
 - 24s - loss: 0.0658 - calc_accuracy: 0.9447 - val_loss: 0.0694 - val_calc_accuracy: 0.9367
Epoch 27/50
 - 24s - loss: 0.0652 - calc_accuracy: 0.9498 - val_loss: 0.0653 - val_calc_accuracy: 0.9430
Epoch 28/50
 - 24s - loss: 0.0595 - calc_accuracy: 0.9542 - val_loss: 0.0637 - val_calc_accuracy: 0.9422
Epoch 29/50
 - 24s - loss: 0.0576 - calc_accuracy: 0.9620 - val_loss: 0.0568 - val_calc_accuracy: 0.9509
Epoch 30/50
 - 24s - loss: 0.0532 - calc_accuracy: 0.9652 - val_loss: 0.0568 - val_calc_accuracy: 0.9509
Epoch 31/50
 - 24s - loss: 0.0557 - calc_accuracy: 0.9626 - val_loss: 0.0602 - val_calc_accuracy: 0.9494
Epoch 32/50
 - 23s - loss: 0.0502 - calc_accuracy: 0.9689 - val_loss: 0.0617 - val_calc_accuracy: 0.9509
Epoch 33/50
 - 23s - loss: 0.0484 - calc_accuracy: 0.9672 - val_loss: 0.0471 - val_calc_accuracy: 0.9691
Epoch 34/50
 - 24s - loss: 0.0457 - calc_accuracy: 0.9751 - val_loss: 0.0516 - val_calc_accuracy: 0.9597
Epoch 35/50
 - 24s - loss: 0.0439 - calc_accuracy: 0.9763 - val_loss: 0.0606 - val_calc_accuracy: 0.9430
Epoch 36/50
 - 24s - loss: 0.0422 - calc_accuracy: 0.9795 - val_loss: 0.0481 - val_calc_accuracy: 0.9604
Epoch 37/50
 - 24s - loss: 0.0419 - calc_accuracy: 0.9815 - val_loss: 0.0496 - val_calc_accuracy: 0.9604
Epoch 38/50
 - 24s - loss: 0.0398 - calc_accuracy: 0.9801 - val_loss: 0.0476 - val_calc_accuracy: 0.9620
Epoch 39/50
 - 23s - loss: 0.0375 - calc_accuracy: 0.9837 - val_loss: 0.0549 - val_calc_accuracy: 0.9549
Epoch 40/50
 - 24s - loss: 0.0388 - calc_accuracy: 0.9831 - val_loss: 0.0458 - val_calc_accuracy: 0.9691
Epoch 41/50
 - 24s - loss: 0.0369 - calc_accuracy: 0.9825 - val_loss: 0.0488 - val_calc_accuracy: 0.9612
Epoch 42/50
 - 23s - loss: 0.0355 - calc_accuracy: 0.9867 - val_loss: 0.0417 - val_calc_accuracy: 0.9715
Epoch 43/50
 - 24s - loss: 0.0363 - calc_accuracy: 0.9857 - val_loss: 0.0512 - val_calc_accuracy: 0.9660
Epoch 44/50
 - 24s - loss: 0.0338 - calc_accuracy: 0.9883 - val_loss: 0.0413 - val_calc_accuracy: 0.9684
Epoch 45/50
 - 23s - loss: 0.0333 - calc_accuracy: 0.9877 - val_loss: 0.0439 - val_calc_accuracy: 0.9747
Epoch 46/50
 - 23s - loss: 0.0327 - calc_accuracy: 0.9902 - val_loss: 0.0464 - val_calc_accuracy: 0.9707
Epoch 47/50
 - 24s - loss: 0.0321 - calc_accuracy: 0.9906 - val_loss: 0.0404 - val_calc_accuracy: 0.9755
Epoch 48/50
 - 24s - loss: 0.0299 - calc_accuracy: 0.9918 - val_loss: 0.0461 - val_calc_accuracy: 0.9620
Epoch 49/50
 - 24s - loss: 0.0292 - calc_accuracy: 0.9934 - val_loss: 0.0402 - val_calc_accuracy: 0.9739
Epoch 50/50
 - 24s - loss: 0.0294 - calc_accuracy: 0.9916 - val_loss: 0.0458 - val_calc_accuracy: 0.9668
Test accuracy: 0.9667721518987342
{'pool_size_1': 8, 'pool_size_3': 3, 'activation_1': 'tanh', 'Conv2D_3': 32, 'pool_size_2': 5, 'Conv2D_1': 16, 'pool_size': 3, 'Dense': 16, 'activation_4': 'relu', 'Conv2D_2': 64, 'pool_size_5': 5, 'pool_size_4': 7, 'activation_3': 'tanh', 'activation_2': 'relu', 'Conv2D': 32, 'activation': 'tanh'}
Evalutation of best performing model:
